<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> xQuant  Shannon theorem       </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="These are various notes of computer science subjects. They sometime have accompanying F# implementation They are authored in a litterate programming style and each document is a valid.">
    <meta name="author" content="Nicolas Rolland">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="alternate" type="application/rss+xml" title="xQuant.net Atom feed" href="http://xquant.net/blog/feed.xml" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/stylesheet/tooltips.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/style.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/jsxgraph.css" />

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=css&lang=ml&lang=scala&lang=hs"></script>
    <script src="/javascript/tips.js" type="text/javascript"></script>
    <script src="/javascript/jsxgraphcore.js" type="text/javascript"></script>
    <script>
        JXG.Options.text.useMathJax = true;
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],

        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
          }
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i = 0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      })
      </script>
    <script>
      setTimeout(function() {
      if(typeof(MathJax)=='undefined') return;
      var n = document.getElementsByTagName("script")[0];
      n.parentNode.insertBefore(document.createElement("script"), n).src = "/javascript/MathJax.js";
      }, 5000);
    </script>
     <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></Script>
     <script type="text/javascript" src="/javascript/MathJax.js"></Script>
     
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39755928-1', 'xquant.net');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-45978109-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
  <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
        <a class="brand" href="#">Shannon theorem  </a>
          <hr>
        <ul class="nav">
          <li><a href="/">Home</a></li>
          <li><a href="/notes">Notes</a></li>
           <li><a href="/about">About</a></li>
           <li class="divider"></li>
        </ul>
      </div>
      </div>
      <hr>
    <div class="centered">
      
  <div class='post'>
    <article>
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="span9" id="main">
          <h1>Shannon theorem</h1>

<p>The last post about Huffman coding showed a simple recursive principle in action, to build a tree whose additional element were
added as to minimize the expected length of our code final code.</p>

<p>Now let's look at the nasty bits, which we'll lead us to unlock more of the secret of compressing.</p>

<h3>The Shannon optimal length</h3>

<p>At each step of the Huffman algorithm, we take the best decision.
Is it correct globally though ? Is the sequence of small optimal decision really the best overall decision ?</p>

<p>What we really want to do is find a mapping $X_i \rightarrow M_i$ where the $M_i$ are made of a sequence of 
$l_i$ values from $\begin{cases} 0,1\end{cases} $.</p>

<p>This mapping should minimize the expected length $\sum_i p_i l_i$
We also want those messages to be distinguishable, which means no message can start with another.
This implies, if we indentify the message to the node of a tree, that no potential descendant of a codeword of length
$l_i$, of which there are $2^{l_max-l_i}$, overlaps the descendant of another, so that by adding all the descendants,
 none get counted twice, which itself implies that $\sum_i 2^{l_{max}-l_i} \leq 2^{l_{max}}$</p>

<p>This leads to the following program</p>

<p>$$
\begin{align}
\arg\min \sum_i p_i l_i \\
 s.t.\ \sum_i 2^{-l_i} \leq 1
\end{align}
$$</p>

<p>This gives us the optimal length for the symbol code.
It might mandate non-integer length, which we'll have to round up.</p>

<p>In particular, a symbol whose probability is above $\frac{1}{2}$ should have a length of less than one bit !
So, if a binarysource emits a "1" 90% of the time, do we have to use 1 bit even though we know a value is very likely ?</p>

<h3>Spread 1 bit loss</h3>

<p>Just like we can look at the distribution of the symbol of our dictionary, we can look at the distribution over a 
few symbol of length n.</p>

<p>Hopefully, this will spread the extra bit that we have to spend over the sequence of n word.</p>

<p>If there is no sequential regularity, and each element of the sequence is independant, that'll just double the entropy 
of the overall distributon</p>

<p>let's verify that</p>

<pre class="fssnip">
<span class="prep">#load</span> <span class="s">"</span><span class="s">huffman</span><span class="s">.</span><span class="s">fsx</span><span class="s">"</span></pre>


<h3>does not tell you where to look</h3>

<p>ex 01010101 =&gt; entropy depends on the symbols</p>

<h3>Shannon coding</h3>

<p>Now that we have seen how to compress transform a string based on the frequency of some vocabulary, we can ask ourselve how much we can compress.
If our dictionary is composed of the set {0,1}, where 0 is very likely, can we compress it using the former scheme ?
Shannon says yes. But in order to compress each character, of size 1 bit, we'd need to use at least 1 bit as well.</p>

<p>But by considering a new vocabulary, which is made of sequence of 2 characters of the initial vocabulary, we can compose twice the individual word frequency imbalance into a
even stronger imbalance where each word in the new vocabulary is made of 2 word from the initial one.</p>

<p>Then we can apply our Huffman encoding.
It can be interesting to see how the compression evolves as we lengthen the sequence of character.</p>

<p>Let's do this</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">BlockCoding</span> <span class="o">=</span>
   
   <span class="c">//this is a simple biased stream, with serial independance </span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">p</span> <span class="o">=</span> 
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">Random</span>()
      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">loop</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">seq</span> { <span class="k">if</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="i">NextDouble</span>() <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs3', 11)" onmouseover="showTip(event, 'fs3', 11)" class="i">p</span> 
              <span class="k">then</span> <span class="k">yield</span> <span class="n">1</span> <span class="k">else</span> <span class="k">yield</span> <span class="n">0</span>;
              <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs7', 12)" onmouseover="showTip(event, 'fs7', 12)" class="i">loop</span> }
      <span onmouseout="hideTip(event, 'fs7', 13)" onmouseover="showTip(event, 'fs7', 13)" class="i">loop</span>

   <span class="c">//we group </span>
   <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="i">basen</span> <span class="o">=</span> <span class="k">function</span> 
        | <span class="n">0</span> <span class="k">-&gt;</span> [[]] 
        | <span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="i">n</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="i">enext</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 18)" onmouseover="showTip(event, 'fs10', 18)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">basen</span> (<span class="i">length</span><span class="o">-</span><span class="n">1</span>) 
               [ <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">basen</span><span class="o">-</span><span class="n">1</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 21)" onmouseover="showTip(event, 'fs14', 21)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 22)" onmouseover="showTip(event, 'fs15', 22)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs16', 23)" onmouseover="showTip(event, 'fs16', 23)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">enext</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs17', 27)" onmouseover="showTip(event, 'fs17', 27)" class="i">l</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs14', 28)" onmouseover="showTip(event, 'fs14', 28)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 29)" onmouseover="showTip(event, 'fs18', 29)" class="i">Cons</span>(<span onmouseout="hideTip(event, 'fs16', 30)" onmouseover="showTip(event, 'fs16', 30)" class="i">x</span>,<span onmouseout="hideTip(event, 'fs17', 31)" onmouseover="showTip(event, 'fs17', 31)" class="i">l</span>))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 32)" onmouseover="showTip(event, 'fs14', 32)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="i">concat</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 34)" onmouseover="showTip(event, 'fs20', 34)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 35)" onmouseover="showTip(event, 'fs10', 35)" class="i">enumerate</span> <span class="n">2</span> <span class="n">2</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 36)" onmouseover="showTip(event, 'fs21', 36)" class="i">lengthCode</span> <span class="o">=</span> <span class="n">3</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 37)" onmouseover="showTip(event, 'fs22', 37)" class="i">p</span> <span class="o">=</span> <span class="n">0.1</span>
   
    <span class="c">// we will build a code for up to length * H(p) + a few, say 2.3 sqrt (N.p.(1-p))</span>
    <span class="c">// so we enumerate the sequences, and compute their log probabilities</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 38)" onmouseover="showTip(event, 'fs23', 38)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs24', 39)" onmouseover="showTip(event, 'fs24', 39)" class="i">p</span> <span onmouseout="hideTip(event, 'fs25', 40)" onmouseover="showTip(event, 'fs25', 40)" class="i">lengthCode</span> <span class="o">=</span> 
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 41)" onmouseover="showTip(event, 'fs26', 41)" class="i">lp</span>, <span onmouseout="hideTip(event, 'fs27', 42)" onmouseover="showTip(event, 'fs27', 42)" class="i">nlp</span> <span class="o">=</span> <span class="i">Math</span><span class="o">.</span><span class="i">Log</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="i">p</span>, <span class="i">Math</span><span class="o">.</span><span class="i">Log</span>(<span class="n">1.</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs24', 44)" onmouseover="showTip(event, 'fs24', 44)" class="i">p</span>)
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 45)" onmouseover="showTip(event, 'fs28', 45)" class="i">sequences</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 46)" onmouseover="showTip(event, 'fs10', 46)" class="i">enumerate</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs25', 47)" onmouseover="showTip(event, 'fs25', 47)" class="i">lengthCode</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 48)" onmouseover="showTip(event, 'fs14', 48)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 49)" onmouseover="showTip(event, 'fs15', 49)" class="i">map</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs29', 50)" onmouseover="showTip(event, 'fs29', 50)" class="i">s</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 51)" onmouseover="showTip(event, 'fs30', 51)" class="i">ones</span> <span class="o">=</span>  <span onmouseout="hideTip(event, 'fs29', 52)" onmouseover="showTip(event, 'fs29', 52)" class="i">s</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 53)" onmouseover="showTip(event, 'fs14', 53)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 54)" onmouseover="showTip(event, 'fs31', 54)" class="i">sum</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs32', 55)" onmouseover="showTip(event, 'fs32', 55)" class="i">float</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs29', 56)" onmouseover="showTip(event, 'fs29', 56)" class="i">s</span>, (<span onmouseout="hideTip(event, 'fs30', 57)" onmouseover="showTip(event, 'fs30', 57)" class="i">ones</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs26', 58)" onmouseover="showTip(event, 'fs26', 58)" class="i">lp</span> <span class="o">+</span> (<span onmouseout="hideTip(event, 'fs32', 59)" onmouseover="showTip(event, 'fs32', 59)" class="i">float</span> <span onmouseout="hideTip(event, 'fs25', 60)" onmouseover="showTip(event, 'fs25', 60)" class="i">lengthCode</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs30', 61)" onmouseover="showTip(event, 'fs30', 61)" class="i">ones</span>) <span class="o">*</span><span onmouseout="hideTip(event, 'fs27', 62)" onmouseover="showTip(event, 'fs27', 62)" class="i">nlp</span>))
      <span onmouseout="hideTip(event, 'fs33', 63)" onmouseover="showTip(event, 'fs33', 63)" class="i">printfn</span> <span class="s">"</span><span class="s">seqeunce</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 64)" onmouseover="showTip(event, 'fs34', 64)" class="i">codeTree</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 65)" onmouseover="showTip(event, 'fs35', 65)" class="i">Huffman</span><span class="o">.</span><span class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs28', 66)" onmouseover="showTip(event, 'fs28', 66)" class="i">sequences</span>)
      <span onmouseout="hideTip(event, 'fs33', 67)" onmouseover="showTip(event, 'fs33', 67)" class="i">printfn</span> <span class="s">"</span><span class="s">codeTreeBuilt</span><span class="s">"</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 68)" onmouseover="showTip(event, 'fs36', 68)" class="i">dic</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 69)" onmouseover="showTip(event, 'fs35', 69)" class="i">Huffman</span><span class="o">.</span><span class="i">makeEncoderDic</span> <span onmouseout="hideTip(event, 'fs34', 70)" onmouseover="showTip(event, 'fs34', 70)" class="i">codeTree</span>
      <span onmouseout="hideTip(event, 'fs33', 71)" onmouseover="showTip(event, 'fs33', 71)" class="i">printfn</span> <span class="s">"</span><span class="s">dicBuilt</span><span class="s">"</span>
      <span onmouseout="hideTip(event, 'fs35', 72)" onmouseover="showTip(event, 'fs35', 72)" class="i">Huffman</span><span class="o">.</span><span class="i">encode</span> <span onmouseout="hideTip(event, 'fs36', 73)" onmouseover="showTip(event, 'fs36', 73)" class="i">dic</span>, <span onmouseout="hideTip(event, 'fs35', 74)" onmouseover="showTip(event, 'fs35', 74)" class="i">Huffman</span><span class="o">.</span><span class="i">decode</span> <span onmouseout="hideTip(event, 'fs34', 75)" onmouseover="showTip(event, 'fs34', 75)" class="i">codeTree</span>
   
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 76)" onmouseover="showTip(event, 'fs37', 76)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs38', 77)" onmouseover="showTip(event, 'fs38', 77)" class="i">chunkSize</span> (<span onmouseout="hideTip(event, 'fs39', 78)" onmouseover="showTip(event, 'fs39', 78)" class="i">a</span> <span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs40', 79)" onmouseover="showTip(event, 'fs40', 79)" class="i">array</span>) <span class="o">=</span>
      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs41', 80)" onmouseover="showTip(event, 'fs41', 80)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs42', 81)" onmouseover="showTip(event, 'fs42', 81)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 82)" onmouseover="showTip(event, 'fs8', 82)" class="i">seq</span> { <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs39', 83)" onmouseover="showTip(event, 'fs39', 83)" class="i">a</span><span class="o">.</span>[ (<span class="n">0</span><span class="o">+</span><span onmouseout="hideTip(event, 'fs42', 84)" onmouseover="showTip(event, 'fs42', 84)" class="i">i</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs38', 85)" onmouseover="showTip(event, 'fs38', 85)" class="i">chunkSize</span>)<span class="o">..</span>((<span onmouseout="hideTip(event, 'fs42', 86)" onmouseover="showTip(event, 'fs42', 86)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span><span onmouseout="hideTip(event, 'fs38', 87)" onmouseover="showTip(event, 'fs38', 87)" class="i">chunkSize</span><span class="o">-</span><span class="n">1</span>)];  <span class="k">if</span> ((<span onmouseout="hideTip(event, 'fs42', 88)" onmouseover="showTip(event, 'fs42', 88)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span> <span onmouseout="hideTip(event, 'fs38', 89)" onmouseover="showTip(event, 'fs38', 89)" class="i">chunkSize</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs39', 90)" onmouseover="showTip(event, 'fs39', 90)" class="i">a</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 91)" onmouseover="showTip(event, 'fs43', 91)" class="i">Length</span>) <span class="k">then</span> <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs41', 92)" onmouseover="showTip(event, 'fs41', 92)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs42', 93)" onmouseover="showTip(event, 'fs42', 93)" class="i">i</span><span class="o">+</span><span class="n">1</span>)} 
      <span onmouseout="hideTip(event, 'fs41', 94)" onmouseover="showTip(event, 'fs41', 94)" class="i">loop</span> <span class="n">0</span> 

   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 95)" onmouseover="showTip(event, 'fs44', 95)" class="i">blockSize</span> <span class="o">=</span> [<span class="n">15</span>]<span class="c">//][3;5;7;9;11;13;15]</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 96)" onmouseover="showTip(event, 'fs45', 96)" class="i">sizes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs44', 97)" onmouseover="showTip(event, 'fs44', 97)" class="i">blockSize</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 98)" onmouseover="showTip(event, 'fs14', 98)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 99)" onmouseover="showTip(event, 'fs15', 99)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs46', 100)" onmouseover="showTip(event, 'fs46', 100)" class="i">l</span> <span class="k">-&gt;</span>  <span class="k">try</span>
                                                   <span onmouseout="hideTip(event, 'fs33', 101)" onmouseover="showTip(event, 'fs33', 101)" class="i">printfn</span> <span class="s">"</span><span class="s">starting</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs47', 102)" onmouseover="showTip(event, 'fs47', 102)" class="i">encoder</span>, <span onmouseout="hideTip(event, 'fs48', 103)" onmouseover="showTip(event, 'fs48', 103)" class="i">decoder</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 104)" onmouseover="showTip(event, 'fs23', 104)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs22', 105)" onmouseover="showTip(event, 'fs22', 105)" class="i">p</span> <span onmouseout="hideTip(event, 'fs46', 106)" onmouseover="showTip(event, 'fs46', 106)" class="i">l</span>
                                                   <span onmouseout="hideTip(event, 'fs33', 107)" onmouseover="showTip(event, 'fs33', 107)" class="i">printfn</span> <span class="s">"</span><span class="s">Encoder</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 108)" onmouseover="showTip(event, 'fs49', 108)" class="i">message</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs2', 109)" onmouseover="showTip(event, 'fs2', 109)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs22', 110)" onmouseover="showTip(event, 'fs22', 110)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 111)" onmouseover="showTip(event, 'fs50', 111)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 112)" onmouseover="showTip(event, 'fs51', 112)" class="i">take</span>(<span onmouseout="hideTip(event, 'fs46', 113)" onmouseover="showTip(event, 'fs46', 113)" class="i">l</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs52', 114)" onmouseover="showTip(event, 'fs52', 114)" class="i">int</span>(<span class="i">Math</span><span class="o">.</span><span class="i">Floor</span>(<span class="n">12330.</span><span class="o">/</span>(<span onmouseout="hideTip(event, 'fs32', 115)" onmouseover="showTip(event, 'fs32', 115)" class="i">float</span> <span onmouseout="hideTip(event, 'fs46', 116)" onmouseover="showTip(event, 'fs46', 116)" class="i">l</span>))))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 117)" onmouseover="showTip(event, 'fs50', 117)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 118)" onmouseover="showTip(event, 'fs53', 118)" class="i">toArray</span>                                 
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 119)" onmouseover="showTip(event, 'fs54', 119)" class="i">sizeOriginal</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs49', 120)" onmouseover="showTip(event, 'fs49', 120)" class="i">message</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 121)" onmouseover="showTip(event, 'fs43', 121)" class="i">Length</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 122)" onmouseover="showTip(event, 'fs55', 122)" class="i">a</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs37', 123)" onmouseover="showTip(event, 'fs37', 123)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs46', 124)" onmouseover="showTip(event, 'fs46', 124)" class="i">l</span> <span onmouseout="hideTip(event, 'fs49', 125)" onmouseover="showTip(event, 'fs49', 125)" class="i">message</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 126)" onmouseover="showTip(event, 'fs50', 126)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 127)" onmouseover="showTip(event, 'fs56', 127)" class="i">map</span> <span onmouseout="hideTip(event, 'fs50', 128)" onmouseover="showTip(event, 'fs50', 128)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 129)" onmouseover="showTip(event, 'fs57', 129)" class="i">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 130)" onmouseover="showTip(event, 'fs50', 130)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 131)" onmouseover="showTip(event, 'fs57', 131)" class="i">toList</span>)
                                                   <span onmouseout="hideTip(event, 'fs33', 132)" onmouseover="showTip(event, 'fs33', 132)" class="i">printfn</span> <span class="s">"</span><span class="s">chunked</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs58', 133)" onmouseover="showTip(event, 'fs58', 133)" class="i">compressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 134)" onmouseover="showTip(event, 'fs47', 134)" class="i">encoder</span> <span onmouseout="hideTip(event, 'fs55', 135)" onmouseover="showTip(event, 'fs55', 135)" class="i">a</span> 
                                                   <span onmouseout="hideTip(event, 'fs33', 136)" onmouseover="showTip(event, 'fs33', 136)" class="i">printfn</span> <span class="s">"</span><span class="s">compressed</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs59', 137)" onmouseover="showTip(event, 'fs59', 137)" class="i">sizeCompressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs58', 138)" onmouseover="showTip(event, 'fs58', 138)" class="i">compressed</span><span class="o">.</span><span class="i">Length</span>
                                                   <span onmouseout="hideTip(event, 'fs59', 139)" onmouseover="showTip(event, 'fs59', 139)" class="i">sizeCompressed</span> 
                                                <span class="k">with</span> | <span class="o">:?</span> <span onmouseout="hideTip(event, 'fs5', 140)" onmouseover="showTip(event, 'fs5', 140)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 141)" onmouseover="showTip(event, 'fs60', 141)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 142)" onmouseover="showTip(event, 'fs61', 142)" class="i">Generic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 143)" onmouseover="showTip(event, 'fs62', 143)" class="i">KeyNotFoundException</span> <span class="k">as</span> <span onmouseout="hideTip(event, 'fs63', 144)" onmouseover="showTip(event, 'fs63', 144)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 145)" onmouseover="showTip(event, 'fs33', 145)" class="i">printfn</span> <span class="s">"</span><span class="s">key</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">"</span> (<span onmouseout="hideTip(event, 'fs63', 146)" onmouseover="showTip(event, 'fs63', 146)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 147)" onmouseover="showTip(event, 'fs64', 147)" class="i">ToString</span>()); <span onmouseout="hideTip(event, 'fs65', 148)" onmouseover="showTip(event, 'fs65', 148)" class="i">failwith</span> <span class="s">"</span><span class="s">toto</span><span class="s">"</span>
                                                   )</pre>


<p>Note that the Shannon compressibility is just a way to expand that witnessed imbalance and change the length of the transmitted characters.
It does <strong>not</strong> tell you <strong>where</strong> to find that imbalance.
If you have a series of 999 0 followed by a series of 999 1, and you look at the distribution of the population made of the individual items, 
you find that it is impossible to compress it. and it is if you look at each bit that way.</p>

<p>If you look at the population made of the length of the repeated pattern, and you find that it is always 998, you can compress that information into 0 bits.
To transmit the message, you could transmit the first bit, followed by 0 bit.</p>

<p>Note furthermore, that Shannon encoding requires the recipient to know the CodeTree, because he knows the distribution for instance.
In case one exploit the found structure, then the recipient should know the CodeTree for the variable (in our case "length of the repetition"), 
the layout of the transmission (the initial value code, followed by the code identifying the length (this is 0 bit)) and, 
from the decoded sequence of variables (in our case, X = the said bit, repetition = 998), how to reconstruct the expanded sequence.</p>

<p>This is a lot of information to transmit, and a tradeoff exists between introducing a variable, which entails to transmit the
codetree, and the reduction this will.</p>

          <div class="tip" id="fs1">module BlockCoding<br><br>from Shannon</div>
<div class="tip" id="fs2">val stream : p:float -&gt; seq&lt;int&gt;<br><br>Full name: Shannon.BlockCoding.stream</div>
<div class="tip" id="fs3">val p : float</div>
<div class="tip" id="fs4">val rnd : System.Random</div>
<div class="tip" id="fs5">namespace System</div>
<div class="tip" id="fs6">Multiple items<br>type Random =<br>&nbsp;&nbsp;new : unit -&gt; Random + 1 overload<br>&nbsp;&nbsp;member Next : unit -&gt; int + 2 overloads<br>&nbsp;&nbsp;member NextBytes : buffer:byte[] -&gt; unit<br>&nbsp;&nbsp;member NextDouble : unit -&gt; float<br><br>Full name: System.Random<br><br>--------------------<br>System.Random() : unit<br>System.Random(Seed: int) : unit</div>
<div class="tip" id="fs7">val loop : seq&lt;int&gt;</div>
<div class="tip" id="fs8">Multiple items<br>val seq : sequence:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Core.Operators.seq<br><br>--------------------<br>type seq&lt;'T&gt; = System.Collections.Generic.IEnumerable&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs9">System.Random.NextDouble() : float</div>
<div class="tip" id="fs10">val enumerate : basen:int -&gt; _arg1:int -&gt; int list list<br><br>Full name: Shannon.BlockCoding.enumerate</div>
<div class="tip" id="fs11">val basen : int</div>
<div class="tip" id="fs12">val n : int</div>
<div class="tip" id="fs13">val enext : int list list</div>
<div class="tip" id="fs14">Multiple items<br>module List<br><br>from Microsoft.FSharp.Collections<br><br>--------------------<br>type List&lt;'T&gt; =<br>&nbsp;&nbsp;| ( [] )<br>&nbsp;&nbsp;| ( :: ) of 'T * 'T list<br>&nbsp;&nbsp;interface IEnumerable<br>&nbsp;&nbsp;interface IEnumerable&lt;'T&gt;<br>&nbsp;&nbsp;member Head : 'T<br>&nbsp;&nbsp;member IsEmpty : bool<br>&nbsp;&nbsp;member Item : index:int -&gt; 'T with get<br>&nbsp;&nbsp;member Length : int<br>&nbsp;&nbsp;member Tail : 'T list<br>&nbsp;&nbsp;static member Cons : head:'T * tail:'T list -&gt; 'T list<br>&nbsp;&nbsp;static member Empty : 'T list<br><br>Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs15">val map : mapping:('T -&gt; 'U) -&gt; list:'T list -&gt; 'U list<br><br>Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs16">val x : int</div>
<div class="tip" id="fs17">val l : int list</div>
<div class="tip" id="fs18">static member List.Cons : head:'T * tail:'T list -&gt; 'T list</div>
<div class="tip" id="fs19">val concat : lists:seq&lt;'T list&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.concat</div>
<div class="tip" id="fs20">val r : int list list<br><br>Full name: Shannon.BlockCoding.r</div>
<div class="tip" id="fs21">val lengthCode : int<br><br>Full name: Shannon.BlockCoding.lengthCode</div>
<div class="tip" id="fs22">val p : float<br><br>Full name: Shannon.BlockCoding.p</div>
<div class="tip" id="fs23">val generateEncoderDecoder : p:'a -&gt; lengthCode:int -&gt; 'b * 'c<br><br>Full name: Shannon.BlockCoding.generateEncoderDecoder</div>
<div class="tip" id="fs24">val p : 'a</div>
<div class="tip" id="fs25">val lengthCode : int</div>
<div class="tip" id="fs26">val lp : float</div>
<div class="tip" id="fs27">val nlp : float</div>
<div class="tip" id="fs28">val sequences : (int list * float) list</div>
<div class="tip" id="fs29">val s : int list</div>
<div class="tip" id="fs30">val ones : float</div>
<div class="tip" id="fs31">val sum : list:'T list -&gt; 'T (requires member ( + ) and member get_Zero)<br><br>Full name: Microsoft.FSharp.Collections.List.sum</div>
<div class="tip" id="fs32">Multiple items<br>val float : value:'T -&gt; float (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.float<br><br>--------------------<br>type float&lt;'Measure&gt; = float<br><br>Full name: Microsoft.FSharp.Core.float&lt;_&gt;<br><br>--------------------<br>type float = System.Double<br><br>Full name: Microsoft.FSharp.Core.float</div>
<div class="tip" id="fs33">val printfn : format:Printf.TextWriterFormat&lt;'T&gt; -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs34">val codeTree : obj</div>
<div class="tip" id="fs35">module Huffman</div>
<div class="tip" id="fs36">val dic : obj</div>
<div class="tip" id="fs37">val chunkExact : chunkSize:int -&gt; a:'a array -&gt; seq&lt;'a []&gt;<br><br>Full name: Shannon.BlockCoding.chunkExact</div>
<div class="tip" id="fs38">val chunkSize : int</div>
<div class="tip" id="fs39">val a : 'a array</div>
<div class="tip" id="fs40">type 'T array = 'T []<br><br>Full name: Microsoft.FSharp.Core.array&lt;_&gt;</div>
<div class="tip" id="fs41">val loop : (int -&gt; seq&lt;'a []&gt;)</div>
<div class="tip" id="fs42">val i : int</div>
<div class="tip" id="fs43">property System.Array.Length: int</div>
<div class="tip" id="fs44">val blockSize : int list<br><br>Full name: Shannon.BlockCoding.blockSize</div>
<div class="tip" id="fs45">val sizes : obj list<br><br>Full name: Shannon.BlockCoding.sizes</div>
<div class="tip" id="fs46">val l : int</div>
<div class="tip" id="fs47">val encoder : (int list list -&gt; obj)</div>
<div class="tip" id="fs48">val decoder : obj</div>
<div class="tip" id="fs49">val message : int []</div>
<div class="tip" id="fs50">module Seq<br><br>from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs51">val take : count:int -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.take</div>
<div class="tip" id="fs52">Multiple items<br>val int : value:'T -&gt; int (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.int<br><br>--------------------<br>type int&lt;'Measure&gt; = int<br><br>Full name: Microsoft.FSharp.Core.int&lt;_&gt;<br><br>--------------------<br>type int = int32<br><br>Full name: Microsoft.FSharp.Core.int</div>
<div class="tip" id="fs53">val toArray : source:seq&lt;'T&gt; -&gt; 'T []<br><br>Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs54">val sizeOriginal : int</div>
<div class="tip" id="fs55">val a : int list list</div>
<div class="tip" id="fs56">val map : mapping:('T -&gt; 'U) -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'U&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs57">val toList : source:seq&lt;'T&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs58">val compressed : obj</div>
<div class="tip" id="fs59">val sizeCompressed : obj</div>
<div class="tip" id="fs60">namespace System.Collections</div>
<div class="tip" id="fs61">namespace System.Collections.Generic</div>
<div class="tip" id="fs62">Multiple items<br>type KeyNotFoundException =<br>&nbsp;&nbsp;inherit SystemException<br>&nbsp;&nbsp;new : unit -&gt; KeyNotFoundException + 2 overloads<br><br>Full name: System.Collections.Generic.KeyNotFoundException<br><br>--------------------<br>System.Collections.Generic.KeyNotFoundException() : unit<br>System.Collections.Generic.KeyNotFoundException(message: string) : unit<br>System.Collections.Generic.KeyNotFoundException(message: string, innerException: exn) : unit</div>
<div class="tip" id="fs63">val e : System.Collections.Generic.KeyNotFoundException</div>
<div class="tip" id="fs64">System.Exception.ToString() : string</div>
<div class="tip" id="fs65">val failwith : message:string -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.Operators.failwith</div>

</div></body></html>

    </article>
  </div>
<spacer height="200"></spacer>

 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'xquantnanoc'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
 
    </div>
    </div>
  </body>
</html>

