<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> xQuant  Huffman theorem       </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="These are various notes of computer science subjects. They sometime have accompanying F# implementation They are authored in a litterate programming style and each document is a valid.">
    <meta name="author" content="Nicolas Rolland">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="alternate" type="application/rss+xml" title="xQuant.net Atom feed" href="http://xquant.net/blog/feed.xml" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/stylesheet/tooltips.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/style.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/jsxgraph.css" />

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=css&lang=ml&lang=scala&lang=hs"></script>
    <script src="/javascript/tips.js" type="text/javascript"></script>
    <script src="/javascript/jsxgraphcore.js" type="text/javascript"></script>
    <script>
        JXG.Options.text.useMathJax = true;
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [['$','$'], ['\\(','\\)']],
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
          }
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i = 0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
      </script>
     <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39755928-1', 'xquant.net');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-45978109-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
  <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
        <a class="brand" href="#">Huffman theorem  </a>
          <hr>
        <ul class="nav">
          <li><a href="/">Home</a></li>
          <li><a href="/notes">Notes</a></li>
           <li><a href="/about">About</a></li>
           <li class="divider"></li>
        </ul>
      </div>
      </div>
      <hr>
    <div class="centered">
      
  <div class='post'>
    <article>
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="span9" id="main">
          <h1>Huffman theorem</h1>

<p>To illustrate the Shannon theorem, we'll need to start with the entropic, or Huffman, coding.
This was recently submitted as part of Martin Odersky's excellent course on functional programming 
using scala and is a beautiful illustration of principled recursion.</p>

<h3>Huffman coding</h3>

<p>Let's magine we want to transmit a <strong>string</strong>, which is sequence of <strong>characters</strong>, or <strong>codewords</strong> coming 
from a <strong>vocabulary</strong> of size <strong>exp N</strong>.
As a trivial step toward a minimal encoding of our message, we can replace each word with a series of N bits.</p>

<p>Let's further make the assumption that we <em>know how relatively frequent</em> each character is.
Considering this, we'd want to remap our vocabulary to a <em>new</em> one, where the most <strong>frequent</strong> words are mapped to <strong>small</strong> representations.
(By the <a href="https://en.wikipedia.org/wiki/Kraft's_inequality">Kraft inequality</a>, it implies that some other words, 
hopefully less frequent, have to be longer than N)</p>

<p>Let's look at how we'd do such a coding with in F#.</p>

<h4>CodeTree structure</h4>

<p>Our main structure will be a binary tree, which holds the list of characters it optimally represents.
Such a tree, whose Leaves contains the items of our dictionary, makes the correspondance between a sequence of 1 and 0 
leading to the leafs, and the characters of our dictionary.</p>

<pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Generic</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 4)" onmouseover="showTip(event, 'fs1', 4)" class="i">System</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">Leaf</span> <span class="k">of</span> <span class="o">'</span><span class="i">T</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">float</span> 
    | <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">Fork</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">list</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">float</span></pre>


<p>In the revered tradition of recursion, we'll want to do a series of steps to growing small trees, optimal for small
vocabularies, to a bigger one, optimal on the combined vocabulary.
A few helper methods are needed for that.</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs4', 13)" onmouseover="showTip(event, 'fs4', 13)" class="i">CodeTree</span> <span class="o">=</span> 
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 14)" onmouseover="showTip(event, 'fs9', 14)" class="i">chars</span>  <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="i">c</span>,_) <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">c</span>] | <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="i">Fork</span>(_,_,<span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">l</span>,_) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">l</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 21)" onmouseover="showTip(event, 'fs12', 21)" class="i">weight</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 22)" onmouseover="showTip(event, 'fs5', 22)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 23)" onmouseover="showTip(event, 'fs10', 23)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">w</span>) <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs13', 25)" onmouseover="showTip(event, 'fs13', 25)" class="i">w</span>  | <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">Fork</span>(_,_,_,<span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 28)" onmouseover="showTip(event, 'fs13', 28)" class="i">w</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 29)" onmouseover="showTip(event, 'fs14', 29)" class="i">merge</span> <span onmouseout="hideTip(event, 'fs15', 30)" onmouseover="showTip(event, 'fs15', 30)" class="i">addweight</span> <span onmouseout="hideTip(event, 'fs16', 31)" onmouseover="showTip(event, 'fs16', 31)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 32)" onmouseover="showTip(event, 'fs17', 32)" class="i">ct2</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs7', 33)" onmouseover="showTip(event, 'fs7', 33)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs16', 34)" onmouseover="showTip(event, 'fs16', 34)" class="i">ct1</span>, <span onmouseout="hideTip(event, 'fs17', 35)" onmouseover="showTip(event, 'fs17', 35)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs9', 36)" onmouseover="showTip(event, 'fs9', 36)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs16', 37)" onmouseover="showTip(event, 'fs16', 37)" class="i">ct1</span> <span class="o">@</span> <span onmouseout="hideTip(event, 'fs9', 38)" onmouseover="showTip(event, 'fs9', 38)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs17', 39)" onmouseover="showTip(event, 'fs17', 39)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs15', 40)" onmouseover="showTip(event, 'fs15', 40)" class="i">addweight</span>(<span onmouseout="hideTip(event, 'fs12', 41)" onmouseover="showTip(event, 'fs12', 41)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs16', 42)" onmouseover="showTip(event, 'fs16', 42)" class="i">ct1</span>)(<span onmouseout="hideTip(event, 'fs12', 43)" onmouseover="showTip(event, 'fs12', 43)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs17', 44)" onmouseover="showTip(event, 'fs17', 44)" class="i">ct2</span>))</pre>


<p>If our weights are just straight frequencies, we'll add them. But sometimes using logprob is required, so we abstract the way to "add" such quantities</p>

<pre class="fssnip">
   <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs18', 45)" onmouseover="showTip(event, 'fs18', 45)" class="i">logsumexp</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="i">logx</span> <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="i">logy</span> <span class="o">=</span> 
      <span class="k">if</span> <span onmouseout="hideTip(event, 'fs19', 48)" onmouseover="showTip(event, 'fs19', 48)" class="i">logx</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs20', 49)" onmouseover="showTip(event, 'fs20', 49)" class="i">logy</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs19', 50)" onmouseover="showTip(event, 'fs19', 50)" class="i">logx</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 51)" onmouseover="showTip(event, 'fs21', 51)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 52)" onmouseover="showTip(event, 'fs22', 52)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 53)" onmouseover="showTip(event, 'fs21', 53)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 54)" onmouseover="showTip(event, 'fs23', 54)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="i">logy</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs19', 56)" onmouseover="showTip(event, 'fs19', 56)" class="i">logx</span>))
                     <span class="k">else</span> <span onmouseout="hideTip(event, 'fs20', 57)" onmouseover="showTip(event, 'fs20', 57)" class="i">logy</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 58)" onmouseover="showTip(event, 'fs21', 58)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 59)" onmouseover="showTip(event, 'fs22', 59)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 60)" onmouseover="showTip(event, 'fs21', 60)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs19', 62)" onmouseover="showTip(event, 'fs19', 62)" class="i">logx</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs20', 63)" onmouseover="showTip(event, 'fs20', 63)" class="i">logy</span>))

   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 64)" onmouseover="showTip(event, 'fs24', 64)" class="i">mergePlus</span> <span onmouseout="hideTip(event, 'fs16', 65)" onmouseover="showTip(event, 'fs16', 65)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 66)" onmouseover="showTip(event, 'fs17', 66)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 67)" onmouseover="showTip(event, 'fs14', 67)" class="i">merge</span> (<span class="o">+</span>) <span onmouseout="hideTip(event, 'fs16', 68)" onmouseover="showTip(event, 'fs16', 68)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 69)" onmouseover="showTip(event, 'fs17', 69)" class="i">ct2</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 70)" onmouseover="showTip(event, 'fs25', 70)" class="i">mergeLogPlus</span> <span onmouseout="hideTip(event, 'fs16', 71)" onmouseover="showTip(event, 'fs16', 71)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 72)" onmouseover="showTip(event, 'fs17', 72)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 73)" onmouseover="showTip(event, 'fs14', 73)" class="i">merge</span> (<span onmouseout="hideTip(event, 'fs18', 74)" onmouseover="showTip(event, 'fs18', 74)" class="i">logsumexp</span>) <span onmouseout="hideTip(event, 'fs16', 75)" onmouseover="showTip(event, 'fs16', 75)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 76)" onmouseover="showTip(event, 'fs17', 76)" class="i">ct2</span></pre>


<p>Another thing to consider is that we'll want to perform operation which "fold" our tree, that is, get one final value of a type 'a,
whose computation comes from a complete traversal of the structure. So we define a generalized fold on our structure. 
Note that the is a folding function to the said type for each constructor : This generalizes the fold on a list and is an example of 'catamorphism'.
(as everyone knows, a catamorphism is just the categorical dual of an anamorphism, with some bananas)</p>

<pre class="fssnip">
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 77)" onmouseover="showTip(event, 'fs26', 77)" class="i">fold</span> (<span onmouseout="hideTip(event, 'fs27', 78)" onmouseover="showTip(event, 'fs27', 78)" class="i">fNode</span><span class="o">:</span><span class="o">'</span><span class="i">a</span><span class="k">-&gt;</span><span class="o">'</span><span class="i">a</span><span class="k">-&gt;</span><span class="o">'</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs28', 79)" onmouseover="showTip(event, 'fs28', 79)" class="i">fLeaf</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span class="k">-&gt;</span> <span class="o">'</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="i">x</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs4', 81)" onmouseover="showTip(event, 'fs4', 81)" class="i">CodeTree</span>) <span class="o">=</span> 
    <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs30', 82)" onmouseover="showTip(event, 'fs30', 82)" class="i">f</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 83)" onmouseover="showTip(event, 'fs5', 83)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs31', 84)" onmouseover="showTip(event, 'fs31', 84)" class="i">e</span>,<span onmouseout="hideTip(event, 'fs13', 85)" onmouseover="showTip(event, 'fs13', 85)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 86)" onmouseover="showTip(event, 'fs28', 86)" class="i">fLeaf</span>(<span onmouseout="hideTip(event, 'fs31', 87)" onmouseover="showTip(event, 'fs31', 87)" class="i">e</span>) 
                         | <span onmouseout="hideTip(event, 'fs7', 88)" onmouseover="showTip(event, 'fs7', 88)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs32', 89)" onmouseover="showTip(event, 'fs32', 89)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs33', 90)" onmouseover="showTip(event, 'fs33', 90)" class="i">r</span>,<span onmouseout="hideTip(event, 'fs34', 91)" onmouseover="showTip(event, 'fs34', 91)" class="i">cs</span>,<span onmouseout="hideTip(event, 'fs13', 92)" onmouseover="showTip(event, 'fs13', 92)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 93)" onmouseover="showTip(event, 'fs27', 93)" class="i">fNode</span>(<span onmouseout="hideTip(event, 'fs30', 94)" onmouseover="showTip(event, 'fs30', 94)" class="i">f</span> <span onmouseout="hideTip(event, 'fs32', 95)" onmouseover="showTip(event, 'fs32', 95)" class="i">l</span>)(<span onmouseout="hideTip(event, 'fs30', 96)" onmouseover="showTip(event, 'fs30', 96)" class="i">f</span> <span onmouseout="hideTip(event, 'fs33', 97)" onmouseover="showTip(event, 'fs33', 97)" class="i">r</span>) 
    <span onmouseout="hideTip(event, 'fs30', 98)" onmouseover="showTip(event, 'fs30', 98)" class="i">f</span> <span onmouseout="hideTip(event, 'fs29', 99)" onmouseover="showTip(event, 'fs29', 99)" class="i">x</span> </pre>


<p>We'll also use the following function which splits a list into two parts, while a condition f(e) is verified</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs35', 100)" onmouseover="showTip(event, 'fs35', 100)" class="i">List</span> <span class="o">=</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 101)" onmouseover="showTip(event, 'fs36', 101)" class="i">span</span> <span onmouseout="hideTip(event, 'fs37', 102)" onmouseover="showTip(event, 'fs37', 102)" class="i">f</span> <span onmouseout="hideTip(event, 'fs38', 103)" onmouseover="showTip(event, 'fs38', 103)" class="i">xs</span> <span class="o">=</span> 
     <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 104)" onmouseover="showTip(event, 'fs11', 104)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 105)" onmouseover="showTip(event, 'fs39', 105)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 106)" onmouseover="showTip(event, 'fs38', 106)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 107)" onmouseover="showTip(event, 'fs35', 107)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 108)" onmouseover="showTip(event, 'fs40', 108)" class="i">fold</span>(<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs11', 109)" onmouseover="showTip(event, 'fs11', 109)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 110)" onmouseover="showTip(event, 'fs39', 110)" class="i">r</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 111)" onmouseover="showTip(event, 'fs8', 111)" class="i">list</span>) <span onmouseout="hideTip(event, 'fs41', 112)" onmouseover="showTip(event, 'fs41', 112)" class="i">e</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs37', 113)" onmouseover="showTip(event, 'fs37', 113)" class="i">f</span> <span onmouseout="hideTip(event, 'fs41', 114)" onmouseover="showTip(event, 'fs41', 114)" class="i">e</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs41', 115)" onmouseover="showTip(event, 'fs41', 115)" class="i">e</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs11', 116)" onmouseover="showTip(event, 'fs11', 116)" class="i">l</span>, <span onmouseout="hideTip(event, 'fs39', 117)" onmouseover="showTip(event, 'fs39', 117)" class="i">r</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 118)" onmouseover="showTip(event, 'fs42', 118)" class="i">Tail</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs11', 119)" onmouseover="showTip(event, 'fs11', 119)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 120)" onmouseover="showTip(event, 'fs39', 120)" class="i">r</span> ) 
                              ([],<span onmouseout="hideTip(event, 'fs38', 121)" onmouseover="showTip(event, 'fs38', 121)" class="i">xs</span>)
     <span onmouseout="hideTip(event, 'fs11', 122)" onmouseover="showTip(event, 'fs11', 122)" class="i">l</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 123)" onmouseover="showTip(event, 'fs35', 123)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 124)" onmouseover="showTip(event, 'fs43', 124)" class="i">rev</span>, <span onmouseout="hideTip(event, 'fs39', 125)" onmouseover="showTip(event, 'fs39', 125)" class="i">r</span>


<span class="k">module</span> <span class="i">Huffman</span> <span class="o">=</span> 
  <span class="k">open</span> <span onmouseout="hideTip(event, 'fs44', 126)" onmouseover="showTip(event, 'fs44', 126)" class="i">CodeTree</span></pre>


<p>This is just to build some frequency table from a sample.
If we already know, or posit, the frequencies, we don't need it.</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 127)" onmouseover="showTip(event, 'fs45', 127)" class="i">buildFreq</span> (<span onmouseout="hideTip(event, 'fs46', 128)" onmouseover="showTip(event, 'fs46', 128)" class="i">sample</span> <span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 129)" onmouseover="showTip(event, 'fs8', 129)" class="i">list</span>) <span class="o">=</span> 
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs46', 130)" onmouseover="showTip(event, 'fs46', 130)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 131)" onmouseover="showTip(event, 'fs47', 131)" class="i">Length</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> []
    <span class="k">else</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 132)" onmouseover="showTip(event, 'fs46', 132)" class="i">sample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 133)" onmouseover="showTip(event, 'fs46', 133)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 134)" onmouseover="showTip(event, 'fs35', 134)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 135)" onmouseover="showTip(event, 'fs48', 135)" class="i">sort</span>
         <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs49', 136)" onmouseover="showTip(event, 'fs49', 136)" class="i">count</span> (<span onmouseout="hideTip(event, 'fs50', 137)" onmouseover="showTip(event, 'fs50', 137)" class="i">sample</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 138)" onmouseover="showTip(event, 'fs8', 138)" class="i">list</span>) <span class="o">=</span> 
             [ <span class="k">if</span> <span onmouseout="hideTip(event, 'fs50', 139)" onmouseover="showTip(event, 'fs50', 139)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 140)" onmouseover="showTip(event, 'fs47', 140)" class="i">Length</span> <span class="o">&lt;&gt;</span> <span class="n">0</span> <span class="k">then</span> 
                 <span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 141)" onmouseover="showTip(event, 'fs51', 141)" class="i">left</span>, <span onmouseout="hideTip(event, 'fs52', 142)" onmouseover="showTip(event, 'fs52', 142)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs50', 143)" onmouseover="showTip(event, 'fs50', 143)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 144)" onmouseover="showTip(event, 'fs35', 144)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 145)" onmouseover="showTip(event, 'fs36', 145)" class="i">span</span> ((<span class="o">=</span>) <span onmouseout="hideTip(event, 'fs50', 146)" onmouseover="showTip(event, 'fs50', 146)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 147)" onmouseover="showTip(event, 'fs53', 147)" class="i">Head</span>)
                 <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs50', 148)" onmouseover="showTip(event, 'fs50', 148)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 149)" onmouseover="showTip(event, 'fs53', 149)" class="i">Head</span>,<span onmouseout="hideTip(event, 'fs51', 150)" onmouseover="showTip(event, 'fs51', 150)" class="i">left</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 151)" onmouseover="showTip(event, 'fs47', 151)" class="i">Length</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 152)" onmouseover="showTip(event, 'fs6', 152)" class="i">float</span>
                 <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs49', 153)" onmouseover="showTip(event, 'fs49', 153)" class="i">count</span> <span onmouseout="hideTip(event, 'fs52', 154)" onmouseover="showTip(event, 'fs52', 154)" class="i">right</span>  ]
         <span onmouseout="hideTip(event, 'fs49', 155)" onmouseover="showTip(event, 'fs49', 155)" class="i">count</span> <span onmouseout="hideTip(event, 'fs50', 156)" onmouseover="showTip(event, 'fs50', 156)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 157)" onmouseover="showTip(event, 'fs35', 157)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 158)" onmouseover="showTip(event, 'fs54', 158)" class="i">sortBy</span> <span onmouseout="hideTip(event, 'fs55', 159)" onmouseover="showTip(event, 'fs55', 159)" class="i">snd</span>        </pre>


<h3>The core recursion</h3>

<p>The next function is <strong>the core</strong> of the Huffman code construction.
It accepts a list of character and their frequency as input, and builds a sequence of list of optimal codes.</p>

<p>Remember that we want to go from an optimal CodeTrees for small vocabularies to a bigger one, optimal on the combined vocabulary.
When a vocabulary has only 1 word in it, a leaf necessitate 0 bits to identify which word the transmitted word is.</p>

<p>Given a list of optimal codetree, the assumption here is that merging the 2 least frequent one leads to a new 
optimal codetree.</p>

<p>To see this, reckon that the merge operation will translate to adding one bit to the new tree, which will be needed to choose between its subbranches.
Whatever merging comes after a merge, that one bit spent will alway be needed to identify the characters merged.</p>

<p>It should therefore be clear that, if we intend to lengthen our final code by one bit, it is optimal to do so with branches 
which are the least frequent of all. we therefore merge the least used CodeTrees.</p>

<p>So overall, we start by sorting the frequency list and making leaf of all characters, as there is no doubt that leaf are optimal for those, 
and apply the merging operation until only one CodeTree is left.</p>

<pre class="fssnip">
  <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs56', 160)" onmouseover="showTip(event, 'fs56', 160)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs57', 161)" onmouseover="showTip(event, 'fs57', 161)" class="i">merge</span> (<span onmouseout="hideTip(event, 'fs58', 162)" onmouseover="showTip(event, 'fs58', 162)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 163)" onmouseover="showTip(event, 'fs6', 163)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 164)" onmouseover="showTip(event, 'fs8', 164)" class="i">list</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs44', 165)" onmouseover="showTip(event, 'fs44', 165)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span>
  <span class="c">//This function accepts the Leaf list built at first call, until only one CodeTree remains in the list.</span>
  <span class="c">//At each step we only build optimal CodeTree, so the resulting tree is optimal for the whole dictionary.</span>
       <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs59', 166)" onmouseover="showTip(event, 'fs59', 166)" class="i">loop</span> <span class="o">=</span> <span class="k">function</span>        
       | [] <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs60', 167)" onmouseover="showTip(event, 'fs60', 167)" class="i">failwith</span> <span class="s">"</span><span class="s">not</span><span class="s"> </span><span class="s">possible</span><span class="s">"</span> 
       | [<span onmouseout="hideTip(event, 'fs33', 168)" onmouseover="showTip(event, 'fs33', 168)" class="i">r</span>] <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 169)" onmouseover="showTip(event, 'fs33', 169)" class="i">r</span>
       | <span onmouseout="hideTip(event, 'fs61', 170)" onmouseover="showTip(event, 'fs61', 170)" class="i">f</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs62', 171)" onmouseover="showTip(event, 'fs62', 171)" class="i">s</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs63', 172)" onmouseover="showTip(event, 'fs63', 172)" class="i">xs</span> <span class="k">-&gt;</span>
           <span class="c">//We merge the first and second CodeTree</span>
           <span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 173)" onmouseover="showTip(event, 'fs64', 173)" class="i">newCT</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 174)" onmouseover="showTip(event, 'fs57', 174)" class="i">merge</span> <span onmouseout="hideTip(event, 'fs61', 175)" onmouseover="showTip(event, 'fs61', 175)" class="i">f</span> <span onmouseout="hideTip(event, 'fs62', 176)" onmouseover="showTip(event, 'fs62', 176)" class="i">s</span>
           <span class="c">//we split the other CodeTree list at the weight of the new tree  </span>
           <span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 177)" onmouseover="showTip(event, 'fs65', 177)" class="i">left</span>,<span onmouseout="hideTip(event, 'fs66', 178)" onmouseover="showTip(event, 'fs66', 178)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 179)" onmouseover="showTip(event, 'fs35', 179)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 180)" onmouseover="showTip(event, 'fs36', 180)" class="i">span</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs67', 181)" onmouseover="showTip(event, 'fs67', 181)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 182)" onmouseover="showTip(event, 'fs12', 182)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs67', 183)" onmouseover="showTip(event, 'fs67', 183)" class="i">e</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs12', 184)" onmouseover="showTip(event, 'fs12', 184)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs64', 185)" onmouseover="showTip(event, 'fs64', 185)" class="i">newCT</span>) <span onmouseout="hideTip(event, 'fs63', 186)" onmouseover="showTip(event, 'fs63', 186)" class="i">xs</span>
           <span class="c">//insert the new Tree where, and then recurse, </span>
           <span class="c">//with a new list shorter by one from the previous iteration  </span>
           <span onmouseout="hideTip(event, 'fs59', 187)" onmouseover="showTip(event, 'fs59', 187)" class="i">loop</span>(<span onmouseout="hideTip(event, 'fs65', 188)" onmouseover="showTip(event, 'fs65', 188)" class="i">left</span> <span class="o">@</span> (<span onmouseout="hideTip(event, 'fs64', 189)" onmouseover="showTip(event, 'fs64', 189)" class="i">newCT</span><span class="o">::</span> <span onmouseout="hideTip(event, 'fs66', 190)" onmouseover="showTip(event, 'fs66', 190)" class="i">right</span>))
       <span onmouseout="hideTip(event, 'fs59', 191)" onmouseover="showTip(event, 'fs59', 191)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs58', 192)" onmouseover="showTip(event, 'fs58', 192)" class="i">distrib</span>  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 193)" onmouseover="showTip(event, 'fs35', 193)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 194)" onmouseover="showTip(event, 'fs54', 194)" class="i">sortBy</span>(<span onmouseout="hideTip(event, 'fs55', 195)" onmouseover="showTip(event, 'fs55', 195)" class="i">snd</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 196)" onmouseover="showTip(event, 'fs35', 196)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 197)" onmouseover="showTip(event, 'fs68', 197)" class="i">map</span>(<span onmouseout="hideTip(event, 'fs5', 198)" onmouseover="showTip(event, 'fs5', 198)" class="i">Leaf</span>))

  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 199)" onmouseover="showTip(event, 'fs69', 199)" class="i">buildCodeFromFreq</span>   (<span onmouseout="hideTip(event, 'fs58', 200)" onmouseover="showTip(event, 'fs58', 200)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 201)" onmouseover="showTip(event, 'fs6', 201)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 202)" onmouseover="showTip(event, 'fs8', 202)" class="i">list</span>)<span class="o">:</span> <span onmouseout="hideTip(event, 'fs44', 203)" onmouseover="showTip(event, 'fs44', 203)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 204)" onmouseover="showTip(event, 'fs56', 204)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs24', 205)" onmouseover="showTip(event, 'fs24', 205)" class="i">mergePlus</span>    <span onmouseout="hideTip(event, 'fs58', 206)" onmouseover="showTip(event, 'fs58', 206)" class="i">distrib</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 207)" onmouseover="showTip(event, 'fs70', 207)" class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs58', 208)" onmouseover="showTip(event, 'fs58', 208)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 209)" onmouseover="showTip(event, 'fs6', 209)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 210)" onmouseover="showTip(event, 'fs8', 210)" class="i">list</span>)<span class="o">:</span> <span onmouseout="hideTip(event, 'fs44', 211)" onmouseover="showTip(event, 'fs44', 211)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 212)" onmouseover="showTip(event, 'fs56', 212)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs25', 213)" onmouseover="showTip(event, 'fs25', 213)" class="i">mergeLogPlus</span> <span onmouseout="hideTip(event, 'fs58', 214)" onmouseover="showTip(event, 'fs58', 214)" class="i">distrib</span></pre>


<p>We can now <strong>decode</strong> a new string encoded with our new dictionnary</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 215)" onmouseover="showTip(event, 'fs71', 215)" class="i">decode</span> (<span onmouseout="hideTip(event, 'fs72', 216)" onmouseover="showTip(event, 'fs72', 216)" class="i">codeTree</span><span class="o">:</span>_ <span onmouseout="hideTip(event, 'fs44', 217)" onmouseover="showTip(event, 'fs44', 217)" class="i">CodeTree</span>) (<span onmouseout="hideTip(event, 'fs73', 218)" onmouseover="showTip(event, 'fs73', 218)" class="i">bits</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs74', 219)" onmouseover="showTip(event, 'fs74', 219)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 220)" onmouseover="showTip(event, 'fs8', 220)" class="i">list</span>) <span class="o">=</span>
       <span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 221)" onmouseover="showTip(event, 'fs75', 221)" class="i">o</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs73', 222)" onmouseover="showTip(event, 'fs73', 222)" class="i">bits</span> 
               <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 223)" onmouseover="showTip(event, 'fs35', 223)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 224)" onmouseover="showTip(event, 'fs40', 224)" class="i">fold</span>(<span class="k">fun</span> ((<span onmouseout="hideTip(event, 'fs7', 225)" onmouseover="showTip(event, 'fs7', 225)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs76', 226)" onmouseover="showTip(event, 'fs76', 226)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs77', 227)" onmouseover="showTip(event, 'fs77', 227)" class="i">r</span>,_,_)), <span onmouseout="hideTip(event, 'fs78', 228)" onmouseover="showTip(event, 'fs78', 228)" class="i">decMsg</span>) <span onmouseout="hideTip(event, 'fs79', 229)" onmouseover="showTip(event, 'fs79', 229)" class="i">b</span> <span class="k">-&gt;</span>  
                             <span class="k">match</span> (<span class="k">if</span> <span onmouseout="hideTip(event, 'fs79', 230)" onmouseover="showTip(event, 'fs79', 230)" class="i">b</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs76', 231)" onmouseover="showTip(event, 'fs76', 231)" class="i">l</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs77', 232)" onmouseover="showTip(event, 'fs77', 232)" class="i">r</span>) <span class="k">with</span> 
                             <span class="c">//we append the new character and continue with the original </span>
                             | <span onmouseout="hideTip(event, 'fs5', 233)" onmouseover="showTip(event, 'fs5', 233)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 234)" onmouseover="showTip(event, 'fs10', 234)" class="i">c</span>,_) <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs72', 235)" onmouseover="showTip(event, 'fs72', 235)" class="i">codeTree</span>, <span onmouseout="hideTip(event, 'fs10', 236)" onmouseover="showTip(event, 'fs10', 236)" class="i">c</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs78', 237)" onmouseover="showTip(event, 'fs78', 237)" class="i">decMsg</span>) 
                             <span class="c">//or we continue peeling off the chosen branch</span>
                             | <span onmouseout="hideTip(event, 'fs80', 238)" onmouseover="showTip(event, 'fs80', 238)" class="i">current</span>   <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs80', 239)" onmouseover="showTip(event, 'fs80', 239)" class="i">current</span> , <span onmouseout="hideTip(event, 'fs78', 240)" onmouseover="showTip(event, 'fs78', 240)" class="i">decMsg</span>))
                           <span class="c">//no decoded characters at 1st and the full Codetree to traverse</span>
                           (<span onmouseout="hideTip(event, 'fs72', 241)" onmouseover="showTip(event, 'fs72', 241)" class="i">codeTree</span>, [])
       <span onmouseout="hideTip(event, 'fs55', 242)" onmouseover="showTip(event, 'fs55', 242)" class="i">snd</span> <span onmouseout="hideTip(event, 'fs75', 243)" onmouseover="showTip(event, 'fs75', 243)" class="i">o</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 244)" onmouseover="showTip(event, 'fs35', 244)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 245)" onmouseover="showTip(event, 'fs43', 245)" class="i">rev</span></pre>


<p>And of course we can encode as well. In that case instead of searching for the correct leaf at each 
character by traversing the CodeTree, we build a map wich gives us in O(1) the new coded character.</p>

<p>Note the use of the generalized fold : Everytime we encouter a leaf,  we create a new Map which associates 
the character to the empty binary string. Every time we encouter a Fork, we add 0 to the entries of the left Map, 
and 1 to the right Map.</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs81', 246)" onmouseover="showTip(event, 'fs81', 246)" class="i">makeEncoderDic</span> (<span onmouseout="hideTip(event, 'fs82', 247)" onmouseover="showTip(event, 'fs82', 247)" class="i">tree</span><span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs44', 248)" onmouseover="showTip(event, 'fs44', 248)" class="i">CodeTree</span>) <span class="o">=</span> 
      <span onmouseout="hideTip(event, 'fs44', 249)" onmouseover="showTip(event, 'fs44', 249)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 250)" onmouseover="showTip(event, 'fs26', 250)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs83', 251)" onmouseover="showTip(event, 'fs83', 251)" class="i">lMap</span> <span onmouseout="hideTip(event, 'fs84', 252)" onmouseover="showTip(event, 'fs84', 252)" class="i">rMap</span> <span class="k">-&gt;</span> 
                        <span onmouseout="hideTip(event, 'fs83', 253)" onmouseover="showTip(event, 'fs83', 253)" class="i">lMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs85', 254)" onmouseover="showTip(event, 'fs85', 254)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 255)" onmouseover="showTip(event, 'fs86', 255)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs87', 256)" onmouseover="showTip(event, 'fs87', 256)" class="i">m</span> <span onmouseout="hideTip(event, 'fs88', 257)" onmouseover="showTip(event, 'fs88', 257)" class="i">k</span> <span onmouseout="hideTip(event, 'fs89', 258)" onmouseover="showTip(event, 'fs89', 258)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs87', 259)" onmouseover="showTip(event, 'fs87', 259)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 260)" onmouseover="showTip(event, 'fs90', 260)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs88', 261)" onmouseover="showTip(event, 'fs88', 261)" class="i">k</span>, <span class="n">0</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs89', 262)" onmouseover="showTip(event, 'fs89', 262)" class="i">v</span>)) 
                                        (<span onmouseout="hideTip(event, 'fs84', 263)" onmouseover="showTip(event, 'fs84', 263)" class="i">rMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs85', 264)" onmouseover="showTip(event, 'fs85', 264)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 265)" onmouseover="showTip(event, 'fs86', 265)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs87', 266)" onmouseover="showTip(event, 'fs87', 266)" class="i">m</span> <span onmouseout="hideTip(event, 'fs88', 267)" onmouseover="showTip(event, 'fs88', 267)" class="i">k</span> <span onmouseout="hideTip(event, 'fs89', 268)" onmouseover="showTip(event, 'fs89', 268)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs87', 269)" onmouseover="showTip(event, 'fs87', 269)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 270)" onmouseover="showTip(event, 'fs90', 270)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs88', 271)" onmouseover="showTip(event, 'fs88', 271)" class="i">k</span>, <span class="n">1</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs89', 272)" onmouseover="showTip(event, 'fs89', 272)" class="i">v</span>)) 
                                                         <span onmouseout="hideTip(event, 'fs85', 273)" onmouseover="showTip(event, 'fs85', 273)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 274)" onmouseover="showTip(event, 'fs91', 274)" class="i">empty</span>)) 
                   (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs92', 275)" onmouseover="showTip(event, 'fs92', 275)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs85', 276)" onmouseover="showTip(event, 'fs85', 276)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 277)" onmouseover="showTip(event, 'fs91', 277)" class="i">empty</span><span class="o">.</span><span class="i">Add</span>(<span onmouseout="hideTip(event, 'fs92', 278)" onmouseover="showTip(event, 'fs92', 278)" class="i">c</span>,[])) 
                   <span onmouseout="hideTip(event, 'fs82', 279)" onmouseover="showTip(event, 'fs82', 279)" class="i">tree</span></pre>


<p>Provided the map, the encode function is really just a lookup for each character...</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 280)" onmouseover="showTip(event, 'fs93', 280)" class="i">encode</span> (<span onmouseout="hideTip(event, 'fs94', 281)" onmouseover="showTip(event, 'fs94', 281)" class="i">dic</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs85', 282)" onmouseover="showTip(event, 'fs85', 282)" class="i">Map</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span>,<span onmouseout="hideTip(event, 'fs74', 283)" onmouseover="showTip(event, 'fs74', 283)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 284)" onmouseover="showTip(event, 'fs8', 284)" class="i">list</span><span class="o">&gt;</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 285)" onmouseover="showTip(event, 'fs35', 285)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 286)" onmouseover="showTip(event, 'fs68', 286)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs95', 287)" onmouseover="showTip(event, 'fs95', 287)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs94', 288)" onmouseover="showTip(event, 'fs94', 288)" class="i">dic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs96', 289)" onmouseover="showTip(event, 'fs96', 289)" class="i">Item</span>(<span onmouseout="hideTip(event, 'fs95', 290)" onmouseover="showTip(event, 'fs95', 290)" class="i">x</span>)) <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs35', 291)" onmouseover="showTip(event, 'fs35', 291)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 292)" onmouseover="showTip(event, 'fs97', 292)" class="i">concat</span></pre>


<p>Now we can verify that this indeed work by decoding a secret, courtesy of Marin Odersky-san</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs98', 293)" onmouseover="showTip(event, 'fs98', 293)" class="i">secret</span> <span class="o">=</span> [<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>]
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs99', 294)" onmouseover="showTip(event, 'fs99', 294)" class="i">frenchCode</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 295)" onmouseover="showTip(event, 'fs7', 295)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 296)" onmouseover="showTip(event, 'fs7', 296)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 297)" onmouseover="showTip(event, 'fs7', 297)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 298)" onmouseover="showTip(event, 'fs5', 298)" class="i">Leaf</span>(<span class="s">'s'</span>,<span class="n">121895.</span>),<span onmouseout="hideTip(event, 'fs7', 299)" onmouseover="showTip(event, 'fs7', 299)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 300)" onmouseover="showTip(event, 'fs5', 300)" class="i">Leaf</span>(<span class="s">'d'</span>,<span class="n">56269.</span>),<span onmouseout="hideTip(event, 'fs7', 301)" onmouseover="showTip(event, 'fs7', 301)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 302)" onmouseover="showTip(event, 'fs7', 302)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 303)" onmouseover="showTip(event, 'fs7', 303)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 304)" onmouseover="showTip(event, 'fs5', 304)" class="i">Leaf</span>(<span class="s">'x'</span>,<span class="n">5928.</span>),<span onmouseout="hideTip(event, 'fs5', 305)" onmouseover="showTip(event, 'fs5', 305)" class="i">Leaf</span>(<span class="s">'j'</span>,<span class="n">8351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>],<span class="n">14279.</span>),<span onmouseout="hideTip(event, 'fs5', 306)" onmouseover="showTip(event, 'fs5', 306)" class="i">Leaf</span>(<span class="s">'f'</span>,<span class="n">16351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>],<span class="n">30630.</span>),<span onmouseout="hideTip(event, 'fs7', 307)" onmouseover="showTip(event, 'fs7', 307)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 308)" onmouseover="showTip(event, 'fs7', 308)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 309)" onmouseover="showTip(event, 'fs5', 309)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 310)" onmouseover="showTip(event, 'fs7', 310)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 311)" onmouseover="showTip(event, 'fs5', 311)" class="i">Leaf</span>(<span class="s">'z'</span>,<span class="n">2093.</span>),<span onmouseout="hideTip(event, 'fs7', 312)" onmouseover="showTip(event, 'fs7', 312)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 313)" onmouseover="showTip(event, 'fs5', 313)" class="i">Leaf</span>(<span class="s">'k'</span>,<span class="n">745.</span>),<span onmouseout="hideTip(event, 'fs5', 314)" onmouseover="showTip(event, 'fs5', 314)" class="i">Leaf</span>(<span class="s">'w'</span>,<span class="n">1747.</span>),[<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">2492.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">4585.</span>),<span onmouseout="hideTip(event, 'fs5', 315)" onmouseover="showTip(event, 'fs5', 315)" class="i">Leaf</span>(<span class="s">'y'</span>,<span class="n">4725.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>],<span class="n">9310.</span>),<span onmouseout="hideTip(event, 'fs5', 316)" onmouseover="showTip(event, 'fs5', 316)" class="i">Leaf</span>(<span class="s">'h'</span>,<span class="n">11298.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>],<span class="n">20608.</span>),<span onmouseout="hideTip(event, 'fs5', 317)" onmouseover="showTip(event, 'fs5', 317)" class="i">Leaf</span>(<span class="s">'q'</span>,<span class="n">20889.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">41497.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">72127.</span>),[<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">128396.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">250291.</span>),<span onmouseout="hideTip(event, 'fs7', 318)" onmouseover="showTip(event, 'fs7', 318)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 319)" onmouseover="showTip(event, 'fs7', 319)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 320)" onmouseover="showTip(event, 'fs7', 320)" class="i">Leaf</span>(<span class="s">'o'</span>,<span class="n">82762.</span>),<span onmouseout="hideTip(event, 'fs5', 321)" onmouseover="showTip(event, 'fs5', 321)" class="i">Leaf</span>(<span class="s">'l'</span>,<span class="n">83668.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>],<span class="n">166430.</span>),<span onmouseout="hideTip(event, 'fs7', 322)" onmouseover="showTip(event, 'fs7', 322)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 323)" onmouseover="showTip(event, 'fs7', 323)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 324)" onmouseover="showTip(event, 'fs5', 324)" class="i">Leaf</span>(<span class="s">'m'</span>,<span class="n">45521.</span>),<span onmouseout="hideTip(event, 'fs5', 325)" onmouseover="showTip(event, 'fs5', 325)" class="i">Leaf</span>(<span class="s">'p'</span>,<span class="n">46335.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>],<span class="n">91856.</span>),<span onmouseout="hideTip(event, 'fs5', 326)" onmouseover="showTip(event, 'fs5', 326)" class="i">Leaf</span>(<span class="s">'u'</span>,<span class="n">96785.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">188641.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">355071.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">605362.</span>),<span onmouseout="hideTip(event, 'fs7', 327)" onmouseover="showTip(event, 'fs7', 327)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 328)" onmouseover="showTip(event, 'fs7', 328)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 329)" onmouseover="showTip(event, 'fs7', 329)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 330)" onmouseover="showTip(event, 'fs5', 330)" class="i">Leaf</span>(<span class="s">'r'</span>,<span class="n">100500.</span>),<span onmouseout="hideTip(event, 'fs7', 331)" onmouseover="showTip(event, 'fs7', 331)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 332)" onmouseover="showTip(event, 'fs5', 332)" class="i">Leaf</span>(<span class="s">'c'</span>,<span class="n">50003.</span>),<span onmouseout="hideTip(event, 'fs7', 333)" onmouseover="showTip(event, 'fs7', 333)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 334)" onmouseover="showTip(event, 'fs5', 334)" class="i">Leaf</span>(<span class="s">'v'</span>,<span class="n">24975.</span>),<span onmouseout="hideTip(event, 'fs7', 335)" onmouseover="showTip(event, 'fs7', 335)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 336)" onmouseover="showTip(event, 'fs5', 336)" class="i">Leaf</span>(<span class="s">'g'</span>,<span class="n">13288.</span>),<span onmouseout="hideTip(event, 'fs5', 337)" onmouseover="showTip(event, 'fs5', 337)" class="i">Leaf</span>(<span class="s">'b'</span>,<span class="n">13822.</span>),[<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">27110.</span>),[<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">52085.</span>),[<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">102088.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">202588.</span>),<span onmouseout="hideTip(event, 'fs7', 338)" onmouseover="showTip(event, 'fs7', 338)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 339)" onmouseover="showTip(event, 'fs5', 339)" class="i">Leaf</span>(<span class="s">'n'</span>,<span class="n">108812.</span>),<span onmouseout="hideTip(event, 'fs5', 340)" onmouseover="showTip(event, 'fs5', 340)" class="i">Leaf</span>(<span class="s">'t'</span>,<span class="n">111103.</span>),[<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">219915.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">422503.</span>),<span onmouseout="hideTip(event, 'fs7', 341)" onmouseover="showTip(event, 'fs7', 341)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 342)" onmouseover="showTip(event, 'fs5', 342)" class="i">Leaf</span>(<span class="s">'e'</span>,<span class="n">225947.</span>),<span onmouseout="hideTip(event, 'fs7', 343)" onmouseover="showTip(event, 'fs7', 343)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 344)" onmouseover="showTip(event, 'fs5', 344)" class="i">Leaf</span>(<span class="s">'i'</span>,<span class="n">115465.</span>),<span onmouseout="hideTip(event, 'fs5', 345)" onmouseover="showTip(event, 'fs5', 345)" class="i">Leaf</span>(<span class="s">'a'</span>,<span class="n">117110.</span>),[<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">232575.</span>),[<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">458522.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">881025.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>;<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">1486387.</span>)</pre>


<p>Now a legitimate question is to know what is this secret. Is it cool ?</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 346)" onmouseover="showTip(event, 'fs100', 346)" class="i">r</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 347)" onmouseover="showTip(event, 'fs71', 347)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs99', 348)" onmouseover="showTip(event, 'fs99', 348)" class="i">frenchCode</span> <span onmouseout="hideTip(event, 'fs98', 349)" onmouseover="showTip(event, 'fs98', 349)" class="i">secret</span></pre>


<p>And once more for the fun</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 350)" onmouseover="showTip(event, 'fs101', 350)" class="i">r'</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 351)" onmouseover="showTip(event, 'fs71', 351)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs99', 352)" onmouseover="showTip(event, 'fs99', 352)" class="i">frenchCode</span> (<span onmouseout="hideTip(event, 'fs93', 353)" onmouseover="showTip(event, 'fs93', 353)" class="i">encode</span> (<span onmouseout="hideTip(event, 'fs81', 354)" onmouseover="showTip(event, 'fs81', 354)" class="i">makeEncoderDic</span> <span onmouseout="hideTip(event, 'fs99', 355)" onmouseover="showTip(event, 'fs99', 355)" class="i">frenchCode</span>) <span onmouseout="hideTip(event, 'fs100', 356)" onmouseover="showTip(event, 'fs100', 356)" class="i">r</span>)</pre>


<h3>Shannon coding</h3>

<p>Now that we have seen how to compress transform a string based on the frequency of some vocabulary, we can ask ourselve how much we can compress.
If our dictionary is composed of the set {0,1}, where 0 is very likely, can we compress it using the former scheme ?
Shannon says yes. But in order to compress each character, of size 1 bit, we'd need to use at least 1 bit as well.</p>

<p>But by considering a new vocabulary, which is made of sequence of 2 characters of the initial vocabulary, we can compose twice the individual word frequency imbalance into a
even stronger imbalance where each word in the new vocabulary is made of 2 word from the initial one.</p>

<p>Then we can apply our Huffman encoding.
It can be interesting to see how the compression evolves as we lengthen the sequence of character.</p>

<p>Let's do this</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs102', 357)" onmouseover="showTip(event, 'fs102', 357)" class="i">BlockCoding</span> <span class="o">=</span>
   

   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs103', 358)" onmouseover="showTip(event, 'fs103', 358)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs104', 359)" onmouseover="showTip(event, 'fs104', 359)" class="i">p</span> <span class="o">=</span> 
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs105', 360)" onmouseover="showTip(event, 'fs105', 360)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 361)" onmouseover="showTip(event, 'fs1', 361)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs106', 362)" onmouseover="showTip(event, 'fs106', 362)" class="i">Random</span>()
      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs107', 363)" onmouseover="showTip(event, 'fs107', 363)" class="i">loop</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs108', 364)" onmouseover="showTip(event, 'fs108', 364)" class="i">seq</span> { <span class="k">if</span> <span onmouseout="hideTip(event, 'fs105', 365)" onmouseover="showTip(event, 'fs105', 365)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs109', 366)" onmouseover="showTip(event, 'fs109', 366)" class="i">NextDouble</span>() <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs104', 367)" onmouseover="showTip(event, 'fs104', 367)" class="i">p</span> <span class="k">then</span> <span class="k">yield</span> <span class="n">1</span> <span class="k">else</span> <span class="k">yield</span> <span class="n">0</span>;
                           <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs107', 368)" onmouseover="showTip(event, 'fs107', 368)" class="i">loop</span> }
      <span onmouseout="hideTip(event, 'fs107', 369)" onmouseover="showTip(event, 'fs107', 369)" class="i">loop</span>

   <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs110', 370)" onmouseover="showTip(event, 'fs110', 370)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs111', 371)" onmouseover="showTip(event, 'fs111', 371)" class="i">basen</span> <span onmouseout="hideTip(event, 'fs112', 372)" onmouseover="showTip(event, 'fs112', 372)" class="i">length</span> <span class="o">=</span> <span class="k">match</span> <span onmouseout="hideTip(event, 'fs112', 373)" onmouseover="showTip(event, 'fs112', 373)" class="i">length</span> <span class="k">with</span> 
                                    | <span class="n">0</span> <span class="k">-&gt;</span> [[]] 
                                    | <span onmouseout="hideTip(event, 'fs113', 374)" onmouseover="showTip(event, 'fs113', 374)" class="i">n</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs114', 375)" onmouseover="showTip(event, 'fs114', 375)" class="i">enext</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs110', 376)" onmouseover="showTip(event, 'fs110', 376)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs111', 377)" onmouseover="showTip(event, 'fs111', 377)" class="i">basen</span> (<span onmouseout="hideTip(event, 'fs112', 378)" onmouseover="showTip(event, 'fs112', 378)" class="i">length</span><span class="o">-</span><span class="n">1</span>) 
                                           [ <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs111', 379)" onmouseover="showTip(event, 'fs111', 379)" class="i">basen</span><span class="o">-</span><span class="n">1</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 380)" onmouseover="showTip(event, 'fs35', 380)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 381)" onmouseover="showTip(event, 'fs68', 381)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs115', 382)" onmouseover="showTip(event, 'fs115', 382)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs114', 383)" onmouseover="showTip(event, 'fs114', 383)" class="i">enext</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 384)" onmouseover="showTip(event, 'fs35', 384)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 385)" onmouseover="showTip(event, 'fs68', 385)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs116', 386)" onmouseover="showTip(event, 'fs116', 386)" class="i">l</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs35', 387)" onmouseover="showTip(event, 'fs35', 387)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs117', 388)" onmouseover="showTip(event, 'fs117', 388)" class="i">Cons</span>(<span onmouseout="hideTip(event, 'fs115', 389)" onmouseover="showTip(event, 'fs115', 389)" class="i">x</span>,<span onmouseout="hideTip(event, 'fs116', 390)" onmouseover="showTip(event, 'fs116', 390)" class="i">l</span>))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 391)" onmouseover="showTip(event, 'fs35', 391)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 392)" onmouseover="showTip(event, 'fs97', 392)" class="i">concat</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs118', 393)" onmouseover="showTip(event, 'fs118', 393)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs110', 394)" onmouseover="showTip(event, 'fs110', 394)" class="i">enumerate</span> <span class="n">2</span> <span class="n">2</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 395)" onmouseover="showTip(event, 'fs119', 395)" class="i">lengthCode</span> <span class="o">=</span> <span class="n">3</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs120', 396)" onmouseover="showTip(event, 'fs120', 396)" class="i">p</span> <span class="o">=</span> <span class="n">0.1</span>
   
    <span class="c">// we will build a code for up to length * H(p) + a few, say 2.3 sqrt (N.p.(1-p))</span>
    <span class="c">// so we enumerate the sequences, and compute their log probabilities</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 397)" onmouseover="showTip(event, 'fs121', 397)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs104', 398)" onmouseover="showTip(event, 'fs104', 398)" class="i">p</span> <span onmouseout="hideTip(event, 'fs122', 399)" onmouseover="showTip(event, 'fs122', 399)" class="i">lengthCode</span> <span class="o">=</span> 
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs123', 400)" onmouseover="showTip(event, 'fs123', 400)" class="i">lp</span>, <span onmouseout="hideTip(event, 'fs124', 401)" onmouseover="showTip(event, 'fs124', 401)" class="i">nlp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 402)" onmouseover="showTip(event, 'fs21', 402)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 403)" onmouseover="showTip(event, 'fs22', 403)" class="i">Log</span> <span onmouseout="hideTip(event, 'fs104', 404)" onmouseover="showTip(event, 'fs104', 404)" class="i">p</span>, <span onmouseout="hideTip(event, 'fs21', 405)" onmouseover="showTip(event, 'fs21', 405)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 406)" onmouseover="showTip(event, 'fs22', 406)" class="i">Log</span>(<span class="n">1.</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs104', 407)" onmouseover="showTip(event, 'fs104', 407)" class="i">p</span>)
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs125', 408)" onmouseover="showTip(event, 'fs125', 408)" class="i">sequences</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs110', 409)" onmouseover="showTip(event, 'fs110', 409)" class="i">enumerate</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs122', 410)" onmouseover="showTip(event, 'fs122', 410)" class="i">lengthCode</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 411)" onmouseover="showTip(event, 'fs35', 411)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 412)" onmouseover="showTip(event, 'fs68', 412)" class="i">map</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs126', 413)" onmouseover="showTip(event, 'fs126', 413)" class="i">s</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs127', 414)" onmouseover="showTip(event, 'fs127', 414)" class="i">ones</span> <span class="o">=</span>  <span onmouseout="hideTip(event, 'fs126', 415)" onmouseover="showTip(event, 'fs126', 415)" class="i">s</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 416)" onmouseover="showTip(event, 'fs35', 416)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs128', 417)" onmouseover="showTip(event, 'fs128', 417)" class="i">sum</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 418)" onmouseover="showTip(event, 'fs6', 418)" class="i">float</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs126', 419)" onmouseover="showTip(event, 'fs126', 419)" class="i">s</span>, (<span onmouseout="hideTip(event, 'fs127', 420)" onmouseover="showTip(event, 'fs127', 420)" class="i">ones</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs123', 421)" onmouseover="showTip(event, 'fs123', 421)" class="i">lp</span> <span class="o">+</span> (<span onmouseout="hideTip(event, 'fs6', 422)" onmouseover="showTip(event, 'fs6', 422)" class="i">float</span> <span onmouseout="hideTip(event, 'fs122', 423)" onmouseover="showTip(event, 'fs122', 423)" class="i">lengthCode</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs127', 424)" onmouseover="showTip(event, 'fs127', 424)" class="i">ones</span>) <span class="o">*</span><span onmouseout="hideTip(event, 'fs124', 425)" onmouseover="showTip(event, 'fs124', 425)" class="i">nlp</span>))
      <span onmouseout="hideTip(event, 'fs129', 426)" onmouseover="showTip(event, 'fs129', 426)" class="i">printfn</span> <span class="s">"</span><span class="s">seqeunce</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs130', 427)" onmouseover="showTip(event, 'fs130', 427)" class="i">codeTree</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs131', 428)" onmouseover="showTip(event, 'fs131', 428)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 429)" onmouseover="showTip(event, 'fs70', 429)" class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs125', 430)" onmouseover="showTip(event, 'fs125', 430)" class="i">sequences</span>)
      <span onmouseout="hideTip(event, 'fs129', 431)" onmouseover="showTip(event, 'fs129', 431)" class="i">printfn</span> <span class="s">"</span><span class="s">codeTreeBuilt</span><span class="s">"</span>
      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs132', 432)" onmouseover="showTip(event, 'fs132', 432)" class="i">dic</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs131', 433)" onmouseover="showTip(event, 'fs131', 433)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 434)" onmouseover="showTip(event, 'fs81', 434)" class="i">makeEncoderDic</span> <span onmouseout="hideTip(event, 'fs130', 435)" onmouseover="showTip(event, 'fs130', 435)" class="i">codeTree</span>
      <span onmouseout="hideTip(event, 'fs129', 436)" onmouseover="showTip(event, 'fs129', 436)" class="i">printfn</span> <span class="s">"</span><span class="s">dicBuilt</span><span class="s">"</span>
      <span onmouseout="hideTip(event, 'fs131', 437)" onmouseover="showTip(event, 'fs131', 437)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs93', 438)" onmouseover="showTip(event, 'fs93', 438)" class="i">encode</span> <span onmouseout="hideTip(event, 'fs132', 439)" onmouseover="showTip(event, 'fs132', 439)" class="i">dic</span>, <span onmouseout="hideTip(event, 'fs131', 440)" onmouseover="showTip(event, 'fs131', 440)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 441)" onmouseover="showTip(event, 'fs71', 441)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs130', 442)" onmouseover="showTip(event, 'fs130', 442)" class="i">codeTree</span>
   
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 443)" onmouseover="showTip(event, 'fs133', 443)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs134', 444)" onmouseover="showTip(event, 'fs134', 444)" class="i">chunkSize</span> (<span onmouseout="hideTip(event, 'fs135', 445)" onmouseover="showTip(event, 'fs135', 445)" class="i">a</span> <span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs136', 446)" onmouseover="showTip(event, 'fs136', 446)" class="i">array</span>) <span class="o">=</span>
      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs137', 447)" onmouseover="showTip(event, 'fs137', 447)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs138', 448)" onmouseover="showTip(event, 'fs138', 448)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs108', 449)" onmouseover="showTip(event, 'fs108', 449)" class="i">seq</span> { <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs135', 450)" onmouseover="showTip(event, 'fs135', 450)" class="i">a</span><span class="o">.</span>[ (<span class="n">0</span><span class="o">+</span><span onmouseout="hideTip(event, 'fs138', 451)" onmouseover="showTip(event, 'fs138', 451)" class="i">i</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs134', 452)" onmouseover="showTip(event, 'fs134', 452)" class="i">chunkSize</span>)<span class="o">..</span>((<span onmouseout="hideTip(event, 'fs138', 453)" onmouseover="showTip(event, 'fs138', 453)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span><span onmouseout="hideTip(event, 'fs134', 454)" onmouseover="showTip(event, 'fs134', 454)" class="i">chunkSize</span><span class="o">-</span><span class="n">1</span>)];  <span class="k">if</span> ((<span onmouseout="hideTip(event, 'fs138', 455)" onmouseover="showTip(event, 'fs138', 455)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span> <span onmouseout="hideTip(event, 'fs134', 456)" onmouseover="showTip(event, 'fs134', 456)" class="i">chunkSize</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs135', 457)" onmouseover="showTip(event, 'fs135', 457)" class="i">a</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 458)" onmouseover="showTip(event, 'fs139', 458)" class="i">Length</span>) <span class="k">then</span> <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs137', 459)" onmouseover="showTip(event, 'fs137', 459)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs138', 460)" onmouseover="showTip(event, 'fs138', 460)" class="i">i</span><span class="o">+</span><span class="n">1</span>)} 
      <span onmouseout="hideTip(event, 'fs137', 461)" onmouseover="showTip(event, 'fs137', 461)" class="i">loop</span> <span class="n">0</span> 

   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs140', 462)" onmouseover="showTip(event, 'fs140', 462)" class="i">blockSize</span> <span class="o">=</span> [<span class="n">15</span>]<span class="c">//][3;5;7;9;11;13;15]</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs141', 463)" onmouseover="showTip(event, 'fs141', 463)" class="i">sizes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs140', 464)" onmouseover="showTip(event, 'fs140', 464)" class="i">blockSize</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 465)" onmouseover="showTip(event, 'fs35', 465)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 466)" onmouseover="showTip(event, 'fs68', 466)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs142', 467)" onmouseover="showTip(event, 'fs142', 467)" class="i">l</span> <span class="k">-&gt;</span>  <span class="k">try</span>
                                                   <span onmouseout="hideTip(event, 'fs129', 468)" onmouseover="showTip(event, 'fs129', 468)" class="i">printfn</span> <span class="s">"</span><span class="s">starting</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs143', 469)" onmouseover="showTip(event, 'fs143', 469)" class="i">encoder</span>, <span onmouseout="hideTip(event, 'fs144', 470)" onmouseover="showTip(event, 'fs144', 470)" class="i">decoder</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs121', 471)" onmouseover="showTip(event, 'fs121', 471)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs120', 472)" onmouseover="showTip(event, 'fs120', 472)" class="i">p</span> <span onmouseout="hideTip(event, 'fs142', 473)" onmouseover="showTip(event, 'fs142', 473)" class="i">l</span>
                                                   <span onmouseout="hideTip(event, 'fs129', 474)" onmouseover="showTip(event, 'fs129', 474)" class="i">printfn</span> <span class="s">"</span><span class="s">Encoder</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs145', 475)" onmouseover="showTip(event, 'fs145', 475)" class="i">message</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs103', 476)" onmouseover="showTip(event, 'fs103', 476)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs120', 477)" onmouseover="showTip(event, 'fs120', 477)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs146', 478)" onmouseover="showTip(event, 'fs146', 478)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs147', 479)" onmouseover="showTip(event, 'fs147', 479)" class="i">take</span>(<span onmouseout="hideTip(event, 'fs142', 480)" onmouseover="showTip(event, 'fs142', 480)" class="i">l</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 481)" onmouseover="showTip(event, 'fs74', 481)" class="i">int</span>(<span onmouseout="hideTip(event, 'fs21', 482)" onmouseover="showTip(event, 'fs21', 482)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs148', 483)" onmouseover="showTip(event, 'fs148', 483)" class="i">Floor</span>(<span class="n">12330.</span><span class="o">/</span>(<span onmouseout="hideTip(event, 'fs6', 484)" onmouseover="showTip(event, 'fs6', 484)" class="i">float</span> <span onmouseout="hideTip(event, 'fs142', 485)" onmouseover="showTip(event, 'fs142', 485)" class="i">l</span>))))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs146', 486)" onmouseover="showTip(event, 'fs146', 486)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs149', 487)" onmouseover="showTip(event, 'fs149', 487)" class="i">toArray</span>                                 
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs150', 488)" onmouseover="showTip(event, 'fs150', 488)" class="i">sizeOriginal</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs145', 489)" onmouseover="showTip(event, 'fs145', 489)" class="i">message</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 490)" onmouseover="showTip(event, 'fs139', 490)" class="i">Length</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs151', 491)" onmouseover="showTip(event, 'fs151', 491)" class="i">a</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs133', 492)" onmouseover="showTip(event, 'fs133', 492)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs142', 493)" onmouseover="showTip(event, 'fs142', 493)" class="i">l</span> <span onmouseout="hideTip(event, 'fs145', 494)" onmouseover="showTip(event, 'fs145', 494)" class="i">message</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs146', 495)" onmouseover="showTip(event, 'fs146', 495)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 496)" onmouseover="showTip(event, 'fs152', 496)" class="i">map</span> <span onmouseout="hideTip(event, 'fs146', 497)" onmouseover="showTip(event, 'fs146', 497)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 498)" onmouseover="showTip(event, 'fs153', 498)" class="i">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs146', 499)" onmouseover="showTip(event, 'fs146', 499)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 500)" onmouseover="showTip(event, 'fs153', 500)" class="i">toList</span>)
                                                   <span onmouseout="hideTip(event, 'fs129', 501)" onmouseover="showTip(event, 'fs129', 501)" class="i">printfn</span> <span class="s">"</span><span class="s">chunked</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs154', 502)" onmouseover="showTip(event, 'fs154', 502)" class="i">compressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs143', 503)" onmouseover="showTip(event, 'fs143', 503)" class="i">encoder</span> <span onmouseout="hideTip(event, 'fs151', 504)" onmouseover="showTip(event, 'fs151', 504)" class="i">a</span> 
                                                   <span onmouseout="hideTip(event, 'fs129', 505)" onmouseover="showTip(event, 'fs129', 505)" class="i">printfn</span> <span class="s">"</span><span class="s">compressed</span><span class="s">"</span>
                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs155', 506)" onmouseover="showTip(event, 'fs155', 506)" class="i">sizeCompressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs154', 507)" onmouseover="showTip(event, 'fs154', 507)" class="i">compressed</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 508)" onmouseover="showTip(event, 'fs47', 508)" class="i">Length</span>
                                                   <span onmouseout="hideTip(event, 'fs155', 509)" onmouseover="showTip(event, 'fs155', 509)" class="i">sizeCompressed</span> 
                                                <span class="k">with</span> | <span class="o">:?</span> <span onmouseout="hideTip(event, 'fs1', 510)" onmouseover="showTip(event, 'fs1', 510)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 511)" onmouseover="showTip(event, 'fs2', 511)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 512)" onmouseover="showTip(event, 'fs3', 512)" class="i">Generic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs156', 513)" onmouseover="showTip(event, 'fs156', 513)" class="i">KeyNotFoundException</span> <span class="k">as</span> <span onmouseout="hideTip(event, 'fs157', 514)" onmouseover="showTip(event, 'fs157', 514)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs129', 515)" onmouseover="showTip(event, 'fs129', 515)" class="i">printfn</span> <span class="s">"</span><span class="s">key</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">"</span> (<span onmouseout="hideTip(event, 'fs157', 516)" onmouseover="showTip(event, 'fs157', 516)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs158', 517)" onmouseover="showTip(event, 'fs158', 517)" class="i">ToString</span>()); <span onmouseout="hideTip(event, 'fs60', 518)" onmouseover="showTip(event, 'fs60', 518)" class="i">failwith</span> <span class="s">"</span><span class="s">toto</span><span class="s">"</span>
                                                   )</pre>


<p>Note that the Shannon compressibility is just a way to expand that witnessed imbalance and change the length of the transmitted characters.
It does <strong>not</strong> tell you <strong>where</strong> to find that imbalance.
If you have a series of 999 0 followed by a series of 999 1, and you look at the distribution of the population made of the individual items, 
you find that it is impossible to compress it. and it is if you look at each bit that way.</p>

<p>If you look at the population made of the length of the repeated pattern, and you find that it is always 998, you can compress that information into 0 bits.
To transmit the message, you could transmit the first bit, followed by 0 bit.</p>

<p>Note furthermore, that Shannon encoding requires the recipient to know the CodeTree, because he knows the distribution for instance.
In case one exploit the found structure, then the recipient should know the CodeTree for the variable (in our case "length of the repetition"), 
the layout of the transmission (the initial value code, followed by the code identifying the length (this is 0 bit)) and, 
from the decoded sequence of variables (in our case, X = the said bit, repetition = 998), how to reconstruct the expanded sequence.</p>

<p>This is a lot of information to transmit, and a tradeoff exists between introducing a variable, which entails to transmit the
codetree, and the reduction this will.</p>

          <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Collections</div>
<div class="tip" id="fs3">namespace System.Collections.Generic</div>
<div class="tip" id="fs4">type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Shannon.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs5">union case CodeTree.Leaf: 'T * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs6">Multiple items<br>val float : value:'T -&gt; float (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.float<br><br>--------------------<br>type float&lt;'Measure&gt; = float<br><br>Full name: Microsoft.FSharp.Core.float&lt;_&gt;<br><br>--------------------<br>type float = Double<br><br>Full name: Microsoft.FSharp.Core.float</div>
<div class="tip" id="fs7">union case CodeTree.Fork: CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs8">type 'T list = List&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
<div class="tip" id="fs9">val chars : _arg1:CodeTree&lt;'a&gt; -&gt; 'a list<br><br>Full name: Shannon.CodeTree.chars</div>
<div class="tip" id="fs10">val c : 'a</div>
<div class="tip" id="fs11">val l : 'a list</div>
<div class="tip" id="fs12">val weight : _arg1:CodeTree&lt;'a&gt; -&gt; float<br><br>Full name: Shannon.CodeTree.weight</div>
<div class="tip" id="fs13">val w : float</div>
<div class="tip" id="fs14">val merge : addweight:(float -&gt; float -&gt; float) -&gt; ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.merge</div>
<div class="tip" id="fs15">val addweight : (float -&gt; float -&gt; float)</div>
<div class="tip" id="fs16">val ct1 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs17">val ct2 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs18">val private logsumexp : logx:float -&gt; logy:float -&gt; float<br><br>Full name: Shannon.CodeTree.logsumexp</div>
<div class="tip" id="fs19">val logx : float</div>
<div class="tip" id="fs20">val logy : float</div>
<div class="tip" id="fs21">type Math =<br>&nbsp;&nbsp;static val E : float<br>&nbsp;&nbsp;static val PI : float<br>&nbsp;&nbsp;static member Abs : value:decimal -&gt; decimal + 6 overloads<br>&nbsp;&nbsp;static member Acos : d:float -&gt; float<br>&nbsp;&nbsp;static member Asin : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan2 : y:float * x:float -&gt; float<br>&nbsp;&nbsp;static member BigMul : a:int * b:int -&gt; int64<br>&nbsp;&nbsp;static member Ceiling : d:decimal -&gt; decimal + 1 overload<br>&nbsp;&nbsp;static member Cos : d:float -&gt; float<br>&nbsp;&nbsp;...<br><br>Full name: System.Math</div>
<div class="tip" id="fs22">Math.Log(d: float) : float<br>Math.Log(a: float, newBase: float) : float</div>
<div class="tip" id="fs23">Math.Exp(d: float) : float</div>
<div class="tip" id="fs24">val mergePlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.mergePlus</div>
<div class="tip" id="fs25">val mergeLogPlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.mergeLogPlus</div>
<div class="tip" id="fs26">val fold : fNode:('a -&gt; 'a -&gt; 'a) -&gt; fLeaf:('T -&gt; 'a) -&gt; x:CodeTree&lt;'T&gt; -&gt; 'a<br><br>Full name: Shannon.CodeTree.fold</div>
<div class="tip" id="fs27">val fNode : ('a -&gt; 'a -&gt; 'a)</div>
<div class="tip" id="fs28">val fLeaf : ('T -&gt; 'a)</div>
<div class="tip" id="fs29">val x : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs30">val f : (CodeTree&lt;'T&gt; -&gt; 'a)</div>
<div class="tip" id="fs31">val e : 'T</div>
<div class="tip" id="fs32">val l : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs33">val r : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs34">val cs : 'T list</div>
<div class="tip" id="fs35">Multiple items<br>type List&lt;'T&gt; =<br>&nbsp;&nbsp;new : unit -&gt; List&lt;'T&gt; + 2 overloads<br>&nbsp;&nbsp;member Add : item:'T -&gt; unit<br>&nbsp;&nbsp;member AddRange : collection:IEnumerable&lt;'T&gt; -&gt; unit<br>&nbsp;&nbsp;member AsReadOnly : unit -&gt; ReadOnlyCollection&lt;'T&gt;<br>&nbsp;&nbsp;member BinarySearch : item:'T -&gt; int + 2 overloads<br>&nbsp;&nbsp;member Capacity : int with get, set<br>&nbsp;&nbsp;member Clear : unit -&gt; unit<br>&nbsp;&nbsp;member Contains : item:'T -&gt; bool<br>&nbsp;&nbsp;member ConvertAll&lt;'TOutput&gt; : converter:Converter&lt;'T, 'TOutput&gt; -&gt; List&lt;'TOutput&gt;<br>&nbsp;&nbsp;member CopyTo : array:'T[] -&gt; unit + 2 overloads<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;nested type Enumerator<br><br>Full name: System.Collections.Generic.List&lt;_&gt;<br><br>--------------------<br>List() : unit<br>List(collection: IEnumerable&lt;'T&gt;) : unit<br>List(capacity: int) : unit</div>
<div class="tip" id="fs36">val span : f:('a -&gt; bool) -&gt; xs:'a list -&gt; 'a list * 'a list<br><br>Full name: Shannon.List.span</div>
<div class="tip" id="fs37">val f : ('a -&gt; bool)</div>
<div class="tip" id="fs38">val xs : 'a list</div>
<div class="tip" id="fs39">val r : 'a list</div>
<div class="tip" id="fs40">val fold : folder:('State -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; list:'T list -&gt; 'State<br><br>Full name: Microsoft.FSharp.Collections.List.fold</div>
<div class="tip" id="fs41">val e : 'a</div>
<div class="tip" id="fs42">property List.Tail: 'a list</div>
<div class="tip" id="fs43">val rev : list:'T list -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.rev</div>
<div class="tip" id="fs44">Multiple items<br>module CodeTree<br><br>from Shannon<br><br>--------------------<br>type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Shannon.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs45">val buildFreq : sample:'T list -&gt; ('T * float) list (requires comparison)<br><br>Full name: Shannon.Huffman.buildFreq</div>
<div class="tip" id="fs46">val sample : 'T list (requires comparison)</div>
<div class="tip" id="fs47">property List.Length: int</div>
<div class="tip" id="fs48">val sort : list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sort</div>
<div class="tip" id="fs49">val count : ('a list -&gt; ('a * float) list) (requires equality)</div>
<div class="tip" id="fs50">val sample : 'a list (requires equality)</div>
<div class="tip" id="fs51">val left : 'a list (requires equality)</div>
<div class="tip" id="fs52">val right : 'a list (requires equality)</div>
<div class="tip" id="fs53">property List.Head: 'a</div>
<div class="tip" id="fs54">val sortBy : projection:('T -&gt; 'Key) -&gt; list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sortBy</div>
<div class="tip" id="fs55">val snd : tuple:('T1 * 'T2) -&gt; 'T2<br><br>Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs56">val private buildCodeFromFreqInner : merge:(CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;) -&gt; distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromFreqInner</div>
<div class="tip" id="fs57">val merge : (CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs58">val distrib : ('T * float) list</div>
<div class="tip" id="fs59">val loop : (CodeTree&lt;'T&gt; list -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs60">val failwith : message:string -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs61">val f : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs62">val s : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs63">val xs : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs64">val newCT : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs65">val left : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs66">val right : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs67">val e : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs68">val map : mapping:('T -&gt; 'U) -&gt; list:'T list -&gt; 'U list<br><br>Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs69">val buildCodeFromFreq : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromFreq</div>
<div class="tip" id="fs70">val buildCodeFromLogProb : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromLogProb</div>
<div class="tip" id="fs71">val decode : codeTree:CodeTree&lt;'a&gt; -&gt; bits:int list -&gt; 'a list<br><br>Full name: Shannon.Huffman.decode</div>
<div class="tip" id="fs72">val codeTree : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs73">val bits : int list</div>
<div class="tip" id="fs74">Multiple items<br>val int : value:'T -&gt; int (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.int<br><br>--------------------<br>type int&lt;'Measure&gt; = int<br><br>Full name: Microsoft.FSharp.Core.int&lt;_&gt;<br><br>--------------------<br>type int = int32<br><br>Full name: Microsoft.FSharp.Core.int</div>
<div class="tip" id="fs75">val o : CodeTree&lt;'a&gt; * 'a list</div>
<div class="tip" id="fs76">val l : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs77">val r : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs78">val decMsg : 'a list</div>
<div class="tip" id="fs79">val b : int</div>
<div class="tip" id="fs80">val current : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs81">val makeEncoderDic : tree:CodeTree&lt;'T&gt; -&gt; Map&lt;'T,int list&gt; (requires comparison)<br><br>Full name: Shannon.Huffman.makeEncoderDic</div>
<div class="tip" id="fs82">val tree : CodeTree&lt;'T&gt; (requires comparison)</div>
<div class="tip" id="fs83">val lMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs84">val rMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs85">Multiple items<br>module Map<br><br>from Microsoft.FSharp.Collections<br><br>--------------------<br>type Map&lt;'Key,'Value (requires comparison)&gt; =<br>&nbsp;&nbsp;interface IEnumerable<br>&nbsp;&nbsp;interface IComparable<br>&nbsp;&nbsp;interface IEnumerable&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface ICollection&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface IDictionary&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member ContainsKey : key:'Key -&gt; bool<br>&nbsp;&nbsp;override Equals : obj -&gt; bool<br>&nbsp;&nbsp;member Remove : key:'Key -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;...<br><br>Full name: Microsoft.FSharp.Collections.Map&lt;_,_&gt;<br><br>--------------------<br>new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs86">val fold : folder:('State -&gt; 'Key -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; table:Map&lt;'Key,'T&gt; -&gt; 'State (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.fold</div>
<div class="tip" id="fs87">val m : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs88">val k : 'T (requires comparison)</div>
<div class="tip" id="fs89">val v : int list</div>
<div class="tip" id="fs90">member Map.Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs91">val empty&lt;'Key,'T (requires comparison)&gt; : Map&lt;'Key,'T&gt; (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.empty</div>
<div class="tip" id="fs92">val c : 'T (requires comparison)</div>
<div class="tip" id="fs93">val encode : dic:Map&lt;'T,int list&gt; -&gt; ('T list -&gt; int list) (requires comparison)<br><br>Full name: Shannon.Huffman.encode</div>
<div class="tip" id="fs94">val dic : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs95">val x : 'T (requires comparison)</div>
<div class="tip" id="fs96">property Map.Item: 'T -&gt; int list</div>
<div class="tip" id="fs97">val concat : lists:seq&lt;'T list&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.concat</div>
<div class="tip" id="fs98">val secret : int list<br><br>Full name: Shannon.Huffman.secret</div>
<div class="tip" id="fs99">val frenchCode : CodeTree&lt;char&gt;<br><br>Full name: Shannon.Huffman.frenchCode</div>
<div class="tip" id="fs100">val r : char list<br><br>Full name: Shannon.Huffman.r</div>
<div class="tip" id="fs101">val r' : char list<br><br>Full name: Shannon.Huffman.r'</div>
<div class="tip" id="fs102">module BlockCoding<br><br>from Shannon</div>
<div class="tip" id="fs103">val stream : p:float -&gt; seq&lt;int&gt;<br><br>Full name: Shannon.BlockCoding.stream</div>
<div class="tip" id="fs104">val p : float</div>
<div class="tip" id="fs105">val rnd : Random</div>
<div class="tip" id="fs106">Multiple items<br>type Random =<br>&nbsp;&nbsp;new : unit -&gt; Random + 1 overload<br>&nbsp;&nbsp;member Next : unit -&gt; int + 2 overloads<br>&nbsp;&nbsp;member NextBytes : buffer:byte[] -&gt; unit<br>&nbsp;&nbsp;member NextDouble : unit -&gt; float<br><br>Full name: System.Random<br><br>--------------------<br>Random() : unit<br>Random(Seed: int) : unit</div>
<div class="tip" id="fs107">val loop : seq&lt;int&gt;</div>
<div class="tip" id="fs108">Multiple items<br>val seq : sequence:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Core.Operators.seq<br><br>--------------------<br>type seq&lt;'T&gt; = IEnumerable&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs109">Random.NextDouble() : float</div>
<div class="tip" id="fs110">val enumerate : basen:int -&gt; length:int -&gt; int list list<br><br>Full name: Shannon.BlockCoding.enumerate</div>
<div class="tip" id="fs111">val basen : int</div>
<div class="tip" id="fs112">val length : int</div>
<div class="tip" id="fs113">val n : int</div>
<div class="tip" id="fs114">val enext : int list list</div>
<div class="tip" id="fs115">val x : int</div>
<div class="tip" id="fs116">val l : int list</div>
<div class="tip" id="fs117">static member List.Cons : head:'T * tail:'T list -&gt; 'T list</div>
<div class="tip" id="fs118">val r : int list list<br><br>Full name: Shannon.BlockCoding.r</div>
<div class="tip" id="fs119">val lengthCode : int<br><br>Full name: Shannon.BlockCoding.lengthCode</div>
<div class="tip" id="fs120">val p : float<br><br>Full name: Shannon.BlockCoding.p</div>
<div class="tip" id="fs121">val generateEncoderDecoder : p:float -&gt; lengthCode:int -&gt; (int list list -&gt; int list) * (int list -&gt; int list list)<br><br>Full name: Shannon.BlockCoding.generateEncoderDecoder</div>
<div class="tip" id="fs122">val lengthCode : int</div>
<div class="tip" id="fs123">val lp : float</div>
<div class="tip" id="fs124">val nlp : float</div>
<div class="tip" id="fs125">val sequences : (int list * float) list</div>
<div class="tip" id="fs126">val s : int list</div>
<div class="tip" id="fs127">val ones : float</div>
<div class="tip" id="fs128">val sum : list:'T list -&gt; 'T (requires member ( + ) and member get_Zero)<br><br>Full name: Microsoft.FSharp.Collections.List.sum</div>
<div class="tip" id="fs129">val printfn : format:Printf.TextWriterFormat&lt;'T&gt; -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs130">val codeTree : CodeTree&lt;int list&gt;</div>
<div class="tip" id="fs131">module Huffman<br><br>from Shannon</div>
<div class="tip" id="fs132">val dic : Map&lt;int list,int list&gt;</div>
<div class="tip" id="fs133">val chunkExact : chunkSize:int -&gt; a:'a array -&gt; seq&lt;'a []&gt;<br><br>Full name: Shannon.BlockCoding.chunkExact</div>
<div class="tip" id="fs134">val chunkSize : int</div>
<div class="tip" id="fs135">val a : 'a array</div>
<div class="tip" id="fs136">type 'T array = 'T []<br><br>Full name: Microsoft.FSharp.Core.array&lt;_&gt;</div>
<div class="tip" id="fs137">val loop : (int -&gt; seq&lt;'a []&gt;)</div>
<div class="tip" id="fs138">val i : int</div>
<div class="tip" id="fs139">property Array.Length: int</div>
<div class="tip" id="fs140">val blockSize : int list<br><br>Full name: Shannon.BlockCoding.blockSize</div>
<div class="tip" id="fs141">val sizes : int list<br><br>Full name: Shannon.BlockCoding.sizes</div>
<div class="tip" id="fs142">val l : int</div>
<div class="tip" id="fs143">val encoder : (int list list -&gt; int list)</div>
<div class="tip" id="fs144">val decoder : (int list -&gt; int list list)</div>
<div class="tip" id="fs145">val message : int []</div>
<div class="tip" id="fs146">module Seq<br><br>from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs147">val take : count:int -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.take</div>
<div class="tip" id="fs148">Math.Floor(d: decimal) : decimal<br>Math.Floor(d: float) : float</div>
<div class="tip" id="fs149">val toArray : source:seq&lt;'T&gt; -&gt; 'T []<br><br>Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs150">val sizeOriginal : int</div>
<div class="tip" id="fs151">val a : int list list</div>
<div class="tip" id="fs152">val map : mapping:('T -&gt; 'U) -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'U&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs153">val toList : source:seq&lt;'T&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs154">val compressed : int list</div>
<div class="tip" id="fs155">val sizeCompressed : int</div>
<div class="tip" id="fs156">Multiple items<br>type KeyNotFoundException =<br>&nbsp;&nbsp;inherit SystemException<br>&nbsp;&nbsp;new : unit -&gt; KeyNotFoundException + 2 overloads<br><br>Full name: System.Collections.Generic.KeyNotFoundException<br><br>--------------------<br>KeyNotFoundException() : unit<br>KeyNotFoundException(message: string) : unit<br>KeyNotFoundException(message: string, innerException: exn) : unit</div>
<div class="tip" id="fs157">val e : KeyNotFoundException</div>
<div class="tip" id="fs158">Exception.ToString() : string</div>

</div></body></html>

    </article>
  </div>

    </div>
    </div>
  </body>
</html>

