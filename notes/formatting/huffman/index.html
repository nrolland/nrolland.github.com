<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> xQuant  Huffman coding       </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="These are various notes of computer science subjects. They sometime have accompanying F# implementation They are authored in a litterate programming style and each document is a valid.">
    <meta name="author" content="Nicolas Rolland">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="alternate" type="application/rss+xml" title="xQuant.net Atom feed" href="http://xquant.net/blog/feed.xml" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/stylesheet/tooltips.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/style.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/jsxgraph.css" />

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=css&lang=ml&lang=scala&lang=hs"></script>
    <script src="/javascript/tips.js" type="text/javascript"></script>
    <script src="/javascript/jsxgraphcore.js" type="text/javascript"></script>
    <script>
        JXG.Options.text.useMathJax = true;
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [['$','$'], ['\\(','\\)']],
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
          }
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i = 0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });
      </script>
     <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39755928-1', 'xquant.net');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-45978109-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
  <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
        <a class="brand" href="#">Huffman coding  </a>
          <hr>
        <ul class="nav">
          <li><a href="/">Home</a></li>
          <li><a href="/notes">Notes</a></li>
           <li><a href="/about">About</a></li>
           <li class="divider"></li>
        </ul>
      </div>
      </div>
      <hr>
    <div class="centered">
      
  <div class='post'>
    <article>
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="span9" id="main">
          <h1>Huffman coding</h1>

<h5>(a preamble to Shannon theorem)</h5>

<p>To illustrate the Shannon theorem, we'll need to start with the entropic, or Huffman, coding.
This was recently submitted as part of Martin Odersky's excellent course on functional programming 
using scala and is a beautiful illustration of principled recursion.</p>

<h3>Huffman coding</h3>

<p>Let's magine we want to transmit a <strong>string</strong>, which is sequence of <strong>characters</strong>, or <strong>codewords</strong> coming 
from a <strong>vocabulary</strong> of size <strong>exp N</strong>.
As a trivial step toward a minimal encoding of our message, we can replace each word with a series of N bits.</p>

<p>Let's further make the assumption that we <em>know how relatively frequent</em> each character is.
Considering this, we'd want to remap our vocabulary to a <em>new</em> one, where the most <strong>frequent</strong> words are mapped to <strong>small</strong> representations.
(By the <a href="https://en.wikipedia.org/wiki/Kraft's_inequality">Kraft inequality</a>, it implies that some other words, 
hopefully less frequent, have to be longer than N)</p>

<p>Let's look at how we'd do such a coding with in F#.</p>

<h4>CodeTree structure</h4>

<p>Our main structure will be a binary tree, which holds the list of characters it optimally represents.
Such a tree, whose Leaves contains the items of our dictionary, makes the correspondance between a sequence of 1 and 0 
leading to the leafs, and the characters of our dictionary.</p>

<pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Generic</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 4)" onmouseover="showTip(event, 'fs1', 4)" class="i">System</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">Leaf</span> <span class="k">of</span> <span class="o">'</span><span class="i">T</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">float</span> 
    | <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">Fork</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">list</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">float</span></pre>


<p>In the revered tradition of recursion, we'll want to do a series of steps to growing small trees, optimal for small
vocabularies, to a bigger one, optimal on the combined vocabulary.
A few helper methods are needed for that.</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs4', 13)" onmouseover="showTip(event, 'fs4', 13)" class="i">CodeTree</span> <span class="o">=</span> 
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 14)" onmouseover="showTip(event, 'fs9', 14)" class="i">chars</span>  <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="i">c</span>,_) <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">c</span>] | <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="i">Fork</span>(_,_,<span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">l</span>,_) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">l</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 21)" onmouseover="showTip(event, 'fs12', 21)" class="i">weight</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 22)" onmouseover="showTip(event, 'fs5', 22)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 23)" onmouseover="showTip(event, 'fs10', 23)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">w</span>) <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs13', 25)" onmouseover="showTip(event, 'fs13', 25)" class="i">w</span>  | <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">Fork</span>(_,_,_,<span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 28)" onmouseover="showTip(event, 'fs13', 28)" class="i">w</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 29)" onmouseover="showTip(event, 'fs14', 29)" class="i">merge</span> <span onmouseout="hideTip(event, 'fs15', 30)" onmouseover="showTip(event, 'fs15', 30)" class="i">addweight</span> <span onmouseout="hideTip(event, 'fs16', 31)" onmouseover="showTip(event, 'fs16', 31)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 32)" onmouseover="showTip(event, 'fs17', 32)" class="i">ct2</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs7', 33)" onmouseover="showTip(event, 'fs7', 33)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs16', 34)" onmouseover="showTip(event, 'fs16', 34)" class="i">ct1</span>, <span onmouseout="hideTip(event, 'fs17', 35)" onmouseover="showTip(event, 'fs17', 35)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs9', 36)" onmouseover="showTip(event, 'fs9', 36)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs16', 37)" onmouseover="showTip(event, 'fs16', 37)" class="i">ct1</span> <span class="o">@</span> <span onmouseout="hideTip(event, 'fs9', 38)" onmouseover="showTip(event, 'fs9', 38)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs17', 39)" onmouseover="showTip(event, 'fs17', 39)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs15', 40)" onmouseover="showTip(event, 'fs15', 40)" class="i">addweight</span>(<span onmouseout="hideTip(event, 'fs12', 41)" onmouseover="showTip(event, 'fs12', 41)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs16', 42)" onmouseover="showTip(event, 'fs16', 42)" class="i">ct1</span>)(<span onmouseout="hideTip(event, 'fs12', 43)" onmouseover="showTip(event, 'fs12', 43)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs17', 44)" onmouseover="showTip(event, 'fs17', 44)" class="i">ct2</span>))</pre>


<p>If our weights are just straight frequencies, we'll add them. But sometimes using logprob is required, so we abstract the way to "add" such quantities</p>

<pre class="fssnip">
   <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs18', 45)" onmouseover="showTip(event, 'fs18', 45)" class="i">logsumexp</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="i">logx</span> <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="i">logy</span> <span class="o">=</span> 
      <span class="k">if</span> <span onmouseout="hideTip(event, 'fs19', 48)" onmouseover="showTip(event, 'fs19', 48)" class="i">logx</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs20', 49)" onmouseover="showTip(event, 'fs20', 49)" class="i">logy</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs19', 50)" onmouseover="showTip(event, 'fs19', 50)" class="i">logx</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 51)" onmouseover="showTip(event, 'fs21', 51)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 52)" onmouseover="showTip(event, 'fs22', 52)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 53)" onmouseover="showTip(event, 'fs21', 53)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 54)" onmouseover="showTip(event, 'fs23', 54)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="i">logy</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs19', 56)" onmouseover="showTip(event, 'fs19', 56)" class="i">logx</span>))
                     <span class="k">else</span> <span onmouseout="hideTip(event, 'fs20', 57)" onmouseover="showTip(event, 'fs20', 57)" class="i">logy</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 58)" onmouseover="showTip(event, 'fs21', 58)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 59)" onmouseover="showTip(event, 'fs22', 59)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 60)" onmouseover="showTip(event, 'fs21', 60)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs19', 62)" onmouseover="showTip(event, 'fs19', 62)" class="i">logx</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs20', 63)" onmouseover="showTip(event, 'fs20', 63)" class="i">logy</span>))

   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 64)" onmouseover="showTip(event, 'fs24', 64)" class="i">mergePlus</span> <span onmouseout="hideTip(event, 'fs16', 65)" onmouseover="showTip(event, 'fs16', 65)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 66)" onmouseover="showTip(event, 'fs17', 66)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 67)" onmouseover="showTip(event, 'fs14', 67)" class="i">merge</span> (<span class="o">+</span>) <span onmouseout="hideTip(event, 'fs16', 68)" onmouseover="showTip(event, 'fs16', 68)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 69)" onmouseover="showTip(event, 'fs17', 69)" class="i">ct2</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 70)" onmouseover="showTip(event, 'fs25', 70)" class="i">mergeLogPlus</span> <span onmouseout="hideTip(event, 'fs16', 71)" onmouseover="showTip(event, 'fs16', 71)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 72)" onmouseover="showTip(event, 'fs17', 72)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 73)" onmouseover="showTip(event, 'fs14', 73)" class="i">merge</span> (<span onmouseout="hideTip(event, 'fs18', 74)" onmouseover="showTip(event, 'fs18', 74)" class="i">logsumexp</span>) <span onmouseout="hideTip(event, 'fs16', 75)" onmouseover="showTip(event, 'fs16', 75)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 76)" onmouseover="showTip(event, 'fs17', 76)" class="i">ct2</span></pre>


<p>Another thing to consider is that we'll want to perform operation which "fold" our tree, that is, get one final value of a type 'a,
whose computation comes from a complete traversal of the structure. So we define a generalized fold on our structure. 
Note that the is a folding function to the said type for each constructor : This generalizes the fold on a list and is an example of 'catamorphism'.
(as everyone knows, a catamorphism is just the categorical dual of an anamorphism, with some bananas)</p>

<pre class="fssnip">
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 77)" onmouseover="showTip(event, 'fs26', 77)" class="i">fold</span> (<span onmouseout="hideTip(event, 'fs27', 78)" onmouseover="showTip(event, 'fs27', 78)" class="i">fNode</span><span class="o">:</span><span class="o">'</span><span class="i">a</span><span class="k">-&gt;</span><span class="o">'</span><span class="i">a</span><span class="k">-&gt;</span><span class="o">'</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs28', 79)" onmouseover="showTip(event, 'fs28', 79)" class="i">fLeaf</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span class="k">-&gt;</span> <span class="o">'</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="i">x</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs4', 81)" onmouseover="showTip(event, 'fs4', 81)" class="i">CodeTree</span>) <span class="o">=</span> 
    <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs30', 82)" onmouseover="showTip(event, 'fs30', 82)" class="i">f</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 83)" onmouseover="showTip(event, 'fs5', 83)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs31', 84)" onmouseover="showTip(event, 'fs31', 84)" class="i">e</span>,<span onmouseout="hideTip(event, 'fs13', 85)" onmouseover="showTip(event, 'fs13', 85)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 86)" onmouseover="showTip(event, 'fs28', 86)" class="i">fLeaf</span>(<span onmouseout="hideTip(event, 'fs31', 87)" onmouseover="showTip(event, 'fs31', 87)" class="i">e</span>) 
                         | <span onmouseout="hideTip(event, 'fs7', 88)" onmouseover="showTip(event, 'fs7', 88)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs32', 89)" onmouseover="showTip(event, 'fs32', 89)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs33', 90)" onmouseover="showTip(event, 'fs33', 90)" class="i">r</span>,<span onmouseout="hideTip(event, 'fs34', 91)" onmouseover="showTip(event, 'fs34', 91)" class="i">cs</span>,<span onmouseout="hideTip(event, 'fs13', 92)" onmouseover="showTip(event, 'fs13', 92)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 93)" onmouseover="showTip(event, 'fs27', 93)" class="i">fNode</span>(<span onmouseout="hideTip(event, 'fs30', 94)" onmouseover="showTip(event, 'fs30', 94)" class="i">f</span> <span onmouseout="hideTip(event, 'fs32', 95)" onmouseover="showTip(event, 'fs32', 95)" class="i">l</span>)(<span onmouseout="hideTip(event, 'fs30', 96)" onmouseover="showTip(event, 'fs30', 96)" class="i">f</span> <span onmouseout="hideTip(event, 'fs33', 97)" onmouseover="showTip(event, 'fs33', 97)" class="i">r</span>) 
    <span onmouseout="hideTip(event, 'fs30', 98)" onmouseover="showTip(event, 'fs30', 98)" class="i">f</span> <span onmouseout="hideTip(event, 'fs29', 99)" onmouseover="showTip(event, 'fs29', 99)" class="i">x</span> </pre>


<p>We'll also use the following function which splits a list into two parts, while a condition f(e) is verified</p>

<pre class="fssnip">
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs35', 100)" onmouseover="showTip(event, 'fs35', 100)" class="i">List</span> <span class="o">=</span>
   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 101)" onmouseover="showTip(event, 'fs36', 101)" class="i">span</span> <span onmouseout="hideTip(event, 'fs37', 102)" onmouseover="showTip(event, 'fs37', 102)" class="i">f</span> <span onmouseout="hideTip(event, 'fs38', 103)" onmouseover="showTip(event, 'fs38', 103)" class="i">xs</span> <span class="o">=</span> 
     <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 104)" onmouseover="showTip(event, 'fs11', 104)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 105)" onmouseover="showTip(event, 'fs39', 105)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 106)" onmouseover="showTip(event, 'fs38', 106)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 107)" onmouseover="showTip(event, 'fs35', 107)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 108)" onmouseover="showTip(event, 'fs40', 108)" class="i">fold</span>(<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs11', 109)" onmouseover="showTip(event, 'fs11', 109)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 110)" onmouseover="showTip(event, 'fs39', 110)" class="i">r</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 111)" onmouseover="showTip(event, 'fs8', 111)" class="i">list</span>) <span onmouseout="hideTip(event, 'fs41', 112)" onmouseover="showTip(event, 'fs41', 112)" class="i">e</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs37', 113)" onmouseover="showTip(event, 'fs37', 113)" class="i">f</span> <span onmouseout="hideTip(event, 'fs41', 114)" onmouseover="showTip(event, 'fs41', 114)" class="i">e</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs41', 115)" onmouseover="showTip(event, 'fs41', 115)" class="i">e</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs11', 116)" onmouseover="showTip(event, 'fs11', 116)" class="i">l</span>, <span onmouseout="hideTip(event, 'fs39', 117)" onmouseover="showTip(event, 'fs39', 117)" class="i">r</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 118)" onmouseover="showTip(event, 'fs42', 118)" class="i">Tail</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs11', 119)" onmouseover="showTip(event, 'fs11', 119)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 120)" onmouseover="showTip(event, 'fs39', 120)" class="i">r</span> ) 
                              ([],<span onmouseout="hideTip(event, 'fs38', 121)" onmouseover="showTip(event, 'fs38', 121)" class="i">xs</span>)
     <span onmouseout="hideTip(event, 'fs11', 122)" onmouseover="showTip(event, 'fs11', 122)" class="i">l</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 123)" onmouseover="showTip(event, 'fs35', 123)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 124)" onmouseover="showTip(event, 'fs43', 124)" class="i">rev</span>, <span onmouseout="hideTip(event, 'fs39', 125)" onmouseover="showTip(event, 'fs39', 125)" class="i">r</span>


<span class="k">module</span> <span onmouseout="hideTip(event, 'fs44', 126)" onmouseover="showTip(event, 'fs44', 126)" class="i">Huffman</span> <span class="o">=</span> 
  <span class="k">open</span> <span onmouseout="hideTip(event, 'fs45', 127)" onmouseover="showTip(event, 'fs45', 127)" class="i">CodeTree</span></pre>


<p>This is just to build some frequency table from a sample.
If we already know, or posit, the frequencies, we don't need it.</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 128)" onmouseover="showTip(event, 'fs46', 128)" class="i">buildFreq</span> (<span onmouseout="hideTip(event, 'fs47', 129)" onmouseover="showTip(event, 'fs47', 129)" class="i">sample</span> <span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 130)" onmouseover="showTip(event, 'fs8', 130)" class="i">list</span>) <span class="o">=</span> 
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs47', 131)" onmouseover="showTip(event, 'fs47', 131)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 132)" onmouseover="showTip(event, 'fs48', 132)" class="i">Length</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> []
    <span class="k">else</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs47', 133)" onmouseover="showTip(event, 'fs47', 133)" class="i">sample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 134)" onmouseover="showTip(event, 'fs47', 134)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 135)" onmouseover="showTip(event, 'fs35', 135)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 136)" onmouseover="showTip(event, 'fs49', 136)" class="i">sort</span>
         <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs50', 137)" onmouseover="showTip(event, 'fs50', 137)" class="i">count</span> (<span onmouseout="hideTip(event, 'fs51', 138)" onmouseover="showTip(event, 'fs51', 138)" class="i">sample</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 139)" onmouseover="showTip(event, 'fs8', 139)" class="i">list</span>) <span class="o">=</span> 
             [ <span class="k">if</span> <span onmouseout="hideTip(event, 'fs51', 140)" onmouseover="showTip(event, 'fs51', 140)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 141)" onmouseover="showTip(event, 'fs48', 141)" class="i">Length</span> <span class="o">&lt;&gt;</span> <span class="n">0</span> <span class="k">then</span> 
                 <span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 142)" onmouseover="showTip(event, 'fs52', 142)" class="i">left</span>, <span onmouseout="hideTip(event, 'fs53', 143)" onmouseover="showTip(event, 'fs53', 143)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs51', 144)" onmouseover="showTip(event, 'fs51', 144)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 145)" onmouseover="showTip(event, 'fs35', 145)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 146)" onmouseover="showTip(event, 'fs36', 146)" class="i">span</span> ((<span class="o">=</span>) <span onmouseout="hideTip(event, 'fs51', 147)" onmouseover="showTip(event, 'fs51', 147)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 148)" onmouseover="showTip(event, 'fs54', 148)" class="i">Head</span>)
                 <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs51', 149)" onmouseover="showTip(event, 'fs51', 149)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 150)" onmouseover="showTip(event, 'fs54', 150)" class="i">Head</span>,<span onmouseout="hideTip(event, 'fs52', 151)" onmouseover="showTip(event, 'fs52', 151)" class="i">left</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 152)" onmouseover="showTip(event, 'fs48', 152)" class="i">Length</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 153)" onmouseover="showTip(event, 'fs6', 153)" class="i">float</span>
                 <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs50', 154)" onmouseover="showTip(event, 'fs50', 154)" class="i">count</span> <span onmouseout="hideTip(event, 'fs53', 155)" onmouseover="showTip(event, 'fs53', 155)" class="i">right</span>  ]
         <span onmouseout="hideTip(event, 'fs50', 156)" onmouseover="showTip(event, 'fs50', 156)" class="i">count</span> <span onmouseout="hideTip(event, 'fs51', 157)" onmouseover="showTip(event, 'fs51', 157)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 158)" onmouseover="showTip(event, 'fs35', 158)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 159)" onmouseover="showTip(event, 'fs55', 159)" class="i">sortBy</span> <span onmouseout="hideTip(event, 'fs56', 160)" onmouseover="showTip(event, 'fs56', 160)" class="i">snd</span>        </pre>


<h3>The core recursion</h3>

<p>The next function is <strong>the core</strong> of the Huffman code construction.
It accepts a list of character and their frequency as input, and builds a sequence of list of optimal codes.</p>

<p>Remember that we want to go from an optimal CodeTrees for small vocabularies to a bigger one, optimal on the combined vocabulary.
When a vocabulary has only 1 word in it, a leaf necessitate 0 bits to identify which word the transmitted word is.</p>

<p>Given a list of optimal codetree, the assumption here is that merging the 2 least frequent one leads to a new 
optimal codetree.</p>

<p>To see this, reckon that the merge operation will translate to adding one bit to the new tree, which will be needed to choose between its subbranches.
Whatever merging comes after a merge, that one bit spent will alway be needed to identify the characters merged.</p>

<p>It should therefore be clear that, if we intend to lengthen our final code by one bit, it is optimal to do so with branches 
which are the least frequent of all. we therefore merge the least used CodeTrees.</p>

<p>So overall, we start by sorting the frequency list and making leaf of all characters, as there is no doubt that leaf are optimal for those, 
and apply the merging operation until only one CodeTree is left.</p>

<pre class="fssnip">
  <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs57', 161)" onmouseover="showTip(event, 'fs57', 161)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs58', 162)" onmouseover="showTip(event, 'fs58', 162)" class="i">merge</span> (<span onmouseout="hideTip(event, 'fs59', 163)" onmouseover="showTip(event, 'fs59', 163)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 164)" onmouseover="showTip(event, 'fs6', 164)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 165)" onmouseover="showTip(event, 'fs8', 165)" class="i">list</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs45', 166)" onmouseover="showTip(event, 'fs45', 166)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span>
  <span class="c">//This function accepts the Leaf list built at first call, until only one CodeTree remains in the list.</span>
  <span class="c">//At each step we only build optimal CodeTree, so the resulting tree is optimal for the whole dictionary.</span>
       <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs60', 167)" onmouseover="showTip(event, 'fs60', 167)" class="i">loop</span> <span class="o">=</span> <span class="k">function</span>        
       | [] <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs61', 168)" onmouseover="showTip(event, 'fs61', 168)" class="i">failwith</span> <span class="s">"</span><span class="s">not</span><span class="s"> </span><span class="s">possible</span><span class="s">"</span> 
       | [<span onmouseout="hideTip(event, 'fs33', 169)" onmouseover="showTip(event, 'fs33', 169)" class="i">r</span>] <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 170)" onmouseover="showTip(event, 'fs33', 170)" class="i">r</span>
       | <span onmouseout="hideTip(event, 'fs62', 171)" onmouseover="showTip(event, 'fs62', 171)" class="i">f</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs63', 172)" onmouseover="showTip(event, 'fs63', 172)" class="i">s</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs64', 173)" onmouseover="showTip(event, 'fs64', 173)" class="i">xs</span> <span class="k">-&gt;</span>
           <span class="c">//We merge the first and second CodeTree</span>
           <span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 174)" onmouseover="showTip(event, 'fs65', 174)" class="i">newCT</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs58', 175)" onmouseover="showTip(event, 'fs58', 175)" class="i">merge</span> <span onmouseout="hideTip(event, 'fs62', 176)" onmouseover="showTip(event, 'fs62', 176)" class="i">f</span> <span onmouseout="hideTip(event, 'fs63', 177)" onmouseover="showTip(event, 'fs63', 177)" class="i">s</span>
           <span class="c">//we split the other CodeTree list at the weight of the new tree  </span>
           <span class="k">let</span> <span onmouseout="hideTip(event, 'fs66', 178)" onmouseover="showTip(event, 'fs66', 178)" class="i">left</span>,<span onmouseout="hideTip(event, 'fs67', 179)" onmouseover="showTip(event, 'fs67', 179)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 180)" onmouseover="showTip(event, 'fs35', 180)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 181)" onmouseover="showTip(event, 'fs36', 181)" class="i">span</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs68', 182)" onmouseover="showTip(event, 'fs68', 182)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 183)" onmouseover="showTip(event, 'fs12', 183)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs68', 184)" onmouseover="showTip(event, 'fs68', 184)" class="i">e</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs12', 185)" onmouseover="showTip(event, 'fs12', 185)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs65', 186)" onmouseover="showTip(event, 'fs65', 186)" class="i">newCT</span>) <span onmouseout="hideTip(event, 'fs64', 187)" onmouseover="showTip(event, 'fs64', 187)" class="i">xs</span>
           <span class="c">//insert the new Tree where, and then recurse, </span>
           <span class="c">//with a new list shorter by one from the previous iteration  </span>
           <span onmouseout="hideTip(event, 'fs60', 188)" onmouseover="showTip(event, 'fs60', 188)" class="i">loop</span>(<span onmouseout="hideTip(event, 'fs66', 189)" onmouseover="showTip(event, 'fs66', 189)" class="i">left</span> <span class="o">@</span> (<span onmouseout="hideTip(event, 'fs65', 190)" onmouseover="showTip(event, 'fs65', 190)" class="i">newCT</span><span class="o">::</span> <span onmouseout="hideTip(event, 'fs67', 191)" onmouseover="showTip(event, 'fs67', 191)" class="i">right</span>))
       <span onmouseout="hideTip(event, 'fs60', 192)" onmouseover="showTip(event, 'fs60', 192)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs59', 193)" onmouseover="showTip(event, 'fs59', 193)" class="i">distrib</span>  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 194)" onmouseover="showTip(event, 'fs35', 194)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 195)" onmouseover="showTip(event, 'fs55', 195)" class="i">sortBy</span>(<span onmouseout="hideTip(event, 'fs56', 196)" onmouseover="showTip(event, 'fs56', 196)" class="i">snd</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 197)" onmouseover="showTip(event, 'fs35', 197)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 198)" onmouseover="showTip(event, 'fs69', 198)" class="i">map</span>(<span onmouseout="hideTip(event, 'fs5', 199)" onmouseover="showTip(event, 'fs5', 199)" class="i">Leaf</span>))

  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 200)" onmouseover="showTip(event, 'fs70', 200)" class="i">buildCodeFromFreq</span>   (<span onmouseout="hideTip(event, 'fs59', 201)" onmouseover="showTip(event, 'fs59', 201)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 202)" onmouseover="showTip(event, 'fs6', 202)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 203)" onmouseover="showTip(event, 'fs8', 203)" class="i">list</span>)<span class="o">:</span> <span onmouseout="hideTip(event, 'fs45', 204)" onmouseover="showTip(event, 'fs45', 204)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 205)" onmouseover="showTip(event, 'fs57', 205)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs24', 206)" onmouseover="showTip(event, 'fs24', 206)" class="i">mergePlus</span>    <span onmouseout="hideTip(event, 'fs59', 207)" onmouseover="showTip(event, 'fs59', 207)" class="i">distrib</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 208)" onmouseover="showTip(event, 'fs71', 208)" class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs59', 209)" onmouseover="showTip(event, 'fs59', 209)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 210)" onmouseover="showTip(event, 'fs6', 210)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 211)" onmouseover="showTip(event, 'fs8', 211)" class="i">list</span>)<span class="o">:</span> <span onmouseout="hideTip(event, 'fs45', 212)" onmouseover="showTip(event, 'fs45', 212)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 213)" onmouseover="showTip(event, 'fs57', 213)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs25', 214)" onmouseover="showTip(event, 'fs25', 214)" class="i">mergeLogPlus</span> <span onmouseout="hideTip(event, 'fs59', 215)" onmouseover="showTip(event, 'fs59', 215)" class="i">distrib</span></pre>


<p>We can now <strong>decode</strong> a new string encoded with our new dictionnary</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 216)" onmouseover="showTip(event, 'fs72', 216)" class="i">decode</span> (<span onmouseout="hideTip(event, 'fs73', 217)" onmouseover="showTip(event, 'fs73', 217)" class="i">codeTree</span><span class="o">:</span>_ <span onmouseout="hideTip(event, 'fs45', 218)" onmouseover="showTip(event, 'fs45', 218)" class="i">CodeTree</span>) (<span onmouseout="hideTip(event, 'fs74', 219)" onmouseover="showTip(event, 'fs74', 219)" class="i">bits</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs75', 220)" onmouseover="showTip(event, 'fs75', 220)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 221)" onmouseover="showTip(event, 'fs8', 221)" class="i">list</span>) <span class="o">=</span>
       <span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 222)" onmouseover="showTip(event, 'fs76', 222)" class="i">o</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs74', 223)" onmouseover="showTip(event, 'fs74', 223)" class="i">bits</span> 
               <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 224)" onmouseover="showTip(event, 'fs35', 224)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 225)" onmouseover="showTip(event, 'fs40', 225)" class="i">fold</span>(<span class="k">fun</span> ((<span onmouseout="hideTip(event, 'fs7', 226)" onmouseover="showTip(event, 'fs7', 226)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs77', 227)" onmouseover="showTip(event, 'fs77', 227)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs78', 228)" onmouseover="showTip(event, 'fs78', 228)" class="i">r</span>,_,_)), <span onmouseout="hideTip(event, 'fs79', 229)" onmouseover="showTip(event, 'fs79', 229)" class="i">decMsg</span>) <span onmouseout="hideTip(event, 'fs80', 230)" onmouseover="showTip(event, 'fs80', 230)" class="i">b</span> <span class="k">-&gt;</span>  
                             <span class="k">match</span> (<span class="k">if</span> <span onmouseout="hideTip(event, 'fs80', 231)" onmouseover="showTip(event, 'fs80', 231)" class="i">b</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs77', 232)" onmouseover="showTip(event, 'fs77', 232)" class="i">l</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs78', 233)" onmouseover="showTip(event, 'fs78', 233)" class="i">r</span>) <span class="k">with</span> 
                             <span class="c">//we append the new character and continue with the original </span>
                             | <span onmouseout="hideTip(event, 'fs5', 234)" onmouseover="showTip(event, 'fs5', 234)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 235)" onmouseover="showTip(event, 'fs10', 235)" class="i">c</span>,_) <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs73', 236)" onmouseover="showTip(event, 'fs73', 236)" class="i">codeTree</span>, <span onmouseout="hideTip(event, 'fs10', 237)" onmouseover="showTip(event, 'fs10', 237)" class="i">c</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs79', 238)" onmouseover="showTip(event, 'fs79', 238)" class="i">decMsg</span>) 
                             <span class="c">//or we continue peeling off the chosen branch</span>
                             | <span onmouseout="hideTip(event, 'fs81', 239)" onmouseover="showTip(event, 'fs81', 239)" class="i">current</span>   <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs81', 240)" onmouseover="showTip(event, 'fs81', 240)" class="i">current</span> , <span onmouseout="hideTip(event, 'fs79', 241)" onmouseover="showTip(event, 'fs79', 241)" class="i">decMsg</span>))
                           <span class="c">//no decoded characters at 1st and a full Codetree to traverse</span>
                           (<span onmouseout="hideTip(event, 'fs73', 242)" onmouseover="showTip(event, 'fs73', 242)" class="i">codeTree</span>, [])
       <span onmouseout="hideTip(event, 'fs56', 243)" onmouseover="showTip(event, 'fs56', 243)" class="i">snd</span> <span onmouseout="hideTip(event, 'fs76', 244)" onmouseover="showTip(event, 'fs76', 244)" class="i">o</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 245)" onmouseover="showTip(event, 'fs35', 245)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 246)" onmouseover="showTip(event, 'fs43', 246)" class="i">rev</span></pre>


<p>And of course we can encode as well. In that case instead of searching for the correct leaf at each 
character by traversing the CodeTree, we build a map wich gives us in O(1) the new coded character.</p>

<p>Note the use of the generalized fold : Everytime we encouter a leaf,  we create a new Map which associates 
the character to the empty binary string. Every time we encouter a Fork, we add 0 to the entries of the left Map, 
and 1 to the right Map.</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs82', 247)" onmouseover="showTip(event, 'fs82', 247)" class="i">makeEncoderDic</span> (<span onmouseout="hideTip(event, 'fs83', 248)" onmouseover="showTip(event, 'fs83', 248)" class="i">tree</span><span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs45', 249)" onmouseover="showTip(event, 'fs45', 249)" class="i">CodeTree</span>) <span class="o">=</span> 
      <span onmouseout="hideTip(event, 'fs45', 250)" onmouseover="showTip(event, 'fs45', 250)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 251)" onmouseover="showTip(event, 'fs26', 251)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs84', 252)" onmouseover="showTip(event, 'fs84', 252)" class="i">lMap</span> <span onmouseout="hideTip(event, 'fs85', 253)" onmouseover="showTip(event, 'fs85', 253)" class="i">rMap</span> <span class="k">-&gt;</span> 
                        <span onmouseout="hideTip(event, 'fs84', 254)" onmouseover="showTip(event, 'fs84', 254)" class="i">lMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs86', 255)" onmouseover="showTip(event, 'fs86', 255)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs87', 256)" onmouseover="showTip(event, 'fs87', 256)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs88', 257)" onmouseover="showTip(event, 'fs88', 257)" class="i">m</span> <span onmouseout="hideTip(event, 'fs89', 258)" onmouseover="showTip(event, 'fs89', 258)" class="i">k</span> <span onmouseout="hideTip(event, 'fs90', 259)" onmouseover="showTip(event, 'fs90', 259)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs88', 260)" onmouseover="showTip(event, 'fs88', 260)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 261)" onmouseover="showTip(event, 'fs91', 261)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs89', 262)" onmouseover="showTip(event, 'fs89', 262)" class="i">k</span>, <span class="n">0</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs90', 263)" onmouseover="showTip(event, 'fs90', 263)" class="i">v</span>)) 
                                        (<span onmouseout="hideTip(event, 'fs85', 264)" onmouseover="showTip(event, 'fs85', 264)" class="i">rMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs86', 265)" onmouseover="showTip(event, 'fs86', 265)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs87', 266)" onmouseover="showTip(event, 'fs87', 266)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs88', 267)" onmouseover="showTip(event, 'fs88', 267)" class="i">m</span> <span onmouseout="hideTip(event, 'fs89', 268)" onmouseover="showTip(event, 'fs89', 268)" class="i">k</span> <span onmouseout="hideTip(event, 'fs90', 269)" onmouseover="showTip(event, 'fs90', 269)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs88', 270)" onmouseover="showTip(event, 'fs88', 270)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 271)" onmouseover="showTip(event, 'fs91', 271)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs89', 272)" onmouseover="showTip(event, 'fs89', 272)" class="i">k</span>, <span class="n">1</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs90', 273)" onmouseover="showTip(event, 'fs90', 273)" class="i">v</span>)) 
                                                         <span onmouseout="hideTip(event, 'fs86', 274)" onmouseover="showTip(event, 'fs86', 274)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs92', 275)" onmouseover="showTip(event, 'fs92', 275)" class="i">empty</span>)) 
                   (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs93', 276)" onmouseover="showTip(event, 'fs93', 276)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs86', 277)" onmouseover="showTip(event, 'fs86', 277)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs92', 278)" onmouseover="showTip(event, 'fs92', 278)" class="i">empty</span><span class="o">.</span><span class="i">Add</span>(<span onmouseout="hideTip(event, 'fs93', 279)" onmouseover="showTip(event, 'fs93', 279)" class="i">c</span>,[])) 
                   <span onmouseout="hideTip(event, 'fs83', 280)" onmouseover="showTip(event, 'fs83', 280)" class="i">tree</span></pre>


<p>Provided the map, the encode function is really just a lookup for each character...</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs94', 281)" onmouseover="showTip(event, 'fs94', 281)" class="i">encode</span> (<span onmouseout="hideTip(event, 'fs95', 282)" onmouseover="showTip(event, 'fs95', 282)" class="i">dic</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs86', 283)" onmouseover="showTip(event, 'fs86', 283)" class="i">Map</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span>,<span onmouseout="hideTip(event, 'fs75', 284)" onmouseover="showTip(event, 'fs75', 284)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 285)" onmouseover="showTip(event, 'fs8', 285)" class="i">list</span><span class="o">&gt;</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 286)" onmouseover="showTip(event, 'fs35', 286)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 287)" onmouseover="showTip(event, 'fs69', 287)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs96', 288)" onmouseover="showTip(event, 'fs96', 288)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs95', 289)" onmouseover="showTip(event, 'fs95', 289)" class="i">dic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 290)" onmouseover="showTip(event, 'fs97', 290)" class="i">Item</span>(<span onmouseout="hideTip(event, 'fs96', 291)" onmouseover="showTip(event, 'fs96', 291)" class="i">x</span>)) <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs35', 292)" onmouseover="showTip(event, 'fs35', 292)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs98', 293)" onmouseover="showTip(event, 'fs98', 293)" class="i">concat</span></pre>


<p>Now we can verify that this indeed work by decoding a secret, courtesy of Marin Odersky-san</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs99', 294)" onmouseover="showTip(event, 'fs99', 294)" class="i">secret</span> <span class="o">=</span> [<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>]
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 295)" onmouseover="showTip(event, 'fs100', 295)" class="i">frenchCode</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 296)" onmouseover="showTip(event, 'fs7', 296)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 297)" onmouseover="showTip(event, 'fs7', 297)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 298)" onmouseover="showTip(event, 'fs7', 298)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 299)" onmouseover="showTip(event, 'fs5', 299)" class="i">Leaf</span>(<span class="s">'s'</span>,<span class="n">121895.</span>),<span onmouseout="hideTip(event, 'fs7', 300)" onmouseover="showTip(event, 'fs7', 300)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 301)" onmouseover="showTip(event, 'fs5', 301)" class="i">Leaf</span>(<span class="s">'d'</span>,<span class="n">56269.</span>),<span onmouseout="hideTip(event, 'fs7', 302)" onmouseover="showTip(event, 'fs7', 302)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 303)" onmouseover="showTip(event, 'fs7', 303)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 304)" onmouseover="showTip(event, 'fs7', 304)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 305)" onmouseover="showTip(event, 'fs5', 305)" class="i">Leaf</span>(<span class="s">'x'</span>,<span class="n">5928.</span>),<span onmouseout="hideTip(event, 'fs5', 306)" onmouseover="showTip(event, 'fs5', 306)" class="i">Leaf</span>(<span class="s">'j'</span>,<span class="n">8351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>],<span class="n">14279.</span>),<span onmouseout="hideTip(event, 'fs5', 307)" onmouseover="showTip(event, 'fs5', 307)" class="i">Leaf</span>(<span class="s">'f'</span>,<span class="n">16351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>],<span class="n">30630.</span>),<span onmouseout="hideTip(event, 'fs7', 308)" onmouseover="showTip(event, 'fs7', 308)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 309)" onmouseover="showTip(event, 'fs7', 309)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 310)" onmouseover="showTip(event, 'fs5', 310)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 311)" onmouseover="showTip(event, 'fs7', 311)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 312)" onmouseover="showTip(event, 'fs5', 312)" class="i">Leaf</span>(<span class="s">'z'</span>,<span class="n">2093.</span>),<span onmouseout="hideTip(event, 'fs7', 313)" onmouseover="showTip(event, 'fs7', 313)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 314)" onmouseover="showTip(event, 'fs5', 314)" class="i">Leaf</span>(<span class="s">'k'</span>,<span class="n">745.</span>),<span onmouseout="hideTip(event, 'fs5', 315)" onmouseover="showTip(event, 'fs5', 315)" class="i">Leaf</span>(<span class="s">'w'</span>,<span class="n">1747.</span>),[<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">2492.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">4585.</span>),<span onmouseout="hideTip(event, 'fs5', 316)" onmouseover="showTip(event, 'fs5', 316)" class="i">Leaf</span>(<span class="s">'y'</span>,<span class="n">4725.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>],<span class="n">9310.</span>),<span onmouseout="hideTip(event, 'fs5', 317)" onmouseover="showTip(event, 'fs5', 317)" class="i">Leaf</span>(<span class="s">'h'</span>,<span class="n">11298.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>],<span class="n">20608.</span>),<span onmouseout="hideTip(event, 'fs5', 318)" onmouseover="showTip(event, 'fs5', 318)" class="i">Leaf</span>(<span class="s">'q'</span>,<span class="n">20889.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">41497.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">72127.</span>),[<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">128396.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">250291.</span>),<span onmouseout="hideTip(event, 'fs7', 319)" onmouseover="showTip(event, 'fs7', 319)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 320)" onmouseover="showTip(event, 'fs7', 320)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 321)" onmouseover="showTip(event, 'fs7', 321)" class="i">Leaf</span>(<span class="s">'o'</span>,<span class="n">82762.</span>),<span onmouseout="hideTip(event, 'fs5', 322)" onmouseover="showTip(event, 'fs5', 322)" class="i">Leaf</span>(<span class="s">'l'</span>,<span class="n">83668.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>],<span class="n">166430.</span>),<span onmouseout="hideTip(event, 'fs7', 323)" onmouseover="showTip(event, 'fs7', 323)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 324)" onmouseover="showTip(event, 'fs7', 324)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 325)" onmouseover="showTip(event, 'fs5', 325)" class="i">Leaf</span>(<span class="s">'m'</span>,<span class="n">45521.</span>),<span onmouseout="hideTip(event, 'fs5', 326)" onmouseover="showTip(event, 'fs5', 326)" class="i">Leaf</span>(<span class="s">'p'</span>,<span class="n">46335.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>],<span class="n">91856.</span>),<span onmouseout="hideTip(event, 'fs5', 327)" onmouseover="showTip(event, 'fs5', 327)" class="i">Leaf</span>(<span class="s">'u'</span>,<span class="n">96785.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">188641.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">355071.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">605362.</span>),<span onmouseout="hideTip(event, 'fs7', 328)" onmouseover="showTip(event, 'fs7', 328)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 329)" onmouseover="showTip(event, 'fs7', 329)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 330)" onmouseover="showTip(event, 'fs7', 330)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 331)" onmouseover="showTip(event, 'fs5', 331)" class="i">Leaf</span>(<span class="s">'r'</span>,<span class="n">100500.</span>),<span onmouseout="hideTip(event, 'fs7', 332)" onmouseover="showTip(event, 'fs7', 332)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 333)" onmouseover="showTip(event, 'fs5', 333)" class="i">Leaf</span>(<span class="s">'c'</span>,<span class="n">50003.</span>),<span onmouseout="hideTip(event, 'fs7', 334)" onmouseover="showTip(event, 'fs7', 334)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 335)" onmouseover="showTip(event, 'fs5', 335)" class="i">Leaf</span>(<span class="s">'v'</span>,<span class="n">24975.</span>),<span onmouseout="hideTip(event, 'fs7', 336)" onmouseover="showTip(event, 'fs7', 336)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 337)" onmouseover="showTip(event, 'fs5', 337)" class="i">Leaf</span>(<span class="s">'g'</span>,<span class="n">13288.</span>),<span onmouseout="hideTip(event, 'fs5', 338)" onmouseover="showTip(event, 'fs5', 338)" class="i">Leaf</span>(<span class="s">'b'</span>,<span class="n">13822.</span>),[<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">27110.</span>),[<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">52085.</span>),[<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">102088.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">202588.</span>),<span onmouseout="hideTip(event, 'fs7', 339)" onmouseover="showTip(event, 'fs7', 339)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 340)" onmouseover="showTip(event, 'fs5', 340)" class="i">Leaf</span>(<span class="s">'n'</span>,<span class="n">108812.</span>),<span onmouseout="hideTip(event, 'fs5', 341)" onmouseover="showTip(event, 'fs5', 341)" class="i">Leaf</span>(<span class="s">'t'</span>,<span class="n">111103.</span>),[<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">219915.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">422503.</span>),<span onmouseout="hideTip(event, 'fs7', 342)" onmouseover="showTip(event, 'fs7', 342)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 343)" onmouseover="showTip(event, 'fs5', 343)" class="i">Leaf</span>(<span class="s">'e'</span>,<span class="n">225947.</span>),<span onmouseout="hideTip(event, 'fs7', 344)" onmouseover="showTip(event, 'fs7', 344)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 345)" onmouseover="showTip(event, 'fs5', 345)" class="i">Leaf</span>(<span class="s">'i'</span>,<span class="n">115465.</span>),<span onmouseout="hideTip(event, 'fs5', 346)" onmouseover="showTip(event, 'fs5', 346)" class="i">Leaf</span>(<span class="s">'a'</span>,<span class="n">117110.</span>),[<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">232575.</span>),[<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">458522.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">881025.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>;<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">1486387.</span>)</pre>


<p>Now a legitimate question is to know what is this secret. Is it cool ?</p>

<pre class="fssnip">
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 347)" onmouseover="showTip(event, 'fs101', 347)" class="i">r</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs72', 348)" onmouseover="showTip(event, 'fs72', 348)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs100', 349)" onmouseover="showTip(event, 'fs100', 349)" class="i">frenchCode</span> <span onmouseout="hideTip(event, 'fs99', 350)" onmouseover="showTip(event, 'fs99', 350)" class="i">secret</span></pre>


          <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Collections</div>
<div class="tip" id="fs3">namespace System.Collections.Generic</div>
<div class="tip" id="fs4">type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Huffman.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs5">union case CodeTree.Leaf: 'T * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs6">Multiple items<br>val float : value:'T -&gt; float (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.float<br><br>--------------------<br>type float&lt;'Measure&gt; = float<br><br>Full name: Microsoft.FSharp.Core.float&lt;_&gt;<br><br>--------------------<br>type float = Double<br><br>Full name: Microsoft.FSharp.Core.float</div>
<div class="tip" id="fs7">union case CodeTree.Fork: CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs8">type 'T list = List&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
<div class="tip" id="fs9">val chars : _arg1:CodeTree&lt;'a&gt; -&gt; 'a list<br><br>Full name: Huffman.CodeTree.chars</div>
<div class="tip" id="fs10">val c : 'a</div>
<div class="tip" id="fs11">val l : 'a list</div>
<div class="tip" id="fs12">val weight : _arg1:CodeTree&lt;'a&gt; -&gt; float<br><br>Full name: Huffman.CodeTree.weight</div>
<div class="tip" id="fs13">val w : float</div>
<div class="tip" id="fs14">val merge : addweight:(float -&gt; float -&gt; float) -&gt; ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Huffman.CodeTree.merge</div>
<div class="tip" id="fs15">val addweight : (float -&gt; float -&gt; float)</div>
<div class="tip" id="fs16">val ct1 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs17">val ct2 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs18">val private logsumexp : logx:float -&gt; logy:float -&gt; float<br><br>Full name: Huffman.CodeTree.logsumexp</div>
<div class="tip" id="fs19">val logx : float</div>
<div class="tip" id="fs20">val logy : float</div>
<div class="tip" id="fs21">type Math =<br>&nbsp;&nbsp;static val E : float<br>&nbsp;&nbsp;static val PI : float<br>&nbsp;&nbsp;static member Abs : value:decimal -&gt; decimal + 6 overloads<br>&nbsp;&nbsp;static member Acos : d:float -&gt; float<br>&nbsp;&nbsp;static member Asin : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan2 : y:float * x:float -&gt; float<br>&nbsp;&nbsp;static member BigMul : a:int * b:int -&gt; int64<br>&nbsp;&nbsp;static member Ceiling : d:decimal -&gt; decimal + 1 overload<br>&nbsp;&nbsp;static member Cos : d:float -&gt; float<br>&nbsp;&nbsp;...<br><br>Full name: System.Math</div>
<div class="tip" id="fs22">Math.Log(d: float) : float<br>Math.Log(a: float, newBase: float) : float</div>
<div class="tip" id="fs23">Math.Exp(d: float) : float</div>
<div class="tip" id="fs24">val mergePlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Huffman.CodeTree.mergePlus</div>
<div class="tip" id="fs25">val mergeLogPlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Huffman.CodeTree.mergeLogPlus</div>
<div class="tip" id="fs26">val fold : fNode:('a -&gt; 'a -&gt; 'a) -&gt; fLeaf:('T -&gt; 'a) -&gt; x:CodeTree&lt;'T&gt; -&gt; 'a<br><br>Full name: Huffman.CodeTree.fold</div>
<div class="tip" id="fs27">val fNode : ('a -&gt; 'a -&gt; 'a)</div>
<div class="tip" id="fs28">val fLeaf : ('T -&gt; 'a)</div>
<div class="tip" id="fs29">val x : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs30">val f : (CodeTree&lt;'T&gt; -&gt; 'a)</div>
<div class="tip" id="fs31">val e : 'T</div>
<div class="tip" id="fs32">val l : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs33">val r : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs34">val cs : 'T list</div>
<div class="tip" id="fs35">Multiple items<br>type List&lt;'T&gt; =<br>&nbsp;&nbsp;new : unit -&gt; List&lt;'T&gt; + 2 overloads<br>&nbsp;&nbsp;member Add : item:'T -&gt; unit<br>&nbsp;&nbsp;member AddRange : collection:IEnumerable&lt;'T&gt; -&gt; unit<br>&nbsp;&nbsp;member AsReadOnly : unit -&gt; ReadOnlyCollection&lt;'T&gt;<br>&nbsp;&nbsp;member BinarySearch : item:'T -&gt; int + 2 overloads<br>&nbsp;&nbsp;member Capacity : int with get, set<br>&nbsp;&nbsp;member Clear : unit -&gt; unit<br>&nbsp;&nbsp;member Contains : item:'T -&gt; bool<br>&nbsp;&nbsp;member ConvertAll&lt;'TOutput&gt; : converter:Converter&lt;'T, 'TOutput&gt; -&gt; List&lt;'TOutput&gt;<br>&nbsp;&nbsp;member CopyTo : array:'T[] -&gt; unit + 2 overloads<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;nested type Enumerator<br><br>Full name: System.Collections.Generic.List&lt;_&gt;<br><br>--------------------<br>List() : unit<br>List(collection: IEnumerable&lt;'T&gt;) : unit<br>List(capacity: int) : unit</div>
<div class="tip" id="fs36">val span : f:('a -&gt; bool) -&gt; xs:'a list -&gt; 'a list * 'a list<br><br>Full name: Huffman.List.span</div>
<div class="tip" id="fs37">val f : ('a -&gt; bool)</div>
<div class="tip" id="fs38">val xs : 'a list</div>
<div class="tip" id="fs39">val r : 'a list</div>
<div class="tip" id="fs40">val fold : folder:('State -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; list:'T list -&gt; 'State<br><br>Full name: Microsoft.FSharp.Collections.List.fold</div>
<div class="tip" id="fs41">val e : 'a</div>
<div class="tip" id="fs42">property List.Tail: 'a list</div>
<div class="tip" id="fs43">val rev : list:'T list -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.rev</div>
<div class="tip" id="fs44">module Huffman<br><br>from Huffman</div>
<div class="tip" id="fs45">Multiple items<br>module CodeTree<br><br>from Huffman<br><br>--------------------<br>type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Huffman.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs46">val buildFreq : sample:'T list -&gt; ('T * float) list (requires comparison)<br><br>Full name: Huffman.Huffman.buildFreq</div>
<div class="tip" id="fs47">val sample : 'T list (requires comparison)</div>
<div class="tip" id="fs48">property List.Length: int</div>
<div class="tip" id="fs49">val sort : list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sort</div>
<div class="tip" id="fs50">val count : ('a list -&gt; ('a * float) list) (requires equality)</div>
<div class="tip" id="fs51">val sample : 'a list (requires equality)</div>
<div class="tip" id="fs52">val left : 'a list (requires equality)</div>
<div class="tip" id="fs53">val right : 'a list (requires equality)</div>
<div class="tip" id="fs54">property List.Head: 'a</div>
<div class="tip" id="fs55">val sortBy : projection:('T -&gt; 'Key) -&gt; list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sortBy</div>
<div class="tip" id="fs56">val snd : tuple:('T1 * 'T2) -&gt; 'T2<br><br>Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs57">val private buildCodeFromFreqInner : merge:(CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;) -&gt; distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Huffman.Huffman.buildCodeFromFreqInner</div>
<div class="tip" id="fs58">val merge : (CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs59">val distrib : ('T * float) list</div>
<div class="tip" id="fs60">val loop : (CodeTree&lt;'T&gt; list -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs61">val failwith : message:string -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs62">val f : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs63">val s : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs64">val xs : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs65">val newCT : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs66">val left : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs67">val right : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs68">val e : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs69">val map : mapping:('T -&gt; 'U) -&gt; list:'T list -&gt; 'U list<br><br>Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs70">val buildCodeFromFreq : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Huffman.Huffman.buildCodeFromFreq</div>
<div class="tip" id="fs71">val buildCodeFromLogProb : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Huffman.Huffman.buildCodeFromLogProb</div>
<div class="tip" id="fs72">val decode : codeTree:CodeTree&lt;'a&gt; -&gt; bits:int list -&gt; 'a list<br><br>Full name: Huffman.Huffman.decode</div>
<div class="tip" id="fs73">val codeTree : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs74">val bits : int list</div>
<div class="tip" id="fs75">Multiple items<br>val int : value:'T -&gt; int (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.int<br><br>--------------------<br>type int&lt;'Measure&gt; = int<br><br>Full name: Microsoft.FSharp.Core.int&lt;_&gt;<br><br>--------------------<br>type int = int32<br><br>Full name: Microsoft.FSharp.Core.int</div>
<div class="tip" id="fs76">val o : CodeTree&lt;'a&gt; * 'a list</div>
<div class="tip" id="fs77">val l : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs78">val r : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs79">val decMsg : 'a list</div>
<div class="tip" id="fs80">val b : int</div>
<div class="tip" id="fs81">val current : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs82">val makeEncoderDic : tree:CodeTree&lt;'T&gt; -&gt; Map&lt;'T,int list&gt; (requires comparison)<br><br>Full name: Huffman.Huffman.makeEncoderDic</div>
<div class="tip" id="fs83">val tree : CodeTree&lt;'T&gt; (requires comparison)</div>
<div class="tip" id="fs84">val lMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs85">val rMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs86">Multiple items<br>module Map<br><br>from Microsoft.FSharp.Collections<br><br>--------------------<br>type Map&lt;'Key,'Value (requires comparison)&gt; =<br>&nbsp;&nbsp;interface IEnumerable<br>&nbsp;&nbsp;interface IComparable<br>&nbsp;&nbsp;interface IEnumerable&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface ICollection&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface IDictionary&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member ContainsKey : key:'Key -&gt; bool<br>&nbsp;&nbsp;override Equals : obj -&gt; bool<br>&nbsp;&nbsp;member Remove : key:'Key -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;...<br><br>Full name: Microsoft.FSharp.Collections.Map&lt;_,_&gt;<br><br>--------------------<br>new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs87">val fold : folder:('State -&gt; 'Key -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; table:Map&lt;'Key,'T&gt; -&gt; 'State (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.fold</div>
<div class="tip" id="fs88">val m : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs89">val k : 'T (requires comparison)</div>
<div class="tip" id="fs90">val v : int list</div>
<div class="tip" id="fs91">member Map.Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs92">val empty&lt;'Key,'T (requires comparison)&gt; : Map&lt;'Key,'T&gt; (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.empty</div>
<div class="tip" id="fs93">val c : 'T (requires comparison)</div>
<div class="tip" id="fs94">val encode : dic:Map&lt;'T,int list&gt; -&gt; ('T list -&gt; int list) (requires comparison)<br><br>Full name: Huffman.Huffman.encode</div>
<div class="tip" id="fs95">val dic : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs96">val x : 'T (requires comparison)</div>
<div class="tip" id="fs97">property Map.Item: 'T -&gt; int list</div>
<div class="tip" id="fs98">val concat : lists:seq&lt;'T list&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.concat</div>
<div class="tip" id="fs99">val secret : int list<br><br>Full name: Huffman.Huffman.secret</div>
<div class="tip" id="fs100">val frenchCode : CodeTree&lt;char&gt;<br><br>Full name: Huffman.Huffman.frenchCode</div>
<div class="tip" id="fs101">val r : char list<br><br>Full name: Huffman.Huffman.r</div>

</div></body></html>

    </article>
  </div>

    </div>
    </div>
  </body>
</html>

