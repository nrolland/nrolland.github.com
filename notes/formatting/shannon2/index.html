<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> xQuant  Shannon theorem       </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="These are various notes of computer science subjects. They sometime have accompanying F# implementation They are authored in a litterate programming style and each document is a valid.">
    <meta name="author" content="Nicolas Rolland">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="alternate" type="application/rss+xml" title="xQuant.net Atom feed" href="http://xquant.net/blog/feed.xml" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/stylesheet/tooltips.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/style.css" />
    <link type="text/css" rel="stylesheet" href="/stylesheet/jsxgraph.css" />

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=css&lang=ml&lang=scala&lang=hs"></script>
    <script src="/javascript/tips.js" type="text/javascript"></script>
    <script src="/javascript/jsxgraphcore.js" type="text/javascript"></script>
    <script>
        JXG.Options.text.useMathJax = true;
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],

        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
          }
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i = 0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      })
      </script>
    <script>
      setTimeout(function() {
      if(typeof(MathJax)=='undefined') return;
      var n = document.getElementsByTagName("script")[0];
      n.parentNode.insertBefore(document.createElement("script"), n).src = "/javascript/MathJax.js";
      }, 5000);
    </script>
     <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></Script>
     <script type="text/javascript" src="/javascript/MathJax.js"></Script>
     
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39755928-1', 'xquant.net');
      ga('send', 'pageview');

    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-45978109-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
  <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
        <a class="brand" href="#">Shannon theorem  </a>
          <hr>
        <ul class="nav">
          <li><a href="/">Home</a></li>
          <li><a href="/notes">Notes</a></li>
           <li><a href="/about">About</a></li>
           <li class="divider"></li>
        </ul>
      </div>
      </div>
      <hr>
    <div class="centered">
      
  <div class='post'>
    <article>
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="span9" id="main">
          <h1>Shannon theorem</h1>

<p>To illustrate the Shannon theorem, we'll need to start with the entropic, or Huffman, coding.
This was recently submitted as part of Martin Odersky's excellent course on functional programming 
using scala and is a beautiful illustration of principled recursion.</p>

<h3>Huffman coding</h3>

<p>Let's magine we want to transmit a <strong>string</strong>, which is sequence of <strong>characters</strong> from a symbol dictionary.
We make the assumption that we know how relatively frequent each character is.
Considering this, we'd want to map our dictionary to a new one, where the most frequent items are mapped to more compact represenations.
By the Kraft inequality, it implies that some other, less frequent code, have to be longer.</p>

<p>Let's look at how we'd do a coding with binary characters in FSharp
Our main structure will be a binary tree, which holds the possible characters from our initial dictionary 
If we have one such tree, whose Leaves contains all the items of our dictionary, we have a correspondance between
a sequence of 1 and 0 and characters of our dictionary.</p>

<p>code : dictionary  {0,1}*</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Generic</span>
<span class="l">2: </span><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 4)" onmouseover="showTip(event, 'fs1', 4)" class="i">System</span>
<span class="l">3: </span>
<span class="l">4: </span><span class="k">type</span> <span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">Leaf</span> <span class="k">of</span> <span class="o">'</span><span class="i">T</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">float</span> | <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">Fork</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">*</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">list</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">float</span></pre>
<p>We'll want to do basic operation on those</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">module</span> <span onmouseout="hideTip(event, 'fs4', 13)" onmouseover="showTip(event, 'fs4', 13)" class="i">CodeTree</span> <span class="o">=</span> 
<span class="l">2: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 14)" onmouseover="showTip(event, 'fs9', 14)" class="i">chars</span>  <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 16)" onmouseover="showTip(event, 'fs10', 16)" class="i">c</span>,_) <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">c</span>] | <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="i">Fork</span>(_,_,<span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">l</span>,_) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">l</span>
<span class="l">3: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 21)" onmouseover="showTip(event, 'fs12', 21)" class="i">weight</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs5', 22)" onmouseover="showTip(event, 'fs5', 22)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 23)" onmouseover="showTip(event, 'fs10', 23)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">w</span>) <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs13', 25)" onmouseover="showTip(event, 'fs13', 25)" class="i">w</span>  | <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">Fork</span>(_,_,_,<span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 28)" onmouseover="showTip(event, 'fs13', 28)" class="i">w</span>
<span class="l">4: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 29)" onmouseover="showTip(event, 'fs14', 29)" class="i">merge</span> <span onmouseout="hideTip(event, 'fs15', 30)" onmouseover="showTip(event, 'fs15', 30)" class="i">addweight</span> <span onmouseout="hideTip(event, 'fs16', 31)" onmouseover="showTip(event, 'fs16', 31)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 32)" onmouseover="showTip(event, 'fs17', 32)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 33)" onmouseover="showTip(event, 'fs7', 33)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs16', 34)" onmouseover="showTip(event, 'fs16', 34)" class="i">ct1</span>, <span onmouseout="hideTip(event, 'fs17', 35)" onmouseover="showTip(event, 'fs17', 35)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs9', 36)" onmouseover="showTip(event, 'fs9', 36)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs16', 37)" onmouseover="showTip(event, 'fs16', 37)" class="i">ct1</span> <span class="o">@</span> <span onmouseout="hideTip(event, 'fs9', 38)" onmouseover="showTip(event, 'fs9', 38)" class="i">chars</span> <span onmouseout="hideTip(event, 'fs17', 39)" onmouseover="showTip(event, 'fs17', 39)" class="i">ct2</span>, <span onmouseout="hideTip(event, 'fs15', 40)" onmouseover="showTip(event, 'fs15', 40)" class="i">addweight</span>(<span onmouseout="hideTip(event, 'fs12', 41)" onmouseover="showTip(event, 'fs12', 41)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs16', 42)" onmouseover="showTip(event, 'fs16', 42)" class="i">ct1</span>)(<span onmouseout="hideTip(event, 'fs12', 43)" onmouseover="showTip(event, 'fs12', 43)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs17', 44)" onmouseover="showTip(event, 'fs17', 44)" class="i">ct2</span>))</pre>
<p>If our weight are just straight frequencies, we'll add them. sometimes using logprob is required, 
and the same operations are available with logprob input and output</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs18', 45)" onmouseover="showTip(event, 'fs18', 45)" class="i">logsumexp</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="i">logx</span> <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="i">logy</span> <span class="o">=</span> 
<span class="l">2: </span>      <span class="k">if</span> <span onmouseout="hideTip(event, 'fs19', 48)" onmouseover="showTip(event, 'fs19', 48)" class="i">logx</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs20', 49)" onmouseover="showTip(event, 'fs20', 49)" class="i">logy</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs19', 50)" onmouseover="showTip(event, 'fs19', 50)" class="i">logx</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 51)" onmouseover="showTip(event, 'fs21', 51)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 52)" onmouseover="showTip(event, 'fs22', 52)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 53)" onmouseover="showTip(event, 'fs21', 53)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 54)" onmouseover="showTip(event, 'fs23', 54)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="i">logy</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs19', 56)" onmouseover="showTip(event, 'fs19', 56)" class="i">logx</span>))
<span class="l">3: </span>                     <span class="k">else</span> <span onmouseout="hideTip(event, 'fs20', 57)" onmouseover="showTip(event, 'fs20', 57)" class="i">logy</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 58)" onmouseover="showTip(event, 'fs21', 58)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 59)" onmouseover="showTip(event, 'fs22', 59)" class="i">Log</span>(<span class="n">1.</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs21', 60)" onmouseover="showTip(event, 'fs21', 60)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">Exp</span>(<span onmouseout="hideTip(event, 'fs19', 62)" onmouseover="showTip(event, 'fs19', 62)" class="i">logx</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs20', 63)" onmouseover="showTip(event, 'fs20', 63)" class="i">logy</span>))
<span class="l">4: </span>
<span class="l">5: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 64)" onmouseover="showTip(event, 'fs24', 64)" class="i">mergePlus</span> <span onmouseout="hideTip(event, 'fs16', 65)" onmouseover="showTip(event, 'fs16', 65)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 66)" onmouseover="showTip(event, 'fs17', 66)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 67)" onmouseover="showTip(event, 'fs14', 67)" class="i">merge</span> (<span class="o">+</span>) <span onmouseout="hideTip(event, 'fs16', 68)" onmouseover="showTip(event, 'fs16', 68)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 69)" onmouseover="showTip(event, 'fs17', 69)" class="i">ct2</span>
<span class="l">6: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 70)" onmouseover="showTip(event, 'fs25', 70)" class="i">mergeLogPlus</span> <span onmouseout="hideTip(event, 'fs16', 71)" onmouseover="showTip(event, 'fs16', 71)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 72)" onmouseover="showTip(event, 'fs17', 72)" class="i">ct2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 73)" onmouseover="showTip(event, 'fs14', 73)" class="i">merge</span> (<span onmouseout="hideTip(event, 'fs18', 74)" onmouseover="showTip(event, 'fs18', 74)" class="i">logsumexp</span>) <span onmouseout="hideTip(event, 'fs16', 75)" onmouseover="showTip(event, 'fs16', 75)" class="i">ct1</span> <span onmouseout="hideTip(event, 'fs17', 76)" onmouseover="showTip(event, 'fs17', 76)" class="i">ct2</span></pre>
<p>Since we'll want to perform operation which "fold" our tree, that is, get one final value of a type 'T, 
we define the generalized fold on this structure. 
Note that the is a folding function to the said type for each constructor. 
This generalizes the fold on a list and is an example of 'catamorphism'. I think.</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 77)" onmouseover="showTip(event, 'fs26', 77)" class="i">fold</span> <span onmouseout="hideTip(event, 'fs27', 78)" onmouseover="showTip(event, 'fs27', 78)" class="i">fNode</span> (<span onmouseout="hideTip(event, 'fs28', 79)" onmouseover="showTip(event, 'fs28', 79)" class="i">fLeaf</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span class="k">-&gt;</span> <span class="o">'</span><span class="i">a</span>) (<span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="i">x</span><span class="o">:</span><span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs4', 81)" onmouseover="showTip(event, 'fs4', 81)" class="i">CodeTree</span>) <span class="o">=</span> 
<span class="l">2: </span>            <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs30', 82)" onmouseover="showTip(event, 'fs30', 82)" class="i">f</span> <span onmouseout="hideTip(event, 'fs29', 83)" onmouseover="showTip(event, 'fs29', 83)" class="i">x</span> <span class="o">=</span> <span class="k">match</span> <span onmouseout="hideTip(event, 'fs29', 84)" onmouseover="showTip(event, 'fs29', 84)" class="i">x</span> <span class="k">with</span> | <span onmouseout="hideTip(event, 'fs5', 85)" onmouseover="showTip(event, 'fs5', 85)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs31', 86)" onmouseover="showTip(event, 'fs31', 86)" class="i">e</span>,<span onmouseout="hideTip(event, 'fs13', 87)" onmouseover="showTip(event, 'fs13', 87)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 88)" onmouseover="showTip(event, 'fs28', 88)" class="i">fLeaf</span>(<span onmouseout="hideTip(event, 'fs31', 89)" onmouseover="showTip(event, 'fs31', 89)" class="i">e</span>) | <span onmouseout="hideTip(event, 'fs7', 90)" onmouseover="showTip(event, 'fs7', 90)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs32', 91)" onmouseover="showTip(event, 'fs32', 91)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs33', 92)" onmouseover="showTip(event, 'fs33', 92)" class="i">r</span>,<span onmouseout="hideTip(event, 'fs34', 93)" onmouseover="showTip(event, 'fs34', 93)" class="i">cs</span>,<span onmouseout="hideTip(event, 'fs13', 94)" onmouseover="showTip(event, 'fs13', 94)" class="i">w</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs27', 95)" onmouseover="showTip(event, 'fs27', 95)" class="i">fNode</span>(<span onmouseout="hideTip(event, 'fs30', 96)" onmouseover="showTip(event, 'fs30', 96)" class="i">f</span> <span onmouseout="hideTip(event, 'fs32', 97)" onmouseover="showTip(event, 'fs32', 97)" class="i">l</span>)(<span onmouseout="hideTip(event, 'fs30', 98)" onmouseover="showTip(event, 'fs30', 98)" class="i">f</span> <span onmouseout="hideTip(event, 'fs33', 99)" onmouseover="showTip(event, 'fs33', 99)" class="i">r</span>) 
<span class="l">3: </span>            <span onmouseout="hideTip(event, 'fs30', 100)" onmouseover="showTip(event, 'fs30', 100)" class="i">f</span> <span onmouseout="hideTip(event, 'fs29', 101)" onmouseover="showTip(event, 'fs29', 101)" class="i">x</span> </pre>
<p>We'll also use that function which split a list in two while a condition f(e) is verified</p>
<pre class="fssnip">
<span class="l">1: </span><span class="k">module</span> <span onmouseout="hideTip(event, 'fs35', 102)" onmouseover="showTip(event, 'fs35', 102)" class="i">List</span> <span class="o">=</span>
<span class="l">2: </span>    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 103)" onmouseover="showTip(event, 'fs36', 103)" class="i">span</span> <span onmouseout="hideTip(event, 'fs37', 104)" onmouseover="showTip(event, 'fs37', 104)" class="i">f</span> <span onmouseout="hideTip(event, 'fs38', 105)" onmouseover="showTip(event, 'fs38', 105)" class="i">xs</span> <span class="o">=</span> 
<span class="l">3: </span>        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 106)" onmouseover="showTip(event, 'fs11', 106)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 107)" onmouseover="showTip(event, 'fs39', 107)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 108)" onmouseover="showTip(event, 'fs38', 108)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 109)" onmouseover="showTip(event, 'fs35', 109)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 110)" onmouseover="showTip(event, 'fs40', 110)" class="i">fold</span>(<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs11', 111)" onmouseover="showTip(event, 'fs11', 111)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 112)" onmouseover="showTip(event, 'fs39', 112)" class="i">r</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 113)" onmouseover="showTip(event, 'fs8', 113)" class="i">list</span>) <span onmouseout="hideTip(event, 'fs41', 114)" onmouseover="showTip(event, 'fs41', 114)" class="i">e</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs37', 115)" onmouseover="showTip(event, 'fs37', 115)" class="i">f</span> <span onmouseout="hideTip(event, 'fs41', 116)" onmouseover="showTip(event, 'fs41', 116)" class="i">e</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs41', 117)" onmouseover="showTip(event, 'fs41', 117)" class="i">e</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs11', 118)" onmouseover="showTip(event, 'fs11', 118)" class="i">l</span>, <span onmouseout="hideTip(event, 'fs39', 119)" onmouseover="showTip(event, 'fs39', 119)" class="i">r</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 120)" onmouseover="showTip(event, 'fs42', 120)" class="i">Tail</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs11', 121)" onmouseover="showTip(event, 'fs11', 121)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs39', 122)" onmouseover="showTip(event, 'fs39', 122)" class="i">r</span> ) ([],<span onmouseout="hideTip(event, 'fs38', 123)" onmouseover="showTip(event, 'fs38', 123)" class="i">xs</span>)
<span class="l">4: </span>        <span onmouseout="hideTip(event, 'fs11', 124)" onmouseover="showTip(event, 'fs11', 124)" class="i">l</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 125)" onmouseover="showTip(event, 'fs35', 125)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 126)" onmouseover="showTip(event, 'fs43', 126)" class="i">rev</span>, <span onmouseout="hideTip(event, 'fs39', 127)" onmouseover="showTip(event, 'fs39', 127)" class="i">r</span>
<span class="l">5: </span>
<span class="l">6: </span><span class="k">module</span> <span class="i">Huffman</span> <span class="o">=</span> </pre>
<p>This is just to build some frequency table from a sample.
If we already know or posit the frequencies, we dont need it.</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 128)" onmouseover="showTip(event, 'fs44', 128)" class="i">buildFreq</span> (<span onmouseout="hideTip(event, 'fs45', 129)" onmouseover="showTip(event, 'fs45', 129)" class="i">sample</span> <span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 130)" onmouseover="showTip(event, 'fs8', 130)" class="i">list</span>) <span class="o">=</span> 
<span class="l">2: </span>       <span class="k">if</span> <span onmouseout="hideTip(event, 'fs45', 131)" onmouseover="showTip(event, 'fs45', 131)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 132)" onmouseover="showTip(event, 'fs46', 132)" class="i">Length</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> []
<span class="l">3: </span>       <span class="k">else</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 133)" onmouseover="showTip(event, 'fs45', 133)" class="i">sample</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs45', 134)" onmouseover="showTip(event, 'fs45', 134)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 135)" onmouseover="showTip(event, 'fs35', 135)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 136)" onmouseover="showTip(event, 'fs47', 136)" class="i">sort</span>
<span class="l">4: </span>            <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs48', 137)" onmouseover="showTip(event, 'fs48', 137)" class="i">count</span> (<span onmouseout="hideTip(event, 'fs49', 138)" onmouseover="showTip(event, 'fs49', 138)" class="i">sample</span><span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs8', 139)" onmouseover="showTip(event, 'fs8', 139)" class="i">list</span>) <span class="o">=</span> [ <span class="k">if</span> <span onmouseout="hideTip(event, 'fs49', 140)" onmouseover="showTip(event, 'fs49', 140)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 141)" onmouseover="showTip(event, 'fs46', 141)" class="i">Length</span> <span class="o">&lt;&gt;</span> <span class="n">0</span> <span class="k">then</span> 
<span class="l">5: </span>                                                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 142)" onmouseover="showTip(event, 'fs50', 142)" class="i">left</span>, <span onmouseout="hideTip(event, 'fs51', 143)" onmouseover="showTip(event, 'fs51', 143)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs49', 144)" onmouseover="showTip(event, 'fs49', 144)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 145)" onmouseover="showTip(event, 'fs35', 145)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 146)" onmouseover="showTip(event, 'fs36', 146)" class="i">span</span> ((<span class="o">=</span>) <span onmouseout="hideTip(event, 'fs49', 147)" onmouseover="showTip(event, 'fs49', 147)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs52', 148)" onmouseover="showTip(event, 'fs52', 148)" class="i">Head</span>)
<span class="l">6: </span>                                                <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs49', 149)" onmouseover="showTip(event, 'fs49', 149)" class="i">sample</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs52', 150)" onmouseover="showTip(event, 'fs52', 150)" class="i">Head</span>,<span onmouseout="hideTip(event, 'fs50', 151)" onmouseover="showTip(event, 'fs50', 151)" class="i">left</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 152)" onmouseover="showTip(event, 'fs46', 152)" class="i">Length</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 153)" onmouseover="showTip(event, 'fs6', 153)" class="i">float</span>
<span class="l">7: </span>                                                <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs48', 154)" onmouseover="showTip(event, 'fs48', 154)" class="i">count</span> <span onmouseout="hideTip(event, 'fs51', 155)" onmouseover="showTip(event, 'fs51', 155)" class="i">right</span>  ]
<span class="l">8: </span>            <span onmouseout="hideTip(event, 'fs48', 156)" onmouseover="showTip(event, 'fs48', 156)" class="i">count</span> <span onmouseout="hideTip(event, 'fs49', 157)" onmouseover="showTip(event, 'fs49', 157)" class="i">sample</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 158)" onmouseover="showTip(event, 'fs35', 158)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 159)" onmouseover="showTip(event, 'fs53', 159)" class="i">sortBy</span> <span onmouseout="hideTip(event, 'fs54', 160)" onmouseover="showTip(event, 'fs54', 160)" class="i">snd</span>        </pre>
<p>The following function is the core of the Huffman code construction, 
(and is just parameterized with  an explicit "merger" function for logprob or frequency cases)</p>

<p>It accepts a list of character and their frequency as input.
It builds a sequence of list of optimal codes.</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span class="k">private</span> <span onmouseout="hideTip(event, 'fs55', 161)" onmouseover="showTip(event, 'fs55', 161)" class="i">buildCodeFromFreqInner</span> <span onmouseout="hideTip(event, 'fs56', 162)" onmouseover="showTip(event, 'fs56', 162)" class="i">merger</span> (<span onmouseout="hideTip(event, 'fs57', 163)" onmouseover="showTip(event, 'fs57', 163)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 164)" onmouseover="showTip(event, 'fs6', 164)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 165)" onmouseover="showTip(event, 'fs8', 165)" class="i">list</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 166)" onmouseover="showTip(event, 'fs58', 166)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span></pre>
<p>This function accepts the Leaf list built at first call, until only one CodeTree remains in the list.
Since at each step we only build optimal CodeTree, the resulting tree is optimal for the whole dictionary.</p>
<pre class="fssnip">
<span class="l">1: </span>       <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs59', 167)" onmouseover="showTip(event, 'fs59', 167)" class="i">loop</span> <span class="o">=</span> <span class="k">function</span> 
<span class="l">2: </span>       | [] <span class="k">-&gt;</span>  <span onmouseout="hideTip(event, 'fs60', 168)" onmouseover="showTip(event, 'fs60', 168)" class="i">failwith</span> <span class="s">"</span><span class="s">not</span><span class="s"> </span><span class="s">possible</span><span class="s">"</span>
<span class="l">3: </span>       | [<span onmouseout="hideTip(event, 'fs33', 169)" onmouseover="showTip(event, 'fs33', 169)" class="i">r</span>] <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 170)" onmouseover="showTip(event, 'fs33', 170)" class="i">r</span></pre>
<p>Given a list of optimal codetree, the assumption here is that merging the 2 least frequent one leads to a new 
optimal codetree.
To see this, we have to merge two CodeTree at this stage.
This merge operation means adding one bit, which will be needed to choose between the subbranches of the new tree.
It is clear that if we intend to lengthen our final code by one bit, it is optimal to do so with branches 
which are the least frequent. we therefore merge the smallest CodeTrees.</p>
<pre class="fssnip">
<span class="l">1: </span>       | <span onmouseout="hideTip(event, 'fs61', 171)" onmouseover="showTip(event, 'fs61', 171)" class="i">f</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs62', 172)" onmouseover="showTip(event, 'fs62', 172)" class="i">s</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs63', 173)" onmouseover="showTip(event, 'fs63', 173)" class="i">xs</span> <span class="k">-&gt;</span>    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 174)" onmouseover="showTip(event, 'fs64', 174)" class="i">newCT</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 175)" onmouseover="showTip(event, 'fs56', 175)" class="i">merger</span> <span onmouseout="hideTip(event, 'fs61', 176)" onmouseover="showTip(event, 'fs61', 176)" class="i">f</span> <span onmouseout="hideTip(event, 'fs62', 177)" onmouseover="showTip(event, 'fs62', 177)" class="i">s</span></pre>
<p>We then reorder them, by splitting at the weight of the new tree</p>
<pre class="fssnip">
<span class="l">1: </span>                        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 178)" onmouseover="showTip(event, 'fs65', 178)" class="i">left</span>, <span onmouseout="hideTip(event, 'fs66', 179)" onmouseover="showTip(event, 'fs66', 179)" class="i">right</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs35', 180)" onmouseover="showTip(event, 'fs35', 180)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 181)" onmouseover="showTip(event, 'fs36', 181)" class="i">span</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs67', 182)" onmouseover="showTip(event, 'fs67', 182)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs58', 183)" onmouseover="showTip(event, 'fs58', 183)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 184)" onmouseover="showTip(event, 'fs12', 184)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs67', 185)" onmouseover="showTip(event, 'fs67', 185)" class="i">e</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs58', 186)" onmouseover="showTip(event, 'fs58', 186)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 187)" onmouseover="showTip(event, 'fs12', 187)" class="i">weight</span> <span onmouseout="hideTip(event, 'fs64', 188)" onmouseover="showTip(event, 'fs64', 188)" class="i">newCT</span>) <span onmouseout="hideTip(event, 'fs63', 189)" onmouseover="showTip(event, 'fs63', 189)" class="i">xs</span></pre>
<p>we insert the new Tree, and recurse, with a new list shorter by one from the previous iteration</p>
<pre class="fssnip">
<span class="l">1: </span>                        <span onmouseout="hideTip(event, 'fs59', 190)" onmouseover="showTip(event, 'fs59', 190)" class="i">loop</span>(<span onmouseout="hideTip(event, 'fs65', 191)" onmouseover="showTip(event, 'fs65', 191)" class="i">left</span> <span class="o">@</span> (<span onmouseout="hideTip(event, 'fs64', 192)" onmouseover="showTip(event, 'fs64', 192)" class="i">newCT</span><span class="o">::</span> <span onmouseout="hideTip(event, 'fs66', 193)" onmouseover="showTip(event, 'fs66', 193)" class="i">right</span>))</pre>
<p>We start by sorting the frequency list and making leaf of all characters.
There is no doubt that for dictionaries made of only one character, a leaf is and optimal coding.
Now those are sorted in ascending order of frequency</p>
<pre class="fssnip">
<span class="l">1: </span>       <span onmouseout="hideTip(event, 'fs59', 194)" onmouseover="showTip(event, 'fs59', 194)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs57', 195)" onmouseover="showTip(event, 'fs57', 195)" class="i">distrib</span>  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 196)" onmouseover="showTip(event, 'fs35', 196)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 197)" onmouseover="showTip(event, 'fs53', 197)" class="i">sortBy</span>(<span onmouseout="hideTip(event, 'fs54', 198)" onmouseover="showTip(event, 'fs54', 198)" class="i">snd</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 199)" onmouseover="showTip(event, 'fs35', 199)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 200)" onmouseover="showTip(event, 'fs68', 200)" class="i">map</span>(<span onmouseout="hideTip(event, 'fs5', 201)" onmouseover="showTip(event, 'fs5', 201)" class="i">Leaf</span>))
<span class="l">2: </span>
<span class="l">3: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 202)" onmouseover="showTip(event, 'fs69', 202)" class="i">buildCodeFromFreq</span>   (<span onmouseout="hideTip(event, 'fs57', 203)" onmouseover="showTip(event, 'fs57', 203)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 204)" onmouseover="showTip(event, 'fs6', 204)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 205)" onmouseover="showTip(event, 'fs8', 205)" class="i">list</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 206)" onmouseover="showTip(event, 'fs58', 206)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 207)" onmouseover="showTip(event, 'fs55', 207)" class="i">buildCodeFromFreqInner</span> (<span onmouseout="hideTip(event, 'fs58', 208)" onmouseover="showTip(event, 'fs58', 208)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 209)" onmouseover="showTip(event, 'fs24', 209)" class="i">mergePlus</span>)    <span onmouseout="hideTip(event, 'fs57', 210)" onmouseover="showTip(event, 'fs57', 210)" class="i">distrib</span>
<span class="l">4: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 211)" onmouseover="showTip(event, 'fs70', 211)" class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs57', 212)" onmouseover="showTip(event, 'fs57', 212)" class="i">distrib</span><span class="o">:</span>(<span class="o">'</span><span class="i">T</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 213)" onmouseover="showTip(event, 'fs6', 213)" class="i">float</span>) <span onmouseout="hideTip(event, 'fs8', 214)" onmouseover="showTip(event, 'fs8', 214)" class="i">list</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 215)" onmouseover="showTip(event, 'fs58', 215)" class="i">CodeTree</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 216)" onmouseover="showTip(event, 'fs55', 216)" class="i">buildCodeFromFreqInner</span> (<span onmouseout="hideTip(event, 'fs58', 217)" onmouseover="showTip(event, 'fs58', 217)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 218)" onmouseover="showTip(event, 'fs25', 218)" class="i">mergeLogPlus</span>) <span onmouseout="hideTip(event, 'fs57', 219)" onmouseover="showTip(event, 'fs57', 219)" class="i">distrib</span></pre>
<p>We can now <strong>decode</strong> a new string encoded with our new dictionnary</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs71', 220)" onmouseover="showTip(event, 'fs71', 220)" class="i">decode</span> (<span onmouseout="hideTip(event, 'fs72', 221)" onmouseover="showTip(event, 'fs72', 221)" class="i">codeTree</span><span class="o">:</span>_ <span onmouseout="hideTip(event, 'fs58', 222)" onmouseover="showTip(event, 'fs58', 222)" class="i">CodeTree</span>) (<span onmouseout="hideTip(event, 'fs73', 223)" onmouseover="showTip(event, 'fs73', 223)" class="i">bits</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs74', 224)" onmouseover="showTip(event, 'fs74', 224)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 225)" onmouseover="showTip(event, 'fs8', 225)" class="i">list</span>) <span class="o">=</span>
<span class="l">2: </span>       <span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 226)" onmouseover="showTip(event, 'fs75', 226)" class="i">o</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs73', 227)" onmouseover="showTip(event, 'fs73', 227)" class="i">bits</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 228)" onmouseover="showTip(event, 'fs35', 228)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 229)" onmouseover="showTip(event, 'fs40', 229)" class="i">fold</span>(<span class="k">fun</span> ((<span onmouseout="hideTip(event, 'fs7', 230)" onmouseover="showTip(event, 'fs7', 230)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs76', 231)" onmouseover="showTip(event, 'fs76', 231)" class="i">l</span>,<span onmouseout="hideTip(event, 'fs77', 232)" onmouseover="showTip(event, 'fs77', 232)" class="i">r</span>,_,_)), <span onmouseout="hideTip(event, 'fs78', 233)" onmouseover="showTip(event, 'fs78', 233)" class="i">decMsg</span>) <span onmouseout="hideTip(event, 'fs79', 234)" onmouseover="showTip(event, 'fs79', 234)" class="i">b</span> <span class="k">-&gt;</span>  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 235)" onmouseover="showTip(event, 'fs80', 235)" class="i">branch</span> <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs79', 236)" onmouseover="showTip(event, 'fs79', 236)" class="i">b</span> <span class="o">=</span> <span class="n">0</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs76', 237)" onmouseover="showTip(event, 'fs76', 237)" class="i">l</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs77', 238)" onmouseover="showTip(event, 'fs77', 238)" class="i">r</span>
<span class="l">3: </span>                                                                     <span class="k">match</span> <span onmouseout="hideTip(event, 'fs80', 239)" onmouseover="showTip(event, 'fs80', 239)" class="i">branch</span> <span class="k">with</span> | <span onmouseout="hideTip(event, 'fs5', 240)" onmouseover="showTip(event, 'fs5', 240)" class="i">Leaf</span>(<span onmouseout="hideTip(event, 'fs10', 241)" onmouseover="showTip(event, 'fs10', 241)" class="i">c</span>,_) <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs72', 242)" onmouseover="showTip(event, 'fs72', 242)" class="i">codeTree</span>, <span onmouseout="hideTip(event, 'fs10', 243)" onmouseover="showTip(event, 'fs10', 243)" class="i">c</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs78', 244)" onmouseover="showTip(event, 'fs78', 244)" class="i">decMsg</span>) 
<span class="l">4: </span>                                                                                       | _         <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs80', 245)" onmouseover="showTip(event, 'fs80', 245)" class="i">branch</span>  , <span onmouseout="hideTip(event, 'fs78', 246)" onmouseover="showTip(event, 'fs78', 246)" class="i">decMsg</span>))
<span class="l">5: </span>                                     (<span onmouseout="hideTip(event, 'fs72', 247)" onmouseover="showTip(event, 'fs72', 247)" class="i">codeTree</span>, [])
<span class="l">6: </span>       <span onmouseout="hideTip(event, 'fs54', 248)" onmouseover="showTip(event, 'fs54', 248)" class="i">snd</span> <span onmouseout="hideTip(event, 'fs75', 249)" onmouseover="showTip(event, 'fs75', 249)" class="i">o</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 250)" onmouseover="showTip(event, 'fs35', 250)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 251)" onmouseover="showTip(event, 'fs43', 251)" class="i">rev</span></pre>
<p>And of course encode as well. 
Instead of searching for the correct leaf at each character in the CodeTree, we build a map
wich gives us in O(1) the new coded character</p>
<pre class="fssnip">
<span class="l">1: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs81', 252)" onmouseover="showTip(event, 'fs81', 252)" class="i">makeEncoderDic</span> (<span onmouseout="hideTip(event, 'fs82', 253)" onmouseover="showTip(event, 'fs82', 253)" class="i">tree</span><span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs58', 254)" onmouseover="showTip(event, 'fs58', 254)" class="i">CodeTree</span>) <span class="o">=</span> </pre>
<p>Note the use of the generalized fold. Everytime we encouter a leaf, 
we create a new Map which associate the character to the empty binary string.
Every time we encouter a Fork, we add 0 to the entries of the left Map, and 1 to the roght Map.</p>
<pre class="fssnip">
<span class="l"> 1: </span>      <span onmouseout="hideTip(event, 'fs58', 255)" onmouseover="showTip(event, 'fs58', 255)" class="i">CodeTree</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 256)" onmouseover="showTip(event, 'fs26', 256)" class="i">fold</span>(<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs83', 257)" onmouseover="showTip(event, 'fs83', 257)" class="i">lMap</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs84', 258)" onmouseover="showTip(event, 'fs84', 258)" class="i">Map</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span>,<span onmouseout="hideTip(event, 'fs74', 259)" onmouseover="showTip(event, 'fs74', 259)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 260)" onmouseover="showTip(event, 'fs8', 260)" class="i">list</span><span class="o">&gt;</span>) <span onmouseout="hideTip(event, 'fs85', 261)" onmouseover="showTip(event, 'fs85', 261)" class="i">rMap</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs83', 262)" onmouseover="showTip(event, 'fs83', 262)" class="i">lMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs84', 263)" onmouseover="showTip(event, 'fs84', 263)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 264)" onmouseover="showTip(event, 'fs86', 264)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs87', 265)" onmouseover="showTip(event, 'fs87', 265)" class="i">m</span> <span onmouseout="hideTip(event, 'fs88', 266)" onmouseover="showTip(event, 'fs88', 266)" class="i">k</span> <span onmouseout="hideTip(event, 'fs89', 267)" onmouseover="showTip(event, 'fs89', 267)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs87', 268)" onmouseover="showTip(event, 'fs87', 268)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 269)" onmouseover="showTip(event, 'fs90', 269)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs88', 270)" onmouseover="showTip(event, 'fs88', 270)" class="i">k</span>, <span class="n">0</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs89', 271)" onmouseover="showTip(event, 'fs89', 271)" class="i">v</span>)) (<span onmouseout="hideTip(event, 'fs85', 272)" onmouseover="showTip(event, 'fs85', 272)" class="i">rMap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs84', 273)" onmouseover="showTip(event, 'fs84', 273)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 274)" onmouseover="showTip(event, 'fs86', 274)" class="i">fold</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs87', 275)" onmouseover="showTip(event, 'fs87', 275)" class="i">m</span> <span onmouseout="hideTip(event, 'fs88', 276)" onmouseover="showTip(event, 'fs88', 276)" class="i">k</span> <span onmouseout="hideTip(event, 'fs89', 277)" onmouseover="showTip(event, 'fs89', 277)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs87', 278)" onmouseover="showTip(event, 'fs87', 278)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 279)" onmouseover="showTip(event, 'fs90', 279)" class="i">Add</span>(<span onmouseout="hideTip(event, 'fs88', 280)" onmouseover="showTip(event, 'fs88', 280)" class="i">k</span>, <span class="n">1</span><span class="o">::</span><span onmouseout="hideTip(event, 'fs89', 281)" onmouseover="showTip(event, 'fs89', 281)" class="i">v</span>)) <span onmouseout="hideTip(event, 'fs84', 282)" onmouseover="showTip(event, 'fs84', 282)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 283)" onmouseover="showTip(event, 'fs91', 283)" class="i">empty</span>)) 
<span class="l"> 2: </span>                   (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs92', 284)" onmouseover="showTip(event, 'fs92', 284)" class="i">c</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs84', 285)" onmouseover="showTip(event, 'fs84', 285)" class="i">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 286)" onmouseover="showTip(event, 'fs91', 286)" class="i">empty</span><span class="o">.</span><span class="i">Add</span>(<span onmouseout="hideTip(event, 'fs92', 287)" onmouseover="showTip(event, 'fs92', 287)" class="i">c</span>,[])) 
<span class="l"> 3: </span>                   <span onmouseout="hideTip(event, 'fs82', 288)" onmouseover="showTip(event, 'fs82', 288)" class="i">tree</span>
<span class="l"> 4: </span>  
<span class="l"> 5: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 289)" onmouseover="showTip(event, 'fs93', 289)" class="i">encode</span> (<span onmouseout="hideTip(event, 'fs94', 290)" onmouseover="showTip(event, 'fs94', 290)" class="i">dic</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs84', 291)" onmouseover="showTip(event, 'fs84', 291)" class="i">Map</span><span class="o">&lt;</span><span class="o">'</span><span class="i">T</span>,<span onmouseout="hideTip(event, 'fs74', 292)" onmouseover="showTip(event, 'fs74', 292)" class="i">int</span> <span onmouseout="hideTip(event, 'fs8', 293)" onmouseover="showTip(event, 'fs8', 293)" class="i">list</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs95', 294)" onmouseover="showTip(event, 'fs95', 294)" class="i">text</span> <span class="o">:</span> <span class="o">'</span><span class="i">T</span> <span onmouseout="hideTip(event, 'fs8', 295)" onmouseover="showTip(event, 'fs8', 295)" class="i">list</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs95', 296)" onmouseover="showTip(event, 'fs95', 296)" class="i">text</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 297)" onmouseover="showTip(event, 'fs35', 297)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 298)" onmouseover="showTip(event, 'fs68', 298)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs96', 299)" onmouseover="showTip(event, 'fs96', 299)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs94', 300)" onmouseover="showTip(event, 'fs94', 300)" class="i">dic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs97', 301)" onmouseover="showTip(event, 'fs97', 301)" class="i">Item</span>(<span onmouseout="hideTip(event, 'fs96', 302)" onmouseover="showTip(event, 'fs96', 302)" class="i">x</span>)) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 303)" onmouseover="showTip(event, 'fs35', 303)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs98', 304)" onmouseover="showTip(event, 'fs98', 304)" class="i">concat</span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs99', 305)" onmouseover="showTip(event, 'fs99', 305)" class="i">secret</span> <span class="o">=</span> [<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">0</span>;<span class="n">1</span>;<span class="n">0</span>;<span class="n">1</span>]
<span class="l"> 8: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 306)" onmouseover="showTip(event, 'fs100', 306)" class="i">frenchCode</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 307)" onmouseover="showTip(event, 'fs7', 307)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 308)" onmouseover="showTip(event, 'fs7', 308)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 309)" onmouseover="showTip(event, 'fs7', 309)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 310)" onmouseover="showTip(event, 'fs5', 310)" class="i">Leaf</span>(<span class="s">'s'</span>,<span class="n">121895.</span>),<span onmouseout="hideTip(event, 'fs7', 311)" onmouseover="showTip(event, 'fs7', 311)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 312)" onmouseover="showTip(event, 'fs5', 312)" class="i">Leaf</span>(<span class="s">'d'</span>,<span class="n">56269.</span>),<span onmouseout="hideTip(event, 'fs7', 313)" onmouseover="showTip(event, 'fs7', 313)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 314)" onmouseover="showTip(event, 'fs7', 314)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 315)" onmouseover="showTip(event, 'fs7', 315)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 316)" onmouseover="showTip(event, 'fs5', 316)" class="i">Leaf</span>(<span class="s">'x'</span>,<span class="n">5928.</span>),<span onmouseout="hideTip(event, 'fs5', 317)" onmouseover="showTip(event, 'fs5', 317)" class="i">Leaf</span>(<span class="s">'j'</span>,<span class="n">8351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>],<span class="n">14279.</span>),<span onmouseout="hideTip(event, 'fs5', 318)" onmouseover="showTip(event, 'fs5', 318)" class="i">Leaf</span>(<span class="s">'f'</span>,<span class="n">16351.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>],<span class="n">30630.</span>),<span onmouseout="hideTip(event, 'fs7', 319)" onmouseover="showTip(event, 'fs7', 319)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 320)" onmouseover="showTip(event, 'fs7', 320)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 321)" onmouseover="showTip(event, 'fs5', 321)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 322)" onmouseover="showTip(event, 'fs7', 322)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 323)" onmouseover="showTip(event, 'fs5', 323)" class="i">Leaf</span>(<span class="s">'z'</span>,<span class="n">2093.</span>),<span onmouseout="hideTip(event, 'fs7', 324)" onmouseover="showTip(event, 'fs7', 324)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 325)" onmouseover="showTip(event, 'fs5', 325)" class="i">Leaf</span>(<span class="s">'k'</span>,<span class="n">745.</span>),<span onmouseout="hideTip(event, 'fs5', 326)" onmouseover="showTip(event, 'fs5', 326)" class="i">Leaf</span>(<span class="s">'w'</span>,<span class="n">1747.</span>),[<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">2492.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>],<span class="n">4585.</span>),<span onmouseout="hideTip(event, 'fs5', 327)" onmouseover="showTip(event, 'fs5', 327)" class="i">Leaf</span>(<span class="s">'y'</span>,<span class="n">4725.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>],<span class="n">9310.</span>),<span onmouseout="hideTip(event, 'fs5', 328)" onmouseover="showTip(event, 'fs5', 328)" class="i">Leaf</span>(<span class="s">'h'</span>,<span class="n">11298.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>],<span class="n">20608.</span>),<span onmouseout="hideTip(event, 'fs5', 329)" onmouseover="showTip(event, 'fs5', 329)" class="i">Leaf</span>(<span class="s">'q'</span>,<span class="n">20889.</span>),[<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">41497.</span>),[<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">72127.</span>),[<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">128396.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>],<span class="n">250291.</span>),<span onmouseout="hideTip(event, 'fs7', 330)" onmouseover="showTip(event, 'fs7', 330)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 331)" onmouseover="showTip(event, 'fs7', 331)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 332)" onmouseover="showTip(event, 'fs7', 332)" class="i">Leaf</span>(<span class="s">'o'</span>,<span class="n">82762.</span>),<span onmouseout="hideTip(event, 'fs5', 333)" onmouseover="showTip(event, 'fs5', 333)" class="i">Leaf</span>(<span class="s">'l'</span>,<span class="n">83668.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>],<span class="n">166430.</span>),<span onmouseout="hideTip(event, 'fs7', 334)" onmouseover="showTip(event, 'fs7', 334)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 335)" onmouseover="showTip(event, 'fs7', 335)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 336)" onmouseover="showTip(event, 'fs5', 336)" class="i">Leaf</span>(<span class="s">'m'</span>,<span class="n">45521.</span>),<span onmouseout="hideTip(event, 'fs5', 337)" onmouseover="showTip(event, 'fs5', 337)" class="i">Leaf</span>(<span class="s">'p'</span>,<span class="n">46335.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>],<span class="n">91856.</span>),<span onmouseout="hideTip(event, 'fs5', 338)" onmouseover="showTip(event, 'fs5', 338)" class="i">Leaf</span>(<span class="s">'u'</span>,<span class="n">96785.</span>),[<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">188641.</span>),[<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">355071.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>],<span class="n">605362.</span>),<span onmouseout="hideTip(event, 'fs7', 339)" onmouseover="showTip(event, 'fs7', 339)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 340)" onmouseover="showTip(event, 'fs7', 340)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs7', 341)" onmouseover="showTip(event, 'fs7', 341)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 342)" onmouseover="showTip(event, 'fs5', 342)" class="i">Leaf</span>(<span class="s">'r'</span>,<span class="n">100500.</span>),<span onmouseout="hideTip(event, 'fs7', 343)" onmouseover="showTip(event, 'fs7', 343)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 344)" onmouseover="showTip(event, 'fs5', 344)" class="i">Leaf</span>(<span class="s">'c'</span>,<span class="n">50003.</span>),<span onmouseout="hideTip(event, 'fs7', 345)" onmouseover="showTip(event, 'fs7', 345)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 346)" onmouseover="showTip(event, 'fs5', 346)" class="i">Leaf</span>(<span class="s">'v'</span>,<span class="n">24975.</span>),<span onmouseout="hideTip(event, 'fs7', 347)" onmouseover="showTip(event, 'fs7', 347)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 348)" onmouseover="showTip(event, 'fs5', 348)" class="i">Leaf</span>(<span class="s">'g'</span>,<span class="n">13288.</span>),<span onmouseout="hideTip(event, 'fs5', 349)" onmouseover="showTip(event, 'fs5', 349)" class="i">Leaf</span>(<span class="s">'b'</span>,<span class="n">13822.</span>),[<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">27110.</span>),[<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">52085.</span>),[<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">102088.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>],<span class="n">202588.</span>),<span onmouseout="hideTip(event, 'fs7', 350)" onmouseover="showTip(event, 'fs7', 350)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 351)" onmouseover="showTip(event, 'fs5', 351)" class="i">Leaf</span>(<span class="s">'n'</span>,<span class="n">108812.</span>),<span onmouseout="hideTip(event, 'fs5', 352)" onmouseover="showTip(event, 'fs5', 352)" class="i">Leaf</span>(<span class="s">'t'</span>,<span class="n">111103.</span>),[<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">219915.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>],<span class="n">422503.</span>),<span onmouseout="hideTip(event, 'fs7', 353)" onmouseover="showTip(event, 'fs7', 353)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 354)" onmouseover="showTip(event, 'fs5', 354)" class="i">Leaf</span>(<span class="s">'e'</span>,<span class="n">225947.</span>),<span onmouseout="hideTip(event, 'fs7', 355)" onmouseover="showTip(event, 'fs7', 355)" class="i">Fork</span>(<span onmouseout="hideTip(event, 'fs5', 356)" onmouseover="showTip(event, 'fs5', 356)" class="i">Leaf</span>(<span class="s">'i'</span>,<span class="n">115465.</span>),<span onmouseout="hideTip(event, 'fs5', 357)" onmouseover="showTip(event, 'fs5', 357)" class="i">Leaf</span>(<span class="s">'a'</span>,<span class="n">117110.</span>),[<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">232575.</span>),[<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">458522.</span>),[<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">881025.</span>),[<span class="s">'s'</span>;<span class="s">'d'</span>;<span class="s">'x'</span>;<span class="s">'j'</span>;<span class="s">'f'</span>;<span class="s">'z'</span>;<span class="s">'k'</span>;<span class="s">'w'</span>;<span class="s">'y'</span>;<span class="s">'h'</span>;<span class="s">'q'</span>;<span class="s">'o'</span>;<span class="s">'l'</span>;<span class="s">'m'</span>;<span class="s">'p'</span>;<span class="s">'u'</span>;<span class="s">'r'</span>;<span class="s">'c'</span>;<span class="s">'v'</span>;<span class="s">'g'</span>;<span class="s">'b'</span>;<span class="s">'n'</span>;<span class="s">'t'</span>;<span class="s">'e'</span>;<span class="s">'i'</span>;<span class="s">'a'</span>],<span class="n">1486387.</span>)
<span class="l"> 9: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 358)" onmouseover="showTip(event, 'fs101', 358)" class="i">r</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 359)" onmouseover="showTip(event, 'fs71', 359)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs100', 360)" onmouseover="showTip(event, 'fs100', 360)" class="i">frenchCode</span> <span onmouseout="hideTip(event, 'fs99', 361)" onmouseover="showTip(event, 'fs99', 361)" class="i">secret</span>
<span class="l">10: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs102', 362)" onmouseover="showTip(event, 'fs102', 362)" class="i">r'</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 363)" onmouseover="showTip(event, 'fs71', 363)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs100', 364)" onmouseover="showTip(event, 'fs100', 364)" class="i">frenchCode</span> (<span onmouseout="hideTip(event, 'fs93', 365)" onmouseover="showTip(event, 'fs93', 365)" class="i">encode</span> (<span onmouseout="hideTip(event, 'fs81', 366)" onmouseover="showTip(event, 'fs81', 366)" class="i">makeEncoderDic</span> <span onmouseout="hideTip(event, 'fs100', 367)" onmouseover="showTip(event, 'fs100', 367)" class="i">frenchCode</span>) <span onmouseout="hideTip(event, 'fs101', 368)" onmouseover="showTip(event, 'fs101', 368)" class="i">r</span>)
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span><span class="k">module</span> <span onmouseout="hideTip(event, 'fs103', 369)" onmouseover="showTip(event, 'fs103', 369)" class="i">BlockCoding</span> <span class="o">=</span>
<span class="l">14: </span>   
<span class="l">15: </span>
<span class="l">16: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs104', 370)" onmouseover="showTip(event, 'fs104', 370)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs105', 371)" onmouseover="showTip(event, 'fs105', 371)" class="i">p</span> <span class="o">=</span> 
<span class="l">17: </span>      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs106', 372)" onmouseover="showTip(event, 'fs106', 372)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs1', 373)" onmouseover="showTip(event, 'fs1', 373)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs107', 374)" onmouseover="showTip(event, 'fs107', 374)" class="i">Random</span>()
<span class="l">18: </span>      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs108', 375)" onmouseover="showTip(event, 'fs108', 375)" class="i">loop</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs109', 376)" onmouseover="showTip(event, 'fs109', 376)" class="i">seq</span> { <span class="k">if</span> <span onmouseout="hideTip(event, 'fs106', 377)" onmouseover="showTip(event, 'fs106', 377)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs110', 378)" onmouseover="showTip(event, 'fs110', 378)" class="i">NextDouble</span>() <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs105', 379)" onmouseover="showTip(event, 'fs105', 379)" class="i">p</span> <span class="k">then</span> <span class="k">yield</span> <span class="n">1</span> <span class="k">else</span> <span class="k">yield</span> <span class="n">0</span>;
<span class="l">19: </span>                           <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs108', 380)" onmouseover="showTip(event, 'fs108', 380)" class="i">loop</span> }
<span class="l">20: </span>      <span onmouseout="hideTip(event, 'fs108', 381)" onmouseover="showTip(event, 'fs108', 381)" class="i">loop</span>
<span class="l">21: </span>
<span class="l">22: </span>   <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs111', 382)" onmouseover="showTip(event, 'fs111', 382)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs112', 383)" onmouseover="showTip(event, 'fs112', 383)" class="i">basen</span> <span onmouseout="hideTip(event, 'fs113', 384)" onmouseover="showTip(event, 'fs113', 384)" class="i">length</span> <span class="o">=</span> <span class="k">match</span> <span onmouseout="hideTip(event, 'fs113', 385)" onmouseover="showTip(event, 'fs113', 385)" class="i">length</span> <span class="k">with</span> 
<span class="l">23: </span>                                    | <span class="n">0</span> <span class="k">-&gt;</span> [[]] 
<span class="l">24: </span>                                    | <span onmouseout="hideTip(event, 'fs114', 386)" onmouseover="showTip(event, 'fs114', 386)" class="i">n</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs115', 387)" onmouseover="showTip(event, 'fs115', 387)" class="i">enext</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs111', 388)" onmouseover="showTip(event, 'fs111', 388)" class="i">enumerate</span> <span onmouseout="hideTip(event, 'fs112', 389)" onmouseover="showTip(event, 'fs112', 389)" class="i">basen</span> (<span onmouseout="hideTip(event, 'fs113', 390)" onmouseover="showTip(event, 'fs113', 390)" class="i">length</span><span class="o">-</span><span class="n">1</span>) 
<span class="l">25: </span>                                           [ <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, 'fs112', 391)" onmouseover="showTip(event, 'fs112', 391)" class="i">basen</span><span class="o">-</span><span class="n">1</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 392)" onmouseover="showTip(event, 'fs35', 392)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 393)" onmouseover="showTip(event, 'fs68', 393)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs116', 394)" onmouseover="showTip(event, 'fs116', 394)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs115', 395)" onmouseover="showTip(event, 'fs115', 395)" class="i">enext</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 396)" onmouseover="showTip(event, 'fs35', 396)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 397)" onmouseover="showTip(event, 'fs68', 397)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs117', 398)" onmouseover="showTip(event, 'fs117', 398)" class="i">l</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs35', 399)" onmouseover="showTip(event, 'fs35', 399)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs118', 400)" onmouseover="showTip(event, 'fs118', 400)" class="i">Cons</span>(<span onmouseout="hideTip(event, 'fs116', 401)" onmouseover="showTip(event, 'fs116', 401)" class="i">x</span>,<span onmouseout="hideTip(event, 'fs117', 402)" onmouseover="showTip(event, 'fs117', 402)" class="i">l</span>))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 403)" onmouseover="showTip(event, 'fs35', 403)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs98', 404)" onmouseover="showTip(event, 'fs98', 404)" class="i">concat</span>
<span class="l">26: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 405)" onmouseover="showTip(event, 'fs119', 405)" class="i">r</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs111', 406)" onmouseover="showTip(event, 'fs111', 406)" class="i">enumerate</span> <span class="n">2</span> <span class="n">2</span>
<span class="l">27: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs120', 407)" onmouseover="showTip(event, 'fs120', 407)" class="i">lengthCode</span> <span class="o">=</span> <span class="n">3</span>
<span class="l">28: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 408)" onmouseover="showTip(event, 'fs121', 408)" class="i">p</span> <span class="o">=</span> <span class="n">0.1</span>
<span class="l">29: </span>   
<span class="l">30: </span><span class="c">// we will build a code for up to length * H(p) + a few, say 2.3 sqrt (N.p.(1-p))</span>
<span class="l">31: </span><span class="c">// so we enumerate the sequences, and compute their log probabilities</span>
<span class="l">32: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 409)" onmouseover="showTip(event, 'fs122', 409)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs105', 410)" onmouseover="showTip(event, 'fs105', 410)" class="i">p</span> <span onmouseout="hideTip(event, 'fs123', 411)" onmouseover="showTip(event, 'fs123', 411)" class="i">lengthCode</span> <span class="o">=</span> 
<span class="l">33: </span>      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs124', 412)" onmouseover="showTip(event, 'fs124', 412)" class="i">lp</span>, <span onmouseout="hideTip(event, 'fs125', 413)" onmouseover="showTip(event, 'fs125', 413)" class="i">nlp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 414)" onmouseover="showTip(event, 'fs21', 414)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 415)" onmouseover="showTip(event, 'fs22', 415)" class="i">Log</span> <span onmouseout="hideTip(event, 'fs105', 416)" onmouseover="showTip(event, 'fs105', 416)" class="i">p</span>, <span onmouseout="hideTip(event, 'fs21', 417)" onmouseover="showTip(event, 'fs21', 417)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 418)" onmouseover="showTip(event, 'fs22', 418)" class="i">Log</span>(<span class="n">1.</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs105', 419)" onmouseover="showTip(event, 'fs105', 419)" class="i">p</span>)
<span class="l">34: </span>      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs126', 420)" onmouseover="showTip(event, 'fs126', 420)" class="i">sequences</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs111', 421)" onmouseover="showTip(event, 'fs111', 421)" class="i">enumerate</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs123', 422)" onmouseover="showTip(event, 'fs123', 422)" class="i">lengthCode</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 423)" onmouseover="showTip(event, 'fs35', 423)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 424)" onmouseover="showTip(event, 'fs68', 424)" class="i">map</span>(<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs127', 425)" onmouseover="showTip(event, 'fs127', 425)" class="i">s</span> <span class="k">-&gt;</span> <span class="k">let</span> <span onmouseout="hideTip(event, 'fs128', 426)" onmouseover="showTip(event, 'fs128', 426)" class="i">ones</span> <span class="o">=</span>  <span onmouseout="hideTip(event, 'fs127', 427)" onmouseover="showTip(event, 'fs127', 427)" class="i">s</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 428)" onmouseover="showTip(event, 'fs35', 428)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs129', 429)" onmouseover="showTip(event, 'fs129', 429)" class="i">sum</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 430)" onmouseover="showTip(event, 'fs6', 430)" class="i">float</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs127', 431)" onmouseover="showTip(event, 'fs127', 431)" class="i">s</span>, (<span onmouseout="hideTip(event, 'fs128', 432)" onmouseover="showTip(event, 'fs128', 432)" class="i">ones</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs124', 433)" onmouseover="showTip(event, 'fs124', 433)" class="i">lp</span> <span class="o">+</span> (<span onmouseout="hideTip(event, 'fs6', 434)" onmouseover="showTip(event, 'fs6', 434)" class="i">float</span> <span onmouseout="hideTip(event, 'fs123', 435)" onmouseover="showTip(event, 'fs123', 435)" class="i">lengthCode</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs128', 436)" onmouseover="showTip(event, 'fs128', 436)" class="i">ones</span>) <span class="o">*</span><span onmouseout="hideTip(event, 'fs125', 437)" onmouseover="showTip(event, 'fs125', 437)" class="i">nlp</span>))
<span class="l">35: </span>      <span onmouseout="hideTip(event, 'fs130', 438)" onmouseover="showTip(event, 'fs130', 438)" class="i">printfn</span> <span class="s">"</span><span class="s">seqeunce</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
<span class="l">36: </span>      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs131', 439)" onmouseover="showTip(event, 'fs131', 439)" class="i">codeTree</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs132', 440)" onmouseover="showTip(event, 'fs132', 440)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 441)" onmouseover="showTip(event, 'fs70', 441)" class="i">buildCodeFromLogProb</span>(<span onmouseout="hideTip(event, 'fs126', 442)" onmouseover="showTip(event, 'fs126', 442)" class="i">sequences</span>)
<span class="l">37: </span>      <span onmouseout="hideTip(event, 'fs130', 443)" onmouseover="showTip(event, 'fs130', 443)" class="i">printfn</span> <span class="s">"</span><span class="s">codeTreeBuilt</span><span class="s">"</span>
<span class="l">38: </span>      <span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 444)" onmouseover="showTip(event, 'fs133', 444)" class="i">dic</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs132', 445)" onmouseover="showTip(event, 'fs132', 445)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs81', 446)" onmouseover="showTip(event, 'fs81', 446)" class="i">makeEncoderDic</span> <span onmouseout="hideTip(event, 'fs131', 447)" onmouseover="showTip(event, 'fs131', 447)" class="i">codeTree</span>
<span class="l">39: </span>      <span onmouseout="hideTip(event, 'fs130', 448)" onmouseover="showTip(event, 'fs130', 448)" class="i">printfn</span> <span class="s">"</span><span class="s">dicBuilt</span><span class="s">"</span>
<span class="l">40: </span>      <span onmouseout="hideTip(event, 'fs132', 449)" onmouseover="showTip(event, 'fs132', 449)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs93', 450)" onmouseover="showTip(event, 'fs93', 450)" class="i">encode</span> <span onmouseout="hideTip(event, 'fs133', 451)" onmouseover="showTip(event, 'fs133', 451)" class="i">dic</span>, <span onmouseout="hideTip(event, 'fs132', 452)" onmouseover="showTip(event, 'fs132', 452)" class="i">Huffman</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 453)" onmouseover="showTip(event, 'fs71', 453)" class="i">decode</span> <span onmouseout="hideTip(event, 'fs131', 454)" onmouseover="showTip(event, 'fs131', 454)" class="i">codeTree</span>
<span class="l">41: </span>   
<span class="l">42: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs134', 455)" onmouseover="showTip(event, 'fs134', 455)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs135', 456)" onmouseover="showTip(event, 'fs135', 456)" class="i">chunkSize</span> (<span onmouseout="hideTip(event, 'fs136', 457)" onmouseover="showTip(event, 'fs136', 457)" class="i">a</span> <span class="o">:</span> _ <span onmouseout="hideTip(event, 'fs137', 458)" onmouseover="showTip(event, 'fs137', 458)" class="i">array</span>) <span class="o">=</span>
<span class="l">43: </span>      <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs138', 459)" onmouseover="showTip(event, 'fs138', 459)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs139', 460)" onmouseover="showTip(event, 'fs139', 460)" class="i">i</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs109', 461)" onmouseover="showTip(event, 'fs109', 461)" class="i">seq</span> { <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs136', 462)" onmouseover="showTip(event, 'fs136', 462)" class="i">a</span><span class="o">.</span>[ (<span class="n">0</span><span class="o">+</span><span onmouseout="hideTip(event, 'fs139', 463)" onmouseover="showTip(event, 'fs139', 463)" class="i">i</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs135', 464)" onmouseover="showTip(event, 'fs135', 464)" class="i">chunkSize</span>)<span class="o">..</span>((<span onmouseout="hideTip(event, 'fs139', 465)" onmouseover="showTip(event, 'fs139', 465)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span><span onmouseout="hideTip(event, 'fs135', 466)" onmouseover="showTip(event, 'fs135', 466)" class="i">chunkSize</span><span class="o">-</span><span class="n">1</span>)];  <span class="k">if</span> ((<span onmouseout="hideTip(event, 'fs139', 467)" onmouseover="showTip(event, 'fs139', 467)" class="i">i</span><span class="o">+</span><span class="n">1</span>)<span class="o">*</span> <span onmouseout="hideTip(event, 'fs135', 468)" onmouseover="showTip(event, 'fs135', 468)" class="i">chunkSize</span> <span class="o">&lt;</span> <span onmouseout="hideTip(event, 'fs136', 469)" onmouseover="showTip(event, 'fs136', 469)" class="i">a</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs140', 470)" onmouseover="showTip(event, 'fs140', 470)" class="i">Length</span>) <span class="k">then</span> <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs138', 471)" onmouseover="showTip(event, 'fs138', 471)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs139', 472)" onmouseover="showTip(event, 'fs139', 472)" class="i">i</span><span class="o">+</span><span class="n">1</span>)} 
<span class="l">44: </span>      <span onmouseout="hideTip(event, 'fs138', 473)" onmouseover="showTip(event, 'fs138', 473)" class="i">loop</span> <span class="n">0</span> 
<span class="l">45: </span>
<span class="l">46: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs141', 474)" onmouseover="showTip(event, 'fs141', 474)" class="i">blockSize</span> <span class="o">=</span> [<span class="n">15</span>]<span class="c">//][3;5;7;9;11;13;15]</span>
<span class="l">47: </span>   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs142', 475)" onmouseover="showTip(event, 'fs142', 475)" class="i">sizes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs141', 476)" onmouseover="showTip(event, 'fs141', 476)" class="i">blockSize</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs35', 477)" onmouseover="showTip(event, 'fs35', 477)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 478)" onmouseover="showTip(event, 'fs68', 478)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs143', 479)" onmouseover="showTip(event, 'fs143', 479)" class="i">l</span> <span class="k">-&gt;</span>  <span class="k">try</span>
<span class="l">48: </span>                                                   <span onmouseout="hideTip(event, 'fs130', 480)" onmouseover="showTip(event, 'fs130', 480)" class="i">printfn</span> <span class="s">"</span><span class="s">starting</span><span class="s">"</span>
<span class="l">49: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs144', 481)" onmouseover="showTip(event, 'fs144', 481)" class="i">encoder</span>, <span onmouseout="hideTip(event, 'fs145', 482)" onmouseover="showTip(event, 'fs145', 482)" class="i">decoder</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 483)" onmouseover="showTip(event, 'fs122', 483)" class="i">generateEncoderDecoder</span> <span onmouseout="hideTip(event, 'fs121', 484)" onmouseover="showTip(event, 'fs121', 484)" class="i">p</span> <span onmouseout="hideTip(event, 'fs143', 485)" onmouseover="showTip(event, 'fs143', 485)" class="i">l</span>
<span class="l">50: </span>                                                   <span onmouseout="hideTip(event, 'fs130', 486)" onmouseover="showTip(event, 'fs130', 486)" class="i">printfn</span> <span class="s">"</span><span class="s">Encoder</span><span class="s"> </span><span class="s">generated</span><span class="s">"</span>
<span class="l">51: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs146', 487)" onmouseover="showTip(event, 'fs146', 487)" class="i">message</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs104', 488)" onmouseover="showTip(event, 'fs104', 488)" class="i">stream</span> <span onmouseout="hideTip(event, 'fs121', 489)" onmouseover="showTip(event, 'fs121', 489)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs147', 490)" onmouseover="showTip(event, 'fs147', 490)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs148', 491)" onmouseover="showTip(event, 'fs148', 491)" class="i">take</span>(<span onmouseout="hideTip(event, 'fs143', 492)" onmouseover="showTip(event, 'fs143', 492)" class="i">l</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs74', 493)" onmouseover="showTip(event, 'fs74', 493)" class="i">int</span>(<span onmouseout="hideTip(event, 'fs21', 494)" onmouseover="showTip(event, 'fs21', 494)" class="i">Math</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs149', 495)" onmouseover="showTip(event, 'fs149', 495)" class="i">Floor</span>(<span class="n">12330.</span><span class="o">/</span>(<span onmouseout="hideTip(event, 'fs6', 496)" onmouseover="showTip(event, 'fs6', 496)" class="i">float</span> <span onmouseout="hideTip(event, 'fs143', 497)" onmouseover="showTip(event, 'fs143', 497)" class="i">l</span>))))) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs147', 498)" onmouseover="showTip(event, 'fs147', 498)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs150', 499)" onmouseover="showTip(event, 'fs150', 499)" class="i">toArray</span>                                 
<span class="l">52: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs151', 500)" onmouseover="showTip(event, 'fs151', 500)" class="i">sizeOriginal</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs146', 501)" onmouseover="showTip(event, 'fs146', 501)" class="i">message</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs140', 502)" onmouseover="showTip(event, 'fs140', 502)" class="i">Length</span>
<span class="l">53: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs152', 503)" onmouseover="showTip(event, 'fs152', 503)" class="i">a</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs134', 504)" onmouseover="showTip(event, 'fs134', 504)" class="i">chunkExact</span> <span onmouseout="hideTip(event, 'fs143', 505)" onmouseover="showTip(event, 'fs143', 505)" class="i">l</span> <span onmouseout="hideTip(event, 'fs146', 506)" onmouseover="showTip(event, 'fs146', 506)" class="i">message</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs147', 507)" onmouseover="showTip(event, 'fs147', 507)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 508)" onmouseover="showTip(event, 'fs153', 508)" class="i">map</span> <span onmouseout="hideTip(event, 'fs147', 509)" onmouseover="showTip(event, 'fs147', 509)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs154', 510)" onmouseover="showTip(event, 'fs154', 510)" class="i">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs147', 511)" onmouseover="showTip(event, 'fs147', 511)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs154', 512)" onmouseover="showTip(event, 'fs154', 512)" class="i">toList</span>)
<span class="l">54: </span>                                                   <span onmouseout="hideTip(event, 'fs130', 513)" onmouseover="showTip(event, 'fs130', 513)" class="i">printfn</span> <span class="s">"</span><span class="s">chunked</span><span class="s">"</span>
<span class="l">55: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs155', 514)" onmouseover="showTip(event, 'fs155', 514)" class="i">compressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs144', 515)" onmouseover="showTip(event, 'fs144', 515)" class="i">encoder</span> <span onmouseout="hideTip(event, 'fs152', 516)" onmouseover="showTip(event, 'fs152', 516)" class="i">a</span> 
<span class="l">56: </span>                                                   <span onmouseout="hideTip(event, 'fs130', 517)" onmouseover="showTip(event, 'fs130', 517)" class="i">printfn</span> <span class="s">"</span><span class="s">compressed</span><span class="s">"</span>
<span class="l">57: </span>                                                   <span class="k">let</span> <span onmouseout="hideTip(event, 'fs156', 518)" onmouseover="showTip(event, 'fs156', 518)" class="i">sizeCompressed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs155', 519)" onmouseover="showTip(event, 'fs155', 519)" class="i">compressed</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 520)" onmouseover="showTip(event, 'fs46', 520)" class="i">Length</span>
<span class="l">58: </span>                                                   <span onmouseout="hideTip(event, 'fs156', 521)" onmouseover="showTip(event, 'fs156', 521)" class="i">sizeCompressed</span> 
<span class="l">59: </span>                                                <span class="k">with</span> | <span class="o">:?</span> <span onmouseout="hideTip(event, 'fs1', 522)" onmouseover="showTip(event, 'fs1', 522)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 523)" onmouseover="showTip(event, 'fs2', 523)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 524)" onmouseover="showTip(event, 'fs3', 524)" class="i">Generic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs157', 525)" onmouseover="showTip(event, 'fs157', 525)" class="i">KeyNotFoundException</span> <span class="k">as</span> <span onmouseout="hideTip(event, 'fs158', 526)" onmouseover="showTip(event, 'fs158', 526)" class="i">e</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs130', 527)" onmouseover="showTip(event, 'fs130', 527)" class="i">printfn</span> <span class="s">"</span><span class="s">key</span><span class="s"> </span><span class="s">%</span><span class="s">A</span><span class="s">"</span> (<span onmouseout="hideTip(event, 'fs158', 528)" onmouseover="showTip(event, 'fs158', 528)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs159', 529)" onmouseover="showTip(event, 'fs159', 529)" class="i">ToString</span>()); <span onmouseout="hideTip(event, 'fs60', 530)" onmouseover="showTip(event, 'fs60', 530)" class="i">failwith</span> <span class="s">"</span><span class="s">toto</span><span class="s">"</span>
<span class="l">60: </span>                                                   )</pre>

          <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Collections</div>
<div class="tip" id="fs3">namespace System.Collections.Generic</div>
<div class="tip" id="fs4">type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Shannon.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs5">union case CodeTree.Leaf: 'T * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs6">Multiple items<br>val float : value:'T -&gt; float (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.float<br><br>--------------------<br>type float&lt;'Measure&gt; = float<br><br>Full name: Microsoft.FSharp.Core.float&lt;_&gt;<br><br>--------------------<br>type float = Double<br><br>Full name: Microsoft.FSharp.Core.float</div>
<div class="tip" id="fs7">union case CodeTree.Fork: CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float -&gt; CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs8">type 'T list = List&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
<div class="tip" id="fs9">val chars : _arg1:CodeTree&lt;'a&gt; -&gt; 'a list<br><br>Full name: Shannon.CodeTree.chars</div>
<div class="tip" id="fs10">val c : 'a</div>
<div class="tip" id="fs11">val l : 'a list</div>
<div class="tip" id="fs12">val weight : _arg1:CodeTree&lt;'a&gt; -&gt; float<br><br>Full name: Shannon.CodeTree.weight</div>
<div class="tip" id="fs13">val w : float</div>
<div class="tip" id="fs14">val merge : addweight:(float -&gt; float -&gt; float) -&gt; ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.merge</div>
<div class="tip" id="fs15">val addweight : (float -&gt; float -&gt; float)</div>
<div class="tip" id="fs16">val ct1 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs17">val ct2 : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs18">val private logsumexp : logx:float -&gt; logy:float -&gt; float<br><br>Full name: Shannon.CodeTree.logsumexp</div>
<div class="tip" id="fs19">val logx : float</div>
<div class="tip" id="fs20">val logy : float</div>
<div class="tip" id="fs21">type Math =<br>&nbsp;&nbsp;static val E : float<br>&nbsp;&nbsp;static val PI : float<br>&nbsp;&nbsp;static member Abs : value:decimal -&gt; decimal + 6 overloads<br>&nbsp;&nbsp;static member Acos : d:float -&gt; float<br>&nbsp;&nbsp;static member Asin : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan : d:float -&gt; float<br>&nbsp;&nbsp;static member Atan2 : y:float * x:float -&gt; float<br>&nbsp;&nbsp;static member BigMul : a:int * b:int -&gt; int64<br>&nbsp;&nbsp;static member Ceiling : d:decimal -&gt; decimal + 1 overload<br>&nbsp;&nbsp;static member Cos : d:float -&gt; float<br>&nbsp;&nbsp;...<br><br>Full name: System.Math</div>
<div class="tip" id="fs22">Math.Log(d: float) : float<br>Math.Log(a: float, newBase: float) : float</div>
<div class="tip" id="fs23">Math.Exp(d: float) : float</div>
<div class="tip" id="fs24">val mergePlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.mergePlus</div>
<div class="tip" id="fs25">val mergeLogPlus : ct1:CodeTree&lt;'a&gt; -&gt; ct2:CodeTree&lt;'a&gt; -&gt; CodeTree&lt;'a&gt;<br><br>Full name: Shannon.CodeTree.mergeLogPlus</div>
<div class="tip" id="fs26">val fold : fNode:('a -&gt; 'a -&gt; 'a) -&gt; fLeaf:('T -&gt; 'a) -&gt; x:CodeTree&lt;'T&gt; -&gt; 'a<br><br>Full name: Shannon.CodeTree.fold</div>
<div class="tip" id="fs27">val fNode : ('a -&gt; 'a -&gt; 'a)</div>
<div class="tip" id="fs28">val fLeaf : ('T -&gt; 'a)</div>
<div class="tip" id="fs29">val x : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs30">val f : (CodeTree&lt;'T&gt; -&gt; 'a)</div>
<div class="tip" id="fs31">val e : 'T</div>
<div class="tip" id="fs32">val l : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs33">val r : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs34">val cs : 'T list</div>
<div class="tip" id="fs35">Multiple items<br>type List&lt;'T&gt; =<br>&nbsp;&nbsp;new : unit -&gt; List&lt;'T&gt; + 2 overloads<br>&nbsp;&nbsp;member Add : item:'T -&gt; unit<br>&nbsp;&nbsp;member AddRange : collection:IEnumerable&lt;'T&gt; -&gt; unit<br>&nbsp;&nbsp;member AsReadOnly : unit -&gt; ReadOnlyCollection&lt;'T&gt;<br>&nbsp;&nbsp;member BinarySearch : item:'T -&gt; int + 2 overloads<br>&nbsp;&nbsp;member Capacity : int with get, set<br>&nbsp;&nbsp;member Clear : unit -&gt; unit<br>&nbsp;&nbsp;member Contains : item:'T -&gt; bool<br>&nbsp;&nbsp;member ConvertAll&lt;'TOutput&gt; : converter:Converter&lt;'T, 'TOutput&gt; -&gt; List&lt;'TOutput&gt;<br>&nbsp;&nbsp;member CopyTo : array:'T[] -&gt; unit + 2 overloads<br>&nbsp;&nbsp;...<br>&nbsp;&nbsp;nested type Enumerator<br><br>Full name: System.Collections.Generic.List&lt;_&gt;<br><br>--------------------<br>List() : unit<br>List(collection: IEnumerable&lt;'T&gt;) : unit<br>List(capacity: int) : unit</div>
<div class="tip" id="fs36">val span : f:('a -&gt; bool) -&gt; xs:'a list -&gt; 'a list * 'a list<br><br>Full name: Shannon.List.span</div>
<div class="tip" id="fs37">val f : ('a -&gt; bool)</div>
<div class="tip" id="fs38">val xs : 'a list</div>
<div class="tip" id="fs39">val r : 'a list</div>
<div class="tip" id="fs40">val fold : folder:('State -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; list:'T list -&gt; 'State<br><br>Full name: Microsoft.FSharp.Collections.List.fold</div>
<div class="tip" id="fs41">val e : 'a</div>
<div class="tip" id="fs42">property List.Tail: 'a list</div>
<div class="tip" id="fs43">val rev : list:'T list -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.rev</div>
<div class="tip" id="fs44">val buildFreq : sample:'T list -&gt; ('T * float) list (requires comparison)<br><br>Full name: Shannon.Huffman.buildFreq</div>
<div class="tip" id="fs45">val sample : 'T list (requires comparison)</div>
<div class="tip" id="fs46">property List.Length: int</div>
<div class="tip" id="fs47">val sort : list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sort</div>
<div class="tip" id="fs48">val count : ('a list -&gt; ('a * float) list) (requires equality)</div>
<div class="tip" id="fs49">val sample : 'a list (requires equality)</div>
<div class="tip" id="fs50">val left : 'a list (requires equality)</div>
<div class="tip" id="fs51">val right : 'a list (requires equality)</div>
<div class="tip" id="fs52">property List.Head: 'a</div>
<div class="tip" id="fs53">val sortBy : projection:('T -&gt; 'Key) -&gt; list:'T list -&gt; 'T list (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.List.sortBy</div>
<div class="tip" id="fs54">val snd : tuple:('T1 * 'T2) -&gt; 'T2<br><br>Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs55">val private buildCodeFromFreqInner : merger:(CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;) -&gt; distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromFreqInner</div>
<div class="tip" id="fs56">val merger : (CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt; -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs57">val distrib : ('T * float) list</div>
<div class="tip" id="fs58">Multiple items<br>module CodeTree<br><br>from Shannon<br><br>--------------------<br>type CodeTree&lt;'T&gt; =<br>&nbsp;&nbsp;| Leaf of 'T * float<br>&nbsp;&nbsp;| Fork of CodeTree&lt;'T&gt; * CodeTree&lt;'T&gt; * 'T list * float<br><br>Full name: Shannon.CodeTree&lt;_&gt;</div>
<div class="tip" id="fs59">val loop : (CodeTree&lt;'T&gt; list -&gt; CodeTree&lt;'T&gt;)</div>
<div class="tip" id="fs60">val failwith : message:string -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs61">val f : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs62">val s : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs63">val xs : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs64">val newCT : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs65">val left : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs66">val right : CodeTree&lt;'T&gt; list</div>
<div class="tip" id="fs67">val e : CodeTree&lt;'T&gt;</div>
<div class="tip" id="fs68">val map : mapping:('T -&gt; 'U) -&gt; list:'T list -&gt; 'U list<br><br>Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs69">val buildCodeFromFreq : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromFreq</div>
<div class="tip" id="fs70">val buildCodeFromLogProb : distrib:('T * float) list -&gt; CodeTree&lt;'T&gt;<br><br>Full name: Shannon.Huffman.buildCodeFromLogProb</div>
<div class="tip" id="fs71">val decode : codeTree:CodeTree&lt;'a&gt; -&gt; bits:int list -&gt; 'a list<br><br>Full name: Shannon.Huffman.decode</div>
<div class="tip" id="fs72">val codeTree : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs73">val bits : int list</div>
<div class="tip" id="fs74">Multiple items<br>val int : value:'T -&gt; int (requires member op_Explicit)<br><br>Full name: Microsoft.FSharp.Core.Operators.int<br><br>--------------------<br>type int&lt;'Measure&gt; = int<br><br>Full name: Microsoft.FSharp.Core.int&lt;_&gt;<br><br>--------------------<br>type int = int32<br><br>Full name: Microsoft.FSharp.Core.int</div>
<div class="tip" id="fs75">val o : CodeTree&lt;'a&gt; * 'a list</div>
<div class="tip" id="fs76">val l : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs77">val r : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs78">val decMsg : 'a list</div>
<div class="tip" id="fs79">val b : int</div>
<div class="tip" id="fs80">val branch : CodeTree&lt;'a&gt;</div>
<div class="tip" id="fs81">val makeEncoderDic : tree:CodeTree&lt;'T&gt; -&gt; Map&lt;'T,int list&gt; (requires comparison)<br><br>Full name: Shannon.Huffman.makeEncoderDic</div>
<div class="tip" id="fs82">val tree : CodeTree&lt;'T&gt; (requires comparison)</div>
<div class="tip" id="fs83">val lMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs84">Multiple items<br>module Map<br><br>from Microsoft.FSharp.Collections<br><br>--------------------<br>type Map&lt;'Key,'Value (requires comparison)&gt; =<br>&nbsp;&nbsp;interface IEnumerable<br>&nbsp;&nbsp;interface IComparable<br>&nbsp;&nbsp;interface IEnumerable&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface ICollection&lt;KeyValuePair&lt;'Key,'Value&gt;&gt;<br>&nbsp;&nbsp;interface IDictionary&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;member ContainsKey : key:'Key -&gt; bool<br>&nbsp;&nbsp;override Equals : obj -&gt; bool<br>&nbsp;&nbsp;member Remove : key:'Key -&gt; Map&lt;'Key,'Value&gt;<br>&nbsp;&nbsp;...<br><br>Full name: Microsoft.FSharp.Collections.Map&lt;_,_&gt;<br><br>--------------------<br>new : elements:seq&lt;'Key * 'Value&gt; -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs85">val rMap : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs86">val fold : folder:('State -&gt; 'Key -&gt; 'T -&gt; 'State) -&gt; state:'State -&gt; table:Map&lt;'Key,'T&gt; -&gt; 'State (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.fold</div>
<div class="tip" id="fs87">val m : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs88">val k : 'T (requires comparison)</div>
<div class="tip" id="fs89">val v : int list</div>
<div class="tip" id="fs90">member Map.Add : key:'Key * value:'Value -&gt; Map&lt;'Key,'Value&gt;</div>
<div class="tip" id="fs91">val empty&lt;'Key,'T (requires comparison)&gt; : Map&lt;'Key,'T&gt; (requires comparison)<br><br>Full name: Microsoft.FSharp.Collections.Map.empty</div>
<div class="tip" id="fs92">val c : 'T (requires comparison)</div>
<div class="tip" id="fs93">val encode : dic:Map&lt;'T,int list&gt; -&gt; text:'T list -&gt; int list (requires comparison)<br><br>Full name: Shannon.Huffman.encode</div>
<div class="tip" id="fs94">val dic : Map&lt;'T,int list&gt; (requires comparison)</div>
<div class="tip" id="fs95">val text : 'T list (requires comparison)</div>
<div class="tip" id="fs96">val x : 'T (requires comparison)</div>
<div class="tip" id="fs97">property Map.Item: 'T -&gt; int list</div>
<div class="tip" id="fs98">val concat : lists:seq&lt;'T list&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.List.concat</div>
<div class="tip" id="fs99">val secret : int list<br><br>Full name: Shannon.Huffman.secret</div>
<div class="tip" id="fs100">val frenchCode : CodeTree&lt;char&gt;<br><br>Full name: Shannon.Huffman.frenchCode</div>
<div class="tip" id="fs101">val r : char list<br><br>Full name: Shannon.Huffman.r</div>
<div class="tip" id="fs102">val r' : char list<br><br>Full name: Shannon.Huffman.r'</div>
<div class="tip" id="fs103">module BlockCoding<br><br>from Shannon</div>
<div class="tip" id="fs104">val stream : p:float -&gt; seq&lt;int&gt;<br><br>Full name: Shannon.BlockCoding.stream</div>
<div class="tip" id="fs105">val p : float</div>
<div class="tip" id="fs106">val rnd : Random</div>
<div class="tip" id="fs107">Multiple items<br>type Random =<br>&nbsp;&nbsp;new : unit -&gt; Random + 1 overload<br>&nbsp;&nbsp;member Next : unit -&gt; int + 2 overloads<br>&nbsp;&nbsp;member NextBytes : buffer:byte[] -&gt; unit<br>&nbsp;&nbsp;member NextDouble : unit -&gt; float<br><br>Full name: System.Random<br><br>--------------------<br>Random() : unit<br>Random(Seed: int) : unit</div>
<div class="tip" id="fs108">val loop : seq&lt;int&gt;</div>
<div class="tip" id="fs109">Multiple items<br>val seq : sequence:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Core.Operators.seq<br><br>--------------------<br>type seq&lt;'T&gt; = IEnumerable&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs110">Random.NextDouble() : float</div>
<div class="tip" id="fs111">val enumerate : basen:int -&gt; length:int -&gt; int list list<br><br>Full name: Shannon.BlockCoding.enumerate</div>
<div class="tip" id="fs112">val basen : int</div>
<div class="tip" id="fs113">val length : int</div>
<div class="tip" id="fs114">val n : int</div>
<div class="tip" id="fs115">val enext : int list list</div>
<div class="tip" id="fs116">val x : int</div>
<div class="tip" id="fs117">val l : int list</div>
<div class="tip" id="fs118">static member List.Cons : head:'T * tail:'T list -&gt; 'T list</div>
<div class="tip" id="fs119">val r : int list list<br><br>Full name: Shannon.BlockCoding.r</div>
<div class="tip" id="fs120">val lengthCode : int<br><br>Full name: Shannon.BlockCoding.lengthCode</div>
<div class="tip" id="fs121">val p : float<br><br>Full name: Shannon.BlockCoding.p</div>
<div class="tip" id="fs122">val generateEncoderDecoder : p:float -&gt; lengthCode:int -&gt; (int list list -&gt; int list) * (int list -&gt; int list list)<br><br>Full name: Shannon.BlockCoding.generateEncoderDecoder</div>
<div class="tip" id="fs123">val lengthCode : int</div>
<div class="tip" id="fs124">val lp : float</div>
<div class="tip" id="fs125">val nlp : float</div>
<div class="tip" id="fs126">val sequences : (int list * float) list</div>
<div class="tip" id="fs127">val s : int list</div>
<div class="tip" id="fs128">val ones : float</div>
<div class="tip" id="fs129">val sum : list:'T list -&gt; 'T (requires member ( + ) and member get_Zero)<br><br>Full name: Microsoft.FSharp.Collections.List.sum</div>
<div class="tip" id="fs130">val printfn : format:Printf.TextWriterFormat&lt;'T&gt; -&gt; 'T<br><br>Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs131">val codeTree : CodeTree&lt;int list&gt;</div>
<div class="tip" id="fs132">module Huffman<br><br>from Shannon</div>
<div class="tip" id="fs133">val dic : Map&lt;int list,int list&gt;</div>
<div class="tip" id="fs134">val chunkExact : chunkSize:int -&gt; a:'a array -&gt; seq&lt;'a []&gt;<br><br>Full name: Shannon.BlockCoding.chunkExact</div>
<div class="tip" id="fs135">val chunkSize : int</div>
<div class="tip" id="fs136">val a : 'a array</div>
<div class="tip" id="fs137">type 'T array = 'T []<br><br>Full name: Microsoft.FSharp.Core.array&lt;_&gt;</div>
<div class="tip" id="fs138">val loop : (int -&gt; seq&lt;'a []&gt;)</div>
<div class="tip" id="fs139">val i : int</div>
<div class="tip" id="fs140">property Array.Length: int</div>
<div class="tip" id="fs141">val blockSize : int list<br><br>Full name: Shannon.BlockCoding.blockSize</div>
<div class="tip" id="fs142">val sizes : int list<br><br>Full name: Shannon.BlockCoding.sizes</div>
<div class="tip" id="fs143">val l : int</div>
<div class="tip" id="fs144">val encoder : (int list list -&gt; int list)</div>
<div class="tip" id="fs145">val decoder : (int list -&gt; int list list)</div>
<div class="tip" id="fs146">val message : int []</div>
<div class="tip" id="fs147">module Seq<br><br>from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs148">val take : count:int -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'T&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.take</div>
<div class="tip" id="fs149">Math.Floor(d: decimal) : decimal<br>Math.Floor(d: float) : float</div>
<div class="tip" id="fs150">val toArray : source:seq&lt;'T&gt; -&gt; 'T []<br><br>Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs151">val sizeOriginal : int</div>
<div class="tip" id="fs152">val a : int list list</div>
<div class="tip" id="fs153">val map : mapping:('T -&gt; 'U) -&gt; source:seq&lt;'T&gt; -&gt; seq&lt;'U&gt;<br><br>Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs154">val toList : source:seq&lt;'T&gt; -&gt; 'T list<br><br>Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs155">val compressed : int list</div>
<div class="tip" id="fs156">val sizeCompressed : int</div>
<div class="tip" id="fs157">Multiple items<br>type KeyNotFoundException =<br>&nbsp;&nbsp;inherit SystemException<br>&nbsp;&nbsp;new : unit -&gt; KeyNotFoundException + 2 overloads<br><br>Full name: System.Collections.Generic.KeyNotFoundException<br><br>--------------------<br>KeyNotFoundException() : unit<br>KeyNotFoundException(message: string) : unit<br>KeyNotFoundException(message: string, innerException: exn) : unit</div>
<div class="tip" id="fs158">val e : KeyNotFoundException</div>
<div class="tip" id="fs159">Exception.ToString() : string</div>

</div></body></html>

    </article>
  </div>
<spacer height="200"></spacer>

 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'xquantnanoc'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
 
    </div>
    </div>
  </body>
</html>

